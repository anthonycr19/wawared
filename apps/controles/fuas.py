# -*- coding: utf-8 -*-
import xlsxwriter

from django.conf import settings
from django.utils import timezone


class FuaBase(object):
    control = None

    def __init__(self, control, request):
        self.control = control
        self.request = request

    def set_front_columns_dimension(self, worksheet):
        worksheet.set_column('A:A', 4.3)
        worksheet.set_column('B:B', 4.7)
        worksheet.set_column('C:C', 3.2)
        worksheet.set_column('D:E', 0.9)
        worksheet.set_column('F:F', 1.2)
        worksheet.set_column('G:K', 0.6)
        worksheet.set_column('L:L', 2.1)
        worksheet.set_column('M:M', 3.6)
        worksheet.set_column('N:N', 2.1)
        worksheet.set_column('O:O', 2.5)
        worksheet.set_column('P:P', 0.7)
        worksheet.set_column('Q:Q', 2)
        worksheet.set_column('R:S', 1.2)
        worksheet.set_column('T:T', 0.7)
        worksheet.set_column('U:U', 1.4)
        worksheet.set_column('V:V', 0.4)
        worksheet.set_column('W:W', 2)
        worksheet.set_column('X:X', 2.1)
        worksheet.set_column('Y:Y', 4.2)
        worksheet.set_column('Z:Z', 0.5)
        worksheet.set_column('AA:AA', 3.4)
        worksheet.set_column('AB:AC', 0.3)
        worksheet.set_column('AD:AD', 0.7)
        worksheet.set_column('AE:AE', 3)
        worksheet.set_column('AF:AF', 0.9)
        worksheet.set_column('AG:AG', 1)
        worksheet.set_column('AH:AH', 2.9)
        worksheet.set_column('AI:AI', 2.4)
        worksheet.set_column('AJ:AJ', 0.7)
        worksheet.set_column('AK:AK', 0.75)
        worksheet.set_column('AL:AL', 1.2)
        worksheet.set_column('AM:AM', 3.2)
        worksheet.set_column('AN:AN', 0.2)
        worksheet.set_column('AO:AO', 2.3)
        worksheet.set_column('AP:AP', 3.2)
        worksheet.set_column('AQ:AQ', 0.6)
        worksheet.set_column('AR:AR', 3.7)
        worksheet.set_column('AS:AS', 0.3)
        worksheet.set_column('AT:AT', 1.7)
        worksheet.set_column('AU:AU', 0.25)
        worksheet.set_column('AV:AV', 0.4)
        worksheet.set_column('AW:AX', 2)
        worksheet.set_column('AY:AY', 0.9)
        worksheet.set_column('AZ:AZ', 3.9)
        worksheet.set_column('BA:BA', 2.4)
        worksheet.set_column('BB:BB', 1.4)
        worksheet.set_column('BC:BC', 1.3)
        worksheet.set_column('BD:BD', 3.6)
        worksheet.set_column('BE:BE', 1.4)
        worksheet.set_column('BF:BF', 4)
        worksheet.set_column('BG:BG', 3.7)
        worksheet.set_column('BH:BH', 3.4)
        worksheet.set_column('BI:BI', 4.3)
        worksheet.set_column('BJ:BK', 3.4)
        worksheet.set_column('BL:BL', 3.6)
        worksheet.set_column('BM:BM', 3.7)

    def set_front_row_dimension(self, worksheet):
        worksheet.set_row(0, 10)
        worksheet.set_row(1, 10)
        worksheet.set_row(2, 22)
        worksheet.set_row(3, 6.5)
        worksheet.set_row(4, 17)
        worksheet.set_row(5, 15)
        worksheet.set_row(6, 15)
        worksheet.set_row(7, 15)
        worksheet.set_row(8, 6)
        worksheet.set_row(9, 14.5)
        worksheet.set_row(10, 18)
        worksheet.set_row(11, 13)
        worksheet.set_row(12, 29)
        worksheet.set_row(13, 3)
        worksheet.set_row(14, 24)
        worksheet.set_row(15, 6)
        worksheet.set_row(16, 19)
        worksheet.set_row(17, 20)
        worksheet.set_row(18, 21)
        worksheet.set_row(19, 5)
        worksheet.set_row(20, 14)
        worksheet.set_row(21, 14)
        worksheet.set_row(22, 3.5)
        worksheet.set_row(23, 20)
        worksheet.set_row(24, 24)
        worksheet.set_row(25, 3)
        worksheet.set_row(26, 14)
        worksheet.set_row(27, 29.5)
        worksheet.set_row(28, 2)
        worksheet.set_row(29, 13)
        worksheet.set_row(30, 32.5)
        worksheet.set_row(31, 3)
        worksheet.set_row(32, 7)
        worksheet.set_row(33, 6.5)
        worksheet.set_row(34, 18)
        worksheet.set_row(35, 18)
        worksheet.set_row(36, 2)
        worksheet.set_row(37, 6.5)
        worksheet.set_row(38, 15)
        worksheet.set_row(39, 1.5)
        worksheet.set_row(40, 0)
        worksheet.set_row(41, 12)
        worksheet.set_row(42, 1.5)
        worksheet.set_row(43, 0)
        worksheet.set_row(44, 12)
        worksheet.set_row(45, 2)
        worksheet.set_row(46, 24)
        worksheet.set_row(47, 5)
        worksheet.set_row(48, 15)
        worksheet.set_row(49, 3)
        worksheet.set_row(50, 16.5)
        worksheet.set_row(51, 10)
        worksheet.set_row(52, 10)
        worksheet.set_row(53, 10)
        worksheet.set_row(54, 2)
        worksheet.set_row(55, 13)
        worksheet.set_row(56, 3)
        worksheet.set_row(57, 11.5)
        worksheet.set_row(58, 1.5)
        worksheet.set_row(59, 2)
        worksheet.set_row(60, 14)
        worksheet.set_row(61, 28)
        worksheet.set_row(62, 5)
        worksheet.set_row(63, 14.5)
        worksheet.set_row(64, 15)
        worksheet.set_row(65, 24)
        worksheet.set_row(66, 29.5)
        worksheet.set_row(67, 5)
        worksheet.set_row(68, 14.5)
        worksheet.set_row(69, 12)
        worksheet.set_row(70, 21.5)
        worksheet.set_row(71, 5)
        worksheet.set_row(72, 12)
        worksheet.set_row(73, 18)
        worksheet.set_row(74, 28)
        worksheet.set_row(75, 5)
        worksheet.set_row(76, 16)
        worksheet.set_row(77, 24)
        worksheet.set_row(78, 28)
        worksheet.set_row(79, 4)
        worksheet.set_row(80, 19.5)
        worksheet.set_row(81, 2)
        worksheet.set_row(82, 27)
        worksheet.set_row(83, 2)
        worksheet.set_row(84, 31)
        worksheet.set_row(85, 3)
        worksheet.set_row(86, 19.5)
        worksheet.set_row(87, 17)
        worksheet.set_row(88, 3)
        worksheet.set_row(89, 40)
        worksheet.set_row(90, 4)
        worksheet.set_row(91, 0)
        worksheet.set_row(92, 15)
        worksheet.set_row(93, 15)
        worksheet.set_row(94, 14.5)
        worksheet.set_row(95, 23)
        worksheet.set_row(96, 23)
        worksheet.set_row(97, 23)
        worksheet.set_row(98, 23)
        worksheet.set_row(99, 23)
        worksheet.set_row(100, 6)
        worksheet.set_row(101, 14)
        worksheet.set_row(102, 21)
        worksheet.set_row(103, 2)
        worksheet.set_row(104, 19)
        worksheet.set_row(105, 21.5)
        worksheet.set_row(106, 5)
        worksheet.set_row(107, 10)
        worksheet.set_row(108, 10)
        worksheet.set_row(109, 10)
        worksheet.set_row(110, 10)
        worksheet.set_row(111, 10)
        worksheet.set_row(112, 10)
        worksheet.set_row(113, 10)
        worksheet.set_row(114, 10)
        worksheet.set_row(115, 10)
        worksheet.set_row(116, 16)
        worksheet.set_row(117, 14)
        worksheet.set_row(118, 12)
        worksheet.set_row(119, 8)
        worksheet.set_row(120, 10)
        worksheet.set_row(121, 5)
        worksheet.set_row(122, 14)

    def common_formats(self, formato):
        formato.set_align('center')
        formato.set_align('vcenter')
        formato.set_font_name('Arial')
        formato.set_border(1)
        formato.set_text_wrap()

    def bold_common(self, formato):
        self.common_formats(formato)
        formato.set_bold()

    def pattern_common(self, formato):
        self.common_formats(formato)
        formato.set_pattern(1)

    def bold_pattern_common(self, formato):
        self.common_formats(formato)
        formato.set_bold()
        formato.set_pattern(1)

    def set_back_column_dimension(self, reverso):
        reverso.set_column('A:A', 8.3)
        reverso.set_column('B:B', 7.7)
        reverso.set_column('C:C', 12)
        reverso.set_column('D:D', 12)
        reverso.set_column('E:E', 10.1)
        reverso.set_column('F:F', 9.4)
        reverso.set_column('G:G', 6.4)
        reverso.set_column('H:H', 5)
        reverso.set_column('I:I', 2.1)
        reverso.set_column('J:J', 6.4)
        reverso.set_column('K:K', 16.5)
        reverso.set_column('L:L', 30.7)
        reverso.set_column('M:M', 15.3)
        reverso.set_column('N:N', 15.3)
        reverso.set_column('O:O', 21.8)
        reverso.set_column('P:P', 7)
        reverso.set_column('Q:Q', 7.7)
        reverso.set_column('R:S', 12)
        reverso.set_column('T:T', 6.5)
        reverso.set_column('U:U', 6.5)
        reverso.set_column('V:V', 6.5)
        reverso.set_column('W:W', 6.5)
        reverso.set_column('X:X', 6.5)
        reverso.set_column('Y:Y', 13)
        reverso.set_column('Z:Z', 33.5)
        reverso.set_column('AA:AA', 15.2)
        reverso.set_column('AB:AB', 14.1)
        reverso.set_column('AC:AC', 31.3)

    def set_back_row_dimension(self, reverso):
        reverso.set_row(0, 53)
        reverso.set_row(1, 64)
        reverso.set_row(2, 15)
        reverso.set_row(3, 39.5)
        reverso.set_row(4, 74)
        reverso.set_row(5, 51)
        reverso.set_row(6, 47)
        reverso.set_row(7, 47)
        reverso.set_row(8, 42.5)
        reverso.set_row(9, 44)
        reverso.set_row(10, 44)
        reverso.set_row(11, 44)
        reverso.set_row(12, 47)
        reverso.set_row(13, 42.5)
        reverso.set_row(14, 42.5)
        reverso.set_row(15, 44)
        reverso.set_row(16, 47)
        reverso.set_row(17, 46)
        reverso.set_row(18, 46)
        reverso.set_row(19, 53)
        reverso.set_row(20, 36)
        reverso.set_row(21, 36)
        reverso.set_row(22, 36)
        reverso.set_row(23, 36)
        reverso.set_row(24, 36)
        reverso.set_row(25, 36)
        reverso.set_row(26, 37)
        reverso.set_row(27, 37)
        reverso.set_row(28, 37)
        reverso.set_row(29, 37)
        reverso.set_row(30, 39.5)
        reverso.set_row(31, 44)
        reverso.set_row(32, 51)
        reverso.set_row(33, 51)
        reverso.set_row(34, 51)
        reverso.set_row(35, 49)
        reverso.set_row(36, 47.5)
        reverso.set_row(37, 47)
        reverso.set_row(38, 46)
        reverso.set_row(39, 46)
        reverso.set_row(40, 39.5)
        reverso.set_row(41, 48)
        reverso.set_row(42, 48)
        reverso.set_row(43, 44)
        reverso.set_row(44, 22)
        reverso.set_row(45, 39.5)
        reverso.set_row(46, 46)
        reverso.set_row(47, 42)
        reverso.set_row(48, 44)
        reverso.set_row(49, 38)
        reverso.set_row(50, 42)
        reverso.set_row(51, 49)
        reverso.set_row(52, 6)
        reverso.set_row(53, 18)
        reverso.set_row(54, 33)
        reverso.set_row(55, 28)
        reverso.set_row(56, 26)
        reverso.set_row(57, 43)
        reverso.set_row(58, 12)
        reverso.set_row(59, 43)
        reverso.set_row(60, 40)
        reverso.set_row(61, 1.5)
        reverso.set_row(62, 25)
        reverso.set_row(63, 48)
        reverso.set_row(64, 47)
        reverso.set_row(65, 51)
        reverso.set_row(66, 25)
        reverso.set_row(67, 0)
        reverso.set_row(68, 32)
        reverso.set_row(69, 36)
        reverso.set_row(70, 21)
        reverso.set_row(71, 19)
        reverso.set_row(72, 11)


class Fua009ExcelReport(FuaBase):
    def get_book(self, output):
        workbook = xlsxwriter.Workbook(output)
        worksheet = workbook.add_worksheet('FUA009')
        worksheet.fit_to_pages(1, 1)
        worksheet.set_portrait()

        self.set_front_columns_dimension(worksheet)
        self.set_front_row_dimension(worksheet)

        section_format = workbook.add_format()
        self.bold_pattern_common(section_format)
        section_format.set_bg_color('#CCCCCC')
        section_format.set_font_size(11)

        subsection_format = workbook.add_format()
        self.bold_pattern_common(subsection_format)
        subsection_format.set_bg_color('#F2F2F2')
        subsection_format.set_font_size(10)

        item_16 = workbook.add_format()
        self.bold_common(item_16)
        item_16.set_font_size(16)

        check_format = workbook.add_format()
        self.bold_common(check_format)
        check_format.set_font_size(20)

        label_item = workbook.add_format()
        self.pattern_common(label_item)
        label_item.set_bg_color('#F2F2F2')
        label_item.set_font_size(9)

        item_section = workbook.add_format()
        self.common_formats(item_section)
        item_section.set_font_size(9)

        item_rotated = workbook.add_format()
        self.bold_pattern_common(item_rotated)
        item_rotated.set_bg_color('#F2F2F2')
        item_rotated.set_font_size(10)
        item_rotated.set_rotation(90)

        superscript = workbook.add_format({'font_script': 1})

        formato_leyenda = workbook.add_format()
        self.common_formats(formato_leyenda)
        formato_leyenda.set_font_size(7)

        formato_leyenda_8 = workbook.add_format()
        self.common_formats(formato_leyenda_8)
        formato_leyenda_8.set_font_size(8)

        responsable_formato = workbook.add_format()
        responsable_formato.set_align('vcenter')
        responsable_formato.set_align('center')
        responsable_formato.set_bold()
        responsable_formato.set_font_name('Arial')
        responsable_formato.set_font_size(11)

        subrayado = workbook.add_format()
        subrayado.set_bottom(1)

        today = timezone.now()

        worksheet.insert_image(
            'A1', settings.STATIC_ROOT + '/img/minsa_logo.png',
            {'x_scale': 0.65, 'y_scale': 0.85})
        worksheet.merge_range('A1:BM4', '')
        worksheet.merge_range(
            'A5:BM5', u'FORMATO ÚNICO DE ATENCIÓN - FUA', section_format)
        worksheet.merge_range('R6:AO6', u'NÚMERO DE FORMATO', section_format)
        worksheet.merge_range(
            'R7:W8', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('X7:AA8', str(today.year)[2:], item_16)
        worksheet.merge_range('AB7:AO8', '', item_16)
        worksheet.merge_range(
            'AR6:BH6', u'INSTITUCIÓN EDUCATIVA', section_format)
        worksheet.merge_range('AR7:BH7', '', item_section)
        worksheet.merge_range('AR8:AT8', 'INIC.', subsection_format)
        worksheet.merge_range('AU8:AX8', 'PRIM.', subsection_format)
        worksheet.merge_range('AY8:AZ8', 'SEC.', subsection_format)
        worksheet.merge_range('BA8:BC8', '', item_section)
        worksheet.merge_range('BD8:BF8', u'SECCIÓN', subsection_format)
        worksheet.merge_range('BG8:BH8', '', item_section)
        worksheet.merge_range('BI6:BM6', u'CÓDIGO', section_format)
        worksheet.merge_range('BI7:BM7', '', item_section)
        worksheet.merge_range('BI8:BK8', 'TURNO', subsection_format)
        worksheet.merge_range('BL8:BM8', '', item_section)
        worksheet.merge_range(
            'A10:BM10', u'DE LA INSTITUCIÓN PRESTADORA DE SERVICIOS DE SALUD',
            section_format)
        worksheet.merge_range(
            'A11:S12', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range(
            'A13:S13', self.control.establecimiento.codigo, item_16)
        worksheet.merge_range(
            'T11:BM12', u'NOMBRE  DE LA IPRESS QUE REALIZA LA ATENCIÓN',
            subsection_format)
        worksheet.merge_range(
            'T13:BM13', self.control.establecimiento.nombre, item_16)
        worksheet.merge_range(
            'A15:S15', 'PERSONAL QUE ATIENDE', subsection_format)
        worksheet.merge_range(
            'T15:AB15', u'LUGAR DE ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AC15:AL15', u'ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AM15:BM15', 'REFERENCIA REALIZADA POR', subsection_format)
        worksheet.merge_range('A16:E17', 'DE LA IPRESS', label_item)
        worksheet.merge_range('A18:E18', 'ITINERANTE', label_item)
        worksheet.merge_range('A19:E19', 'OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'I16:S17', u'CÓDIGO DE LA OFERTA FLEXIBLE', label_item)
        worksheet.merge_range('F16:H17', 'X', check_format)
        worksheet.merge_range('F18:H18', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('I18:S19', '', check_format)
        worksheet.merge_range('T16:Z17', 'INTRAMURAL', label_item)
        worksheet.merge_range('T18:Z18', 'EXTRAMURAL', label_item)
        worksheet.merge_range('AA16:AB17', 'X', check_format)
        worksheet.merge_range('AA18:AB18', '', check_format)
        worksheet.merge_range('T19:AB19', '')
        worksheet.merge_range('AC16:AI17', 'AMBULATORIA', label_item)
        worksheet.merge_range('AC18:AI18', 'REFERENCIA', label_item)
        worksheet.merge_range('AC19:AI19', 'EMERGENCIA', label_item)
        worksheet.merge_range('AJ16:AL17', 'X', check_format)
        worksheet.merge_range('AJ18:AL18', '', check_format)
        worksheet.merge_range('AJ19:AL19', '', check_format)
        worksheet.merge_range('AM16:AT17', u'CÓD. RENAES', label_item)
        worksheet.merge_range(
            'AU16:BI17', u'NOMBRE DE LA IPRESS U OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'BJ16:BM17', u'N° HOJA DE REFERENCIA', label_item)
        worksheet.merge_range('AM18:AT19', '', item_16)
        worksheet.merge_range('AU18:BI19', '', item_16)
        worksheet.merge_range('BJ18:BM19', '', item_16)
        worksheet.merge_range(
            'A21:BM21', 'DEL ASEGURADO / USUARIO', section_format)
        worksheet.merge_range(
            'A22:O22', u'IDENTIFICACIÓN', subsection_format)
        worksheet.merge_range('A23:B24', 'TDI', label_item)
        worksheet.merge_range('A25:B25', '1', item_16)
        worksheet.merge_range(
            'C23:O24', u'N° DOCUMENTO DE IDENTIDAD', label_item)
        worksheet.merge_range(
            'C25:O25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'Q22:AI22', u'CÓDIGO DEL ASEGURADO SIS', subsection_format)
        worksheet.merge_range('Q23:V24', 'DIRESA / OTROS', label_item)
        worksheet.merge_range(
            'Q25:V25', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('W23:AI24', u'NÚMERO', label_item)
        worksheet.merge_range('W25:Y25', '2', item_16)
        worksheet.merge_range(
            'Z25:AI25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'AK22:BM22', 'ASEGURADO DE OTRA IAFAS', subsection_format)
        worksheet.merge_range('AK23:AP24', u'INSTITUCIÓN', label_item)
        worksheet.merge_range('AQ23:BM24', '', item_16)
        worksheet.merge_range('AK25:AP25', 'COD. SEGURO', label_item)
        worksheet.merge_range('AQ25:BM25', '', item_16)
        worksheet.merge_range(
            'A27:AI27', 'APELLIDO PATERNO', subsection_format)
        worksheet.merge_range(
            'A28:AI28', self.control.paciente.apellido_paterno, item_16)
        worksheet.merge_range(
            'AK27:BM27', 'APELLIDO MATERNO', subsection_format)
        worksheet.merge_range(
            'AK28:BM28', self.control.paciente.apellido_materno, item_16)

        nombres = self.control.paciente.nombres.split(' ')
        otros_nombres = ''
        try:
            otros_nombres += nombres[1]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[2]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[3]
        except Exception as e:
            print
            str(e)

        worksheet.merge_range('A30:AI30', 'PRIMER NOMBRE', subsection_format)
        worksheet.merge_range('A31:AI31', nombres[0], item_16)
        worksheet.merge_range('AK30:BM30', 'OTROS NOMBRES', subsection_format)
        worksheet.merge_range('AK31:BM31', otros_nombres, item_16)
        worksheet.merge_range('A33:G34', 'SEXO', subsection_format)
        worksheet.merge_range('A35:D35', 'MASCULINO', item_section)
        worksheet.merge_range('E35:G35', '', check_format)
        worksheet.merge_range('A36:D36', 'FEMENINO', item_section)
        worksheet.merge_range('E36:G36', 'X', check_format)
        worksheet.merge_range('A38:G40', 'SALUD MATERNA', subsection_format)
        worksheet.merge_range('A42:D46', 'GESTANTE', item_section)
        worksheet.merge_range('E42:G46', 'X', check_format)
        worksheet.merge_range('A47:D47', 'PUERPERA', item_section)
        worksheet.merge_range('E47:G47', '', check_format)
        worksheet.merge_range('I33:Q34', 'FECHA', subsection_format)
        worksheet.merge_range(
            'I35:Q36', 'FECHA PROBABLE DE PARTO / FECHA DE PARTO',
            item_section)
        worksheet.merge_range('I38:Q42', 'FECHA DE NACIMIENTO ', item_section)
        worksheet.merge_range(
            'I45:Q47', 'FECHA DE FALLECIMIENTO', item_section)

        fecha_nacimiento = self.control.paciente.fecha_nacimiento

        if fecha_nacimiento.day / 10 < 1:
            nacimiento_dia = '0' + str(fecha_nacimiento.day)
        else:
            nacimiento_dia = str(fecha_nacimiento.day)

        if fecha_nacimiento.month / 10 < 1:
            nacimiento_mes = '0' + str(fecha_nacimiento.month)
        else:
            nacimiento_mes = str(fecha_nacimiento.month)

        nacimiento_anio = str(fecha_nacimiento.year)

        fecha_probable_parto = self.control.fecha_probable_parto

        if fecha_probable_parto.month / 10 < 1:
            parto_mes = '0' + str(fecha_probable_parto.month)
        else:
            parto_mes = str(fecha_probable_parto.month)

        if fecha_probable_parto.day / 10 < 1:
            parto_dia = '0' + str(fecha_probable_parto.day)
        else:
            parto_dia = str(fecha_probable_parto.day)

        parto_anio = str(fecha_probable_parto.year)

        worksheet.merge_range('R33:X34', 'DIA', subsection_format)
        worksheet.merge_range('R35:U36', parto_dia[0], item_16)
        worksheet.merge_range('V35:X36', parto_dia[1], item_16)
        worksheet.merge_range('R38:U42', nacimiento_dia[0], item_16)
        worksheet.merge_range('V38:X42', nacimiento_dia[1], item_16)
        worksheet.merge_range('R45:U47', '', item_16)
        worksheet.merge_range('V45:X47', '', item_16)
        worksheet.merge_range('Y33:AD34', 'MES', subsection_format)
        worksheet.merge_range('Y35:Z36', parto_mes[0], item_16)
        worksheet.merge_range('AA35:AD36', parto_mes[1], item_16)
        worksheet.merge_range('Y38:Z42', nacimiento_mes[0], item_16)
        worksheet.merge_range('AA38:AD42', nacimiento_mes[1], item_16)
        worksheet.merge_range('Y45:Z47', '', item_16)
        worksheet.merge_range('AA45:AD47', '', item_16)
        worksheet.merge_range('AE33:AP34', u'AÑO', subsection_format)
        worksheet.merge_range('AE35:AG36', parto_anio[0], item_16)
        worksheet.merge_range('AH35:AJ36', parto_anio[1], item_16)
        worksheet.merge_range('AK35:AN36', parto_anio[2], item_16)
        worksheet.merge_range('AO35:AP36', parto_anio[3], item_16)
        worksheet.merge_range('AE38:AG42', nacimiento_anio[0], item_16)
        worksheet.merge_range('AH38:AJ42', nacimiento_anio[1], item_16)
        worksheet.merge_range('AK38:AN42', nacimiento_anio[2], item_16)
        worksheet.merge_range('AO38:AP42', nacimiento_anio[3], item_16)
        worksheet.merge_range('AE45:AG47', '', item_16)
        worksheet.merge_range('AH45:AJ47', '', item_16)
        worksheet.merge_range('AK45:AN47', '', item_16)
        worksheet.merge_range('AO45:AP47', '', item_16)
        worksheet.merge_range(
            'AR33:BD34', u'N° DE HISTORIA CLÍNICA', subsection_format)
        worksheet.merge_range(
            'AR35:BD36',
            self.control.paciente.historias_clinicas.last().numero, item_16)
        worksheet.merge_range('BF33:BM34', 'ETNIA', subsection_format)
        worksheet.merge_range('BF35:BM36', self.control.paciente.etnia_nombre, item_16)
        worksheet.merge_range(
            'AR38:BG39', u'DNI / CNV / AFILIACIÓN DEL RN 1', item_section)
        worksheet.merge_range('BH38:BM39', '', item_16)
        worksheet.merge_range(
            'AR42:BG45', u'DNI / CNV / AFILIACIÓN DEL RN 2', item_section)
        worksheet.merge_range('BH42:BM45', '', item_16)
        worksheet.merge_range(
            'AR47:BG47', u'DNI / CNV / AFILIACIÓN DEL RN 3', item_section)
        worksheet.merge_range('BH47:BM47', '', item_16)
        worksheet.merge_range('A49:BM49', u'DE LA ATENCIÓN', section_format)
        worksheet.merge_range(
            'A51:R51', u'FECHA DE ATENCIÓN', subsection_format)

        atencion_fecha = self.control.atencion_fecha

        if atencion_fecha.day / 10 < 1:
            atencion_dia = '0' + str(atencion_fecha.day)
        else:
            atencion_dia = str(atencion_fecha.day)

        if atencion_fecha.month / 10 < 1:
            atencion_mes = '0' + str(atencion_fecha.month)
        else:
            atencion_mes = str(atencion_fecha.month)

        atencion_anio = str(atencion_fecha.year)

        worksheet.merge_range('A52:B53', 'DIA', item_section)
        worksheet.merge_range('A54:A58', atencion_dia[0], item_16)
        worksheet.merge_range('B54:B58', atencion_dia[1], item_16)
        worksheet.merge_range('C52:F53', 'MES', item_section)
        worksheet.merge_range('C54:C58', atencion_mes[0], item_16)
        worksheet.merge_range('D54:F58', atencion_mes[1], item_16)
        worksheet.merge_range('G52:R53', u'AÑO', item_section)
        worksheet.merge_range('G54:K58', atencion_anio[0], item_16)
        worksheet.merge_range('L54:M58', atencion_anio[1], item_16)
        worksheet.merge_range('N54:O58', atencion_anio[2], item_16)
        worksheet.merge_range('P54:R58', atencion_anio[3], item_16)

        atencion_tiempo = self.control.atencion_hora

        worksheet.merge_range('T51:Y52', 'HORA', subsection_format)
        worksheet.merge_range('T53:W58', str(atencion_tiempo.hour), item_16)
        worksheet.merge_range('X53:X58', ':', item_16)
        worksheet.merge_range('Y53:Y58', str(atencion_tiempo.minute), item_16)
        worksheet.merge_range(
            'A61:K62', 'REPORTE VINCULADO', subsection_format)
        worksheet.merge_range(
            'L61:Y61', u'CÓD. AUTORIZACIÓN', subsection_format)
        worksheet.merge_range('L62:Y62', '', item_16)
        worksheet.merge_range('AA51:AE52', 'UPS', subsection_format)
        worksheet.merge_range('AA53:AE58', '', check_format)
        worksheet.merge_range('AG51:AI52', u'CÓD. PRESTA.', subsection_format)
        worksheet.merge_range('AG53:AI58', '009', item_16)
        worksheet.merge_range(
            'AK51:AT52', u'CÓD. PRESTACION(ES) ADICIONAL (ES)',
            subsection_format)
        worksheet.merge_range('AK53:AT58', '', item_16)
        worksheet.merge_range(
            'AA61:AT61', u'N° FUA A VINCULAR', subsection_format)
        worksheet.merge_range('AA62:AT62', '', item_16)
        worksheet.merge_range('AW51:AY62', u'HOSPITALIZACIÓN', item_rotated)
        worksheet.merge_range('AZ51:BE51', 'FECHA', subsection_format)
        worksheet.merge_range('AZ52:BE54', 'DE INGRESO', item_section)
        worksheet.merge_range('AZ56:BE59', 'DE ALTA', item_section)
        worksheet.merge_range(
            'AZ61:BE62', 'DE CORTE ADMINISTRATIVO', item_section)
        worksheet.merge_range('BF51:BG51', 'DIA', subsection_format)
        worksheet.merge_range('BF52:BF54', '', item_16)
        worksheet.merge_range('BG52:BG54', '', item_16)
        worksheet.merge_range('BF56:BF59', '', item_16)
        worksheet.merge_range('BG56:BG59', '', item_16)
        worksheet.merge_range('BF61:BF62', '', item_16)
        worksheet.merge_range('BG61:BG62', '', item_16)
        worksheet.merge_range('BH51:BI51', 'MES', subsection_format)
        worksheet.merge_range('BH52:BH54', '', item_16)
        worksheet.merge_range('BI52:BI54', '', item_16)
        worksheet.merge_range('BH56:BH59', '', item_16)
        worksheet.merge_range('BI56:BI59', '', item_16)
        worksheet.merge_range('BH61:BH62', '', item_16)
        worksheet.merge_range('BI61:BI62', '', item_16)
        worksheet.merge_range('BJ51:BM51', u'AÑO', subsection_format)
        worksheet.merge_range('BJ52:BJ54', '', item_16)
        worksheet.merge_range('BK52:BK54', '', item_16)
        worksheet.merge_range('BL52:BL54', '', item_16)
        worksheet.merge_range('BM52:BM54', '', item_16)
        worksheet.merge_range('BJ56:BJ59', '', item_16)
        worksheet.merge_range('BK56:BK59', '', item_16)
        worksheet.merge_range('BL56:BL59', '', item_16)
        worksheet.merge_range('BM56:BM59', '', item_16)
        worksheet.merge_range('BJ61:BJ62', '', item_16)
        worksheet.merge_range('BK61:BK62', '', item_16)
        worksheet.merge_range('BL61:BL62', '', item_16)
        worksheet.merge_range('BM61:BM62', '', item_16)
        worksheet.merge_range(
            'A64:BM64', 'CONCEPTO PRESTACIONAL', section_format)
        worksheet.merge_range(
            'A65:C67', u'ATENCIÓN DIRECTA', subsection_format)
        worksheet.merge_range('D65:F67', 'X', check_format)
        worksheet.merge_range(
            'G65:X65', 'COB EXTRAORDINARIA', subsection_format)
        worksheet.merge_range('G66:O66', u'Nº Autorización', label_item)
        worksheet.merge_range('P66:X66', '', item_16)
        worksheet.merge_range('G67:N67', 'Monto S/.', label_item)
        worksheet.merge_range('O67:X67', '', item_16)
        worksheet.merge_range(
            'Y65:AK65', 'CARTA DE GARANTIA', subsection_format)
        worksheet.merge_range('Y66:AE66', u'Nº Autorización', label_item)
        worksheet.merge_range('AF66:AK66', '', item_16)
        worksheet.merge_range('Y67:AD67', 'Monto S/.', label_item)
        worksheet.merge_range('AE67:AK67', '', item_16)
        worksheet.merge_range('AL65:AQ67', 'TRASLADO', section_format)
        worksheet.merge_range('AR65:AS67', '', item_16)
        worksheet.merge_range('AT65:BM65', 'SEPELIO', subsection_format)
        worksheet.merge_range('AT66:BA67', 'NATIMUERTO', subsection_format)
        worksheet.merge_range('BB66:BD67', '', item_16)
        worksheet.merge_range('BE66:BG67', 'OBITO', subsection_format)
        worksheet.merge_range('BH66:BI67', '', item_16)
        worksheet.merge_range('BJ66:BK67', 'OTRO', subsection_format)
        worksheet.merge_range('BL66:BM67', '', item_16)
        worksheet.merge_range(
            'A69:BM69', 'DEL DESTINO DEL ASEGURADO/USUARIO', section_format)
        worksheet.merge_range('A70:A71', 'ALTA', label_item)
        worksheet.merge_range('B70:B71', '', item_16)
        worksheet.merge_range('C70:F71', 'CITA', label_item)
        worksheet.merge_range('G70:K71', 'X', check_format)
        worksheet.merge_range('L70:Q71', u'HOSPITALIZACIÓN', label_item)
        worksheet.merge_range('R70:S71', '', item_16)
        worksheet.merge_range('T70:AW70', 'REFERIDO', subsection_format)
        worksheet.merge_range('T71:Y71', 'EMERGENCIA', label_item)
        worksheet.merge_range('Z71:AA71', '', check_format)
        worksheet.merge_range('AB71:AI71', 'CONSULTA EXTERNA', label_item)
        worksheet.merge_range('AJ71:AL71', '', check_format)
        worksheet.merge_range('AM71:AT71', u'APOYO AL DIAGNÓSTICO', label_item)
        worksheet.merge_range('AU71:AW71', '', check_format)
        worksheet.merge_range('AX70:BC71', 'CONTRA REFERIDO', label_item)
        worksheet.merge_range('BD70:BD71', '', check_format)
        worksheet.merge_range('BE70:BH71', 'FALLECIDO', label_item)
        worksheet.merge_range('BI70:BI71', '', check_format)
        worksheet.merge_range('BJ70:BK71', 'CORTE ADMINIS.', label_item)
        worksheet.merge_range('BL70:BM71', '', check_format)
        worksheet.merge_range(
            'A73:BM73', 'SE REFIERE / CONTRARREFIERE A:', section_format)
        worksheet.merge_range(
            'A74:M74', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range('A75:M75', '', item_16)
        worksheet.merge_range(
            'N74:BC74',
            'NOMBRE DE LA IPRESS A LA QUE SE REFIERE / CONTRARREFIERE',
            subsection_format)
        worksheet.merge_range('N75:BC75', '', item_16)
        worksheet.merge_range(
            'BD74:BM74', u'N° HOJA DE REFER / CONTRARR.', subsection_format)
        worksheet.merge_range('BD75:BM75', '', item_16)
        worksheet.merge_range(
            'A77:AR77', 'ACTIVIDADES PREVENTIVAS Y OTROS', section_format)
        worksheet.merge_range('A78:I78', 'PESO (Kg)', subsection_format)
        worksheet.merge_range('J78:N78', self.control.peso, item_16)
        worksheet.merge_range('O78:X78', 'TALLA (cm)', subsection_format)
        worksheet.merge_range('Y78:AB78', self.control.embarazo.talla, item_16)
        worksheet.merge_range('AC78:AM78', 'P.A. (mmHg)', subsection_format)
        worksheet.merge_range(
            'AN78:AR78', self.control.presion_arterial, item_16)
        worksheet.merge_range('A79:D79', 'DE LA GESTANTE', subsection_format)
        worksheet.merge_range('A80:B82', u'CPN (N°)', item_section)
        worksheet.merge_range('C80:D82', str(self.control.numero), item_16)
        worksheet.merge_range('A83:B84', 'EDAD GEST', item_section)
        worksheet.merge_range(
            'C83:D84', str(self.control.calculate_edad_gestacional_semanas()),
            item_16)
        worksheet.merge_range('A85:B86', 'ALTURA UTERINA', item_section)
        if self.control.altura_uterina is None:
            worksheet.merge_range('C85:D86', '0', item_16)
        else:
            worksheet.merge_range(
                'C85:D86', self.control.altura_uterina, item_16)
        worksheet.merge_range('A87:B88', 'PARTO VERTICAL', item_section)
        worksheet.merge_range('C87:D88', '', item_16)
        worksheet.merge_range('A89:B90', u'CONTROL PUERP (N°)', item_section)
        worksheet.merge_range('C89:D90', '', item_16)
        worksheet.merge_range(
            'F79:Q79', 'DEL RECIEN NACIDO', subsection_format)
        worksheet.merge_range('F80:N81', 'EDAD GEST RN (SEM)', item_section)
        worksheet.merge_range('O80:Q81', '', item_16)
        worksheet.merge_range('F83:K85', 'APGAR', item_section)
        worksheet.merge_range('L83:L85', u'1°', item_section)
        worksheet.merge_range('M83:M85', '', item_section)
        worksheet.merge_range('N83:N85', u'5°', item_section)
        worksheet.merge_range('O83:Q85', '', item_section)
        worksheet.merge_range(
            'F87:N88', u'Corte Tardío de Cordón (2 a 3 min)', item_section)
        worksheet.merge_range('O87:Q88', '', item_16)
        worksheet.merge_range('F90:P90', '', item_section)
        worksheet.merge_range(
            'S79:AK79', u' / '.join([
                'GESTANTE', 'RN', u'NIÑO', 'ADOLESCENTE', 'JOVEN Y ADULTO',
                'ADULTO MAYOR']), subsection_format)
        worksheet.merge_range('S80:Z81', u'CRED N°', item_section)
        worksheet.merge_range('AA80:AA81', '', check_format)
        worksheet.merge_range('S83:Z83', 'R.N. PREMATURO', item_section)
        worksheet.write('AA83', '', check_format)
        worksheet.merge_range('S85:Z85', 'BAJO PESO AL NACER', item_section)
        worksheet.write('AA85', '', check_format)
        worksheet.merge_range(
            'S87:Z88', 'ENFER. CONGENITA / SECUELA AL NACER', item_section)
        worksheet.merge_range('AA87:AA88', '', check_format)
        worksheet.merge_range(
            'S90:Z90', u'N° FAMILIARES DE GEST / PUERP. CASA MAT.',
            item_section)
        worksheet.write('AA90', '', check_format)
        worksheet.merge_range('AC80:AG81', 'PAB (cm)', item_section)
        worksheet.merge_range('AH80:AK81', '', item_16)
        worksheet.merge_range('AC83:AH83', 'TAP / EEDP o TEPSI', item_section)
        worksheet.merge_range('AI83:AK83', '', item_16)
        worksheet.merge_range(
            'AC85:AH85', 'CONSEJERIA NUTRICIONAL', item_section)
        worksheet.merge_range('AI85:AK85', 'X', item_16)
        worksheet.merge_range('AC87:AH88', 'CONSEJERIA INTEGRAL', item_section)
        worksheet.merge_range('AI87:AK88', '', item_16)
        worksheet.merge_range('AC90:AH90', '', item_section)
        worksheet.write_rich_string(
            'AC90', label_item, 'IMC (Kg/M', superscript, '2', label_item,
            ')', item_section)
        worksheet.merge_range('AI90:AK90', self.control.imc, item_16)
        worksheet.merge_range('AM79:AR79', 'JOVEN Y ADULTO', label_item)
        worksheet.merge_range(
            'AM80:AP81', u'EVALUACIÓN INTEGRAL', item_section)
        worksheet.merge_range('AQ80:AR81', '', item_16)
        worksheet.merge_range('AM83:AR83', 'ADULTO MAYOR', label_item)
        worksheet.merge_range('AM84:AP85', 'VACAM', item_section)
        worksheet.merge_range('AQ84:AR85', '', item_16)
        worksheet.merge_range(
            'AM87:AP88', 'TAMIZAJE DE SALUD MENTAL', item_section)
        worksheet.merge_range('AQ87:AR87', 'PAT.', item_section)
        worksheet.merge_range('AQ88:AR88', 'NOR.', item_section)
        worksheet.merge_range('AM90:AR90', '', item_16)
        worksheet.merge_range(
            'AT77:BM77', u'VACUNAS N° DE DOSIS', section_format)
        worksheet.merge_range('AT78:AY78', 'BCG', item_section)
        worksheet.merge_range('AZ78:BB78', '', item_16)
        worksheet.merge_range('AT79:AY80', 'DPT', item_section)
        worksheet.merge_range('AZ79:BB80', '', item_16)
        worksheet.merge_range('AT81:AY82', 'APO', item_section)
        worksheet.merge_range('AZ81:BB82', '', item_16)
        worksheet.merge_range('AT83:AY84', 'ASA', item_section)
        worksheet.merge_range('AZ83:BB84', '', item_16)
        worksheet.merge_range('AT85:AY85', 'SPR', item_section)
        worksheet.merge_range('AZ85:BB85', '', item_16)
        worksheet.merge_range('AT86:AY87', 'SR', item_section)
        worksheet.merge_range('AZ86:BB87', '', item_16)
        worksheet.merge_range('AT88:AY89', 'HVB', item_section)
        worksheet.merge_range('AZ88:BB89', '', item_16)
        worksheet.merge_range('BC78:BF78', 'INFLUENZA', item_section)
        worksheet.merge_range('BG78:BH78', '', item_16)
        worksheet.merge_range('BC79:BF80', 'PAROTID', item_section)
        worksheet.merge_range('BG79:BH80', '', item_16)
        worksheet.merge_range('BC81:BF82', 'RUBEOLA', item_section)
        worksheet.merge_range('BG81:BH82', '', item_16)
        worksheet.merge_range('BC83:BF84', 'ROTAVIRUS', item_section)
        worksheet.merge_range('BG83:BH84', '', item_16)
        worksheet.merge_range(
            'BC85:BF85', u'DT ADULTO (N° DOSIS)', item_section)
        worksheet.merge_range('BG85:BH85', '', item_16)
        worksheet.merge_range('BC86:BF87', 'IPV', item_section)
        worksheet.merge_range('BG86:BH87', '', item_16)
        worksheet.merge_range('BC88:BF89', 'PENTAVAL', item_section)
        worksheet.merge_range('BG88:BH89', '', item_16)
        worksheet.merge_range('BI78:BK78', 'ANTIAMARILICA', item_section)
        worksheet.merge_range('BL78:BM78', '', item_16)
        worksheet.merge_range('BI79:BK80', 'ANTINEUMOC', item_section)
        worksheet.merge_range('BL79:BM80', '', item_16)
        worksheet.merge_range('BI81:BK82', 'ANTITETANICA', item_section)
        worksheet.merge_range('BL81:BM82', '', item_16)
        worksheet.merge_range(
            'BI83:BK84', ' COMPLETAS PARA LA EDAD', item_section)
        worksheet.merge_range('BL83:BL84', 'SI', item_section)
        worksheet.merge_range('BM83:BM84', 'NO', item_section)
        worksheet.merge_range('BI85:BK85', 'VPH', item_section)
        worksheet.merge_range('BL85:BM85', '', item_16)
        worksheet.merge_range('BI86:BK87', 'OTRA VACUNA', item_section)
        worksheet.merge_range('BL86:BM87', '', item_16)
        worksheet.merge_range('BI88:BK89', '____________', item_section)
        worksheet.merge_range('BL88:BM89', '', item_16)
        worksheet.merge_range('AT90:AZ90', 'GRUPO DE RIESGO HVB', item_section)
        worksheet.merge_range('BA90:BC90', '', item_16)
        worksheet.merge_range('BD90:BM90', '   '.join([
            'GRUPO DE RIESGO HVB: 1. TRABAJADOR DE SALUD',
            '2. TRABAJAD. SEXUALES', '3. HSH', '4. PRIVADO LIBERTAD',
            '5. FF. AA.', '6. POLICIA NACIONAL', '7. ESTUDIANTES DE SALUD',
            '8. POLITRANFUNDIDOS', '9. DROGO DEPENDIENTES ']), formato_leyenda)
        worksheet.merge_range('A93:BM93', '10', section_format)
        worksheet.merge_range('A94:A95', u'N°', subsection_format)
        worksheet.write('A96', '1', item_section)
        worksheet.write('A97', '2', item_section)
        worksheet.write('A98', '3', item_section)
        worksheet.write('A99', '4', item_section)
        worksheet.write('A100', '5', item_section)
        worksheet.merge_range('B94:AN95', u'DESCRIPCIÓN', subsection_format)

        if self.control.paciente.ultimos_embarazos.all().count() == 0:
            worksheet.merge_range(
                'B96:AN96', 'SUPERVISION DE PRIMER EMBARAZO NORMAL',
                item_section)
        else:
            worksheet.merge_range(
                'B96:AN96', 'SUPERVISION DE OTROS EMBARAZOS NORMALES',
                item_section)

        worksheet.merge_range('B97:AN97', '', item_section)
        worksheet.merge_range('B98:AN98', '', item_section)
        worksheet.merge_range('B99:AN99', '', item_section)
        worksheet.merge_range('B100:AN100', '', item_section)
        worksheet.merge_range('AO94:BD94', 'INGRESO', subsection_format)
        worksheet.merge_range('AO95:AW95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('AO96:AP96', 'P', item_section)
        worksheet.merge_range('AQ96:AS96', 'X', check_format)
        worksheet.merge_range('AT96:AW96', 'R', item_section)
        worksheet.merge_range('AO97:AP97', 'P', item_section)
        worksheet.merge_range('AQ97:AS97', 'D', item_section)
        worksheet.merge_range('AT97:AW97', 'R', item_section)
        worksheet.merge_range('AO98:AP98', 'P', item_section)
        worksheet.merge_range('AQ98:AS98', 'D', item_section)
        worksheet.merge_range('AT98:AW98', 'R', item_section)
        worksheet.merge_range('AO99:AP99', 'P', item_section)
        worksheet.merge_range('AQ99:AS99', 'D', item_section)
        worksheet.merge_range('AT99:AW99', 'R', item_section)
        worksheet.merge_range('AO100:AP100', 'P', item_section)
        worksheet.merge_range('AQ100:AS100', 'D', item_section)
        worksheet.merge_range('AT100:AW100', 'R', item_section)
        worksheet.merge_range('AX95:BD95', 'CIE - 10', subsection_format)

        if self.control.paciente.ultimos_embarazos.all().count() == 0:
            worksheet.merge_range('AX96:BD96', 'Z34.0', item_16)
        else:
            worksheet.merge_range('AX96:BD96', 'Z34.8', item_16)

        worksheet.merge_range('AX97:BD97', '', item_16)
        worksheet.merge_range('AX98:BD98', '', item_16)
        worksheet.merge_range('AX99:BD99', '', item_16)
        worksheet.merge_range('AX100:BD100', '', item_16)
        worksheet.merge_range('BE94:BM94', 'EGRESO', subsection_format)
        worksheet.merge_range('BE95:BI95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('BE96:BG96', 'D', item_section)
        worksheet.merge_range('BH96:BI96', 'R', item_section)
        worksheet.merge_range('BE97:BG97', 'D', item_section)
        worksheet.merge_range('BH97:BI97', 'R', item_section)
        worksheet.merge_range('BE98:BG98', 'D', item_section)
        worksheet.merge_range('BH98:BI98', 'R', item_section)
        worksheet.merge_range('BE99:BG99', 'D', item_section)
        worksheet.merge_range('BH99:BI99', 'R', item_section)
        worksheet.merge_range('BE100:BG100', 'D', item_section)
        worksheet.merge_range('BH100:BI100', 'R', item_section)
        worksheet.merge_range('BJ95:BM95', 'CIE - 10', subsection_format)
        worksheet.merge_range('BJ96:BM96', '', item_16)
        worksheet.merge_range('BJ97:BM97', '', item_16)
        worksheet.merge_range('BJ98:BM98', '', item_16)
        worksheet.merge_range('BJ99:BM99', '', item_16)
        worksheet.merge_range('BJ100:BM100', '', item_16)
        worksheet.merge_range('A102:N102', u'N° DE DNI', section_format)
        worksheet.merge_range('A103:N103', self.request.user.dni, item_16)
        worksheet.merge_range(
            'O102:BE102', u'NOMBRE DEL RESPONSABLE DE LA ATENCIÓN',
            section_format)
        worksheet.merge_range(
            'O103:BE103', self.request.user.get_full_name(), item_16)
        worksheet.merge_range(
            'BF102:BM102', u'N° DE COLEGIATURA', section_format)
        worksheet.merge_range(
            'BF103:BM103', self.request.user.colegiatura, item_16)
        worksheet.merge_range(
            'A105:N105', u'RESPONSABLE DE LA ATENCIÓN', subsection_format)
        worksheet.merge_range('O105:Q105', '5', item_section)
        worksheet.merge_range('R105:Y105', 'ESPECIALIDAD', subsection_format)
        worksheet.merge_range('Z105:AT105', '', item_section)
        worksheet.merge_range('AU105:AZ105', u'N° RNE', subsection_format)
        worksheet.merge_range('BA105:BE105', '', item_section)
        worksheet.merge_range('BF105:BK105', 'EGRESADO', subsection_format)
        worksheet.merge_range('BL105:BM105', '', item_16)
        worksheet.merge_range('A106:BM107', u'   '.join([
            u'1. MÉDICO', '2. FARMACEUTICO', '3. CIRUJANO DENTISTA',
            u'4. BIÓLOGO', '5. OBSTETRIZ', '6. ENFERMERA',
            '7. TRABAJADORA SOCIAL', '8. PSICOLOGA', '9.TECNOLOGO MEDICO',
            '10.NUTRICION', '11. TECNICO ENFERMERIA',
            '12. AUXILIAR DE ENFERMERIA', '13. OTRO']), formato_leyenda_8)
        worksheet.merge_range('B119:Y119', '', subrayado)
        worksheet.merge_range(
            'B121:Y121', u'FIRMA Y SELLO DEL RESPONSABLE DE LA ATENCIÓN ',
            responsable_formato)
        worksheet.merge_range('AH108:AM109', 'FIRMA', responsable_formato)
        worksheet.merge_range('AH110:AM111', 'ASEGURADO', responsable_formato)
        worksheet.merge_range('AO110:AP111', '', item_16)
        worksheet.merge_range('AH112:AM113', 'APODERADO', responsable_formato)
        worksheet.merge_range('AO112:AP113', '', item_16)
        worksheet.write('AH117', 'APODERADO:', responsable_formato)
        worksheet.merge_range('AQ117:BE117', '', subrayado)
        worksheet.write('AH118', 'NOMBRES Y APELLIDOS', responsable_formato)
        worksheet.merge_range('AQ118:BE118', '', subrayado)
        worksheet.write(
            'AH121', 'DNI o CE DEL APODERADO:', responsable_formato)
        worksheet.merge_range('AR121:BE121', '', subrayado)

        worksheet.merge_range('BH109:BL120', '', item_16)

        worksheet.merge_range(
            'BG122:BL124', 'Huella Digital del Asegurado o del Apoderado',
            item_section)

        reverso = workbook.add_worksheet('FUA009R')
        reverso.fit_to_pages(1, 1)
        reverso.set_portrait()

        self.set_back_column_dimension(reverso)
        self.set_back_row_dimension(reverso)

        titulo_reverse = workbook.add_format()
        self.bold_pattern_common(titulo_reverse)
        titulo_reverse.set_bg_color('#D9D9D9')
        titulo_reverse.set_font_size(22)

        subtitulo_reverse = workbook.add_format()
        self.bold_pattern_common(subtitulo_reverse)
        subtitulo_reverse.set_bg_color('#D9D9D9')
        subtitulo_reverse.set_font_size(20)

        item_reverso = workbook.add_format()
        self.bold_common(item_reverso)
        item_reverso.set_font_size(20)

        firma_reverso = workbook.add_format()
        firma_reverso.set_align('center')
        firma_reverso.set_align('vcenter')
        firma_reverso.set_bold()
        firma_reverso.set_font_name('Arial')
        firma_reverso.set_font_size(24)
        firma_reverso.set_text_wrap()
        firma_reverso.set_top()

        reverso.merge_range(
            'T1:AC1', u'FORMATO DE ATENCIÓN Nº', titulo_reverse)
        reverso.merge_range('T2:V2', '', item_16)
        reverso.merge_range('W2:Y2', '', item_16)
        reverso.merge_range('Z2:AC2', '', item_16)
        reverso.merge_range(
            'A4:AC4', 'PRODUCTOS FARMACEUTICOS / MEDICAMENTOS', titulo_reverse)
        reverso.merge_range('A5:B5', u'CÓDIGO SISMED', subtitulo_reverse)
        reverso.merge_range('C5:J5', 'NOMBRE', subtitulo_reverse)
        reverso.write('K5', 'FF', subtitulo_reverse)
        reverso.write('L5', 'CONCENTR', subtitulo_reverse)
        reverso.write('M5', 'PRES', subtitulo_reverse)
        reverso.write('N5', 'ENTR', subtitulo_reverse)
        reverso.write('O5', 'DX', subtitulo_reverse)
        reverso.merge_range('P5:Q5', u'CÓD. SISMED', subtitulo_reverse)
        reverso.merge_range('R5:X5', 'NOMBRE', subtitulo_reverse)
        reverso.write('Y5', 'FF', subtitulo_reverse)
        reverso.write('Z5', 'CONCENTR', subtitulo_reverse)
        reverso.write('AA5', 'PRES', subtitulo_reverse)
        reverso.write('AB5', 'ENTR', subtitulo_reverse)
        reverso.write('AC5', 'DX', subtitulo_reverse)

        if self.control.calculate_edad_gestacional_semanas() < 14:
            reverso.merge_range('A6:B6', '00200', item_reverso)
            reverso.merge_range('C6:J6', u'ACIDO FÓLICO', item_reverso)
            reverso.write('L6', '500 ug', item_reverso)
        else:
            reverso.merge_range('A6:B6', '3513', item_reverso)
            reverso.merge_range(
                'C6:J6', u'ACIDO FÓLICO + SULFATO FERROSO', item_reverso)
            reverso.write('L6', '400ug + 60mg', item_reverso)

        reverso.write('K6', 'TAB', item_reverso)
        reverso.write('M6', '30', item_reverso)
        reverso.write('N6', '30', item_reverso)
        reverso.write('O6', '1', item_reverso)

        reverso.write('Y6', '', item_reverso)
        reverso.write('Z6', '', item_reverso)
        reverso.write('AA6', '', item_reverso)
        reverso.write('AB6', '', item_reverso)
        reverso.write('AC6', '', item_reverso)

        reverso.merge_range('A7:B7', '', item_reverso)
        reverso.merge_range('A8:B8', '', item_reverso)
        reverso.merge_range('A9:B9', '', item_reverso)
        reverso.merge_range('A10:B10', '', item_reverso)
        reverso.merge_range('A11:B11', '', item_reverso)
        reverso.merge_range('A12:B12', '', item_reverso)
        reverso.merge_range('A13:B13', '', item_reverso)
        reverso.merge_range('A14:B14', '', item_reverso)
        reverso.merge_range('A15:B15', '', item_reverso)
        reverso.merge_range('A16:B16', '', item_reverso)
        reverso.merge_range('A17:B17', '', item_reverso)
        reverso.merge_range('A18:B18', '', item_reverso)
        reverso.merge_range('C7:J7', '', item_reverso)
        reverso.merge_range('C8:J8', '', item_reverso)
        reverso.merge_range('C9:J9', '', item_reverso)
        reverso.merge_range('C10:J10', '', item_reverso)
        reverso.merge_range('C11:J11', '', item_reverso)
        reverso.merge_range('C12:J12', '', item_reverso)
        reverso.merge_range('C13:J13', '', item_reverso)
        reverso.merge_range('C14:J14', '', item_reverso)
        reverso.merge_range('C15:J15', '', item_reverso)
        reverso.merge_range('C16:J16', '', item_reverso)
        reverso.merge_range('C17:J17', '', item_reverso)
        reverso.merge_range('C18:J18', '', item_reverso)
        reverso.write('K7', '', item_reverso)
        reverso.write('K8', '', item_reverso)
        reverso.write('K9', '', item_reverso)
        reverso.write('K10', '', item_reverso)
        reverso.write('K11', '', item_reverso)
        reverso.write('K12', '', item_reverso)
        reverso.write('K13', '', item_reverso)
        reverso.write('K14', '', item_reverso)
        reverso.write('K15', '', item_reverso)
        reverso.write('K16', '', item_reverso)
        reverso.write('K17', '', item_reverso)
        reverso.write('K18', '', item_reverso)
        reverso.write('L7', '', item_reverso)
        reverso.write('L8', '', item_reverso)
        reverso.write('L9', '', item_reverso)
        reverso.write('L10', '', item_reverso)
        reverso.write('L11', '', item_reverso)
        reverso.write('L12', '', item_reverso)
        reverso.write('L13', '', item_reverso)
        reverso.write('L14', '', item_reverso)
        reverso.write('L15', '', item_reverso)
        reverso.write('L16', '', item_reverso)
        reverso.write('L17', '', item_reverso)
        reverso.write('L18', '', item_reverso)
        reverso.write('M7', '', item_reverso)
        reverso.write('M8', '', item_reverso)
        reverso.write('M9', '', item_reverso)
        reverso.write('M10', '', item_reverso)
        reverso.write('M11', '', item_reverso)
        reverso.write('M12', '', item_reverso)
        reverso.write('M13', '', item_reverso)
        reverso.write('M14', '', item_reverso)
        reverso.write('M15', '', item_reverso)
        reverso.write('M16', '', item_reverso)
        reverso.write('M17', '', item_reverso)
        reverso.write('M18', '', item_reverso)
        reverso.write('N7', '', item_reverso)
        reverso.write('N8', '', item_reverso)
        reverso.write('N9', '', item_reverso)
        reverso.write('N10', '', item_reverso)
        reverso.write('N11', '', item_reverso)
        reverso.write('N12', '', item_reverso)
        reverso.write('N13', '', item_reverso)
        reverso.write('N14', '', item_reverso)
        reverso.write('N15', '', item_reverso)
        reverso.write('N16', '', item_reverso)
        reverso.write('N17', '', item_reverso)
        reverso.write('N18', '', item_reverso)
        reverso.write('O7', '', item_reverso)
        reverso.write('O8', '', item_reverso)
        reverso.write('O9', '', item_reverso)
        reverso.write('O10', '', item_reverso)
        reverso.write('O11', '', item_reverso)
        reverso.write('O12', '', item_reverso)
        reverso.write('O13', '', item_reverso)
        reverso.write('O14', '', item_reverso)
        reverso.write('O15', '', item_reverso)
        reverso.write('O16', '', item_reverso)
        reverso.write('O17', '', item_reverso)
        reverso.write('O18', '', item_reverso)
        reverso.merge_range('P6:Q6', '', item_reverso)
        reverso.merge_range('P7:Q7', '', item_reverso)
        reverso.merge_range('P8:Q8', '', item_reverso)
        reverso.merge_range('P9:Q9', '', item_reverso)
        reverso.merge_range('P10:Q10', '', item_reverso)
        reverso.merge_range('P11:Q11', '', item_reverso)
        reverso.merge_range('P12:Q12', '', item_reverso)
        reverso.merge_range('P13:Q13', '', item_reverso)
        reverso.merge_range('P14:Q14', '', item_reverso)
        reverso.merge_range('P15:Q15', '', item_reverso)
        reverso.merge_range('P16:Q16', '', item_reverso)
        reverso.merge_range('P17:Q17', '', item_reverso)
        reverso.merge_range('P18:Q18', '', item_reverso)
        reverso.merge_range('R6:X6', '', item_reverso)
        reverso.merge_range('R7:X7', '', item_reverso)
        reverso.merge_range('R8:X8', '', item_reverso)
        reverso.merge_range('R9:X9', '', item_reverso)
        reverso.merge_range('R10:X10', '', item_reverso)
        reverso.merge_range('R11:X11', '', item_reverso)
        reverso.merge_range('R12:X12', '', item_reverso)
        reverso.merge_range('R13:X13', '', item_reverso)
        reverso.merge_range('R14:X14', '', item_reverso)
        reverso.merge_range('R15:X15', '', item_reverso)
        reverso.merge_range('R16:X16', '', item_reverso)
        reverso.merge_range('R17:X17', '', item_reverso)
        reverso.merge_range('R18:X18', '', item_reverso)
        reverso.write('Y7', '', item_reverso)
        reverso.write('Y8', '', item_reverso)
        reverso.write('Y9', '', item_reverso)
        reverso.write('Y10', '', item_reverso)
        reverso.write('Y11', '', item_reverso)
        reverso.write('Y12', '', item_reverso)
        reverso.write('Y13', '', item_reverso)
        reverso.write('Y14', '', item_reverso)
        reverso.write('Y15', '', item_reverso)
        reverso.write('Y16', '', item_reverso)
        reverso.write('Y17', '', item_reverso)
        reverso.write('Y18', '', item_reverso)
        reverso.write('Z7', '', item_reverso)
        reverso.write('Z8', '', item_reverso)
        reverso.write('Z9', '', item_reverso)
        reverso.write('Z10', '', item_reverso)
        reverso.write('Z11', '', item_reverso)
        reverso.write('Z12', '', item_reverso)
        reverso.write('Z13', '', item_reverso)
        reverso.write('Z14', '', item_reverso)
        reverso.write('Z15', '', item_reverso)
        reverso.write('Z16', '', item_reverso)
        reverso.write('Z17', '', item_reverso)
        reverso.write('Z18', '', item_reverso)
        reverso.write('AA7', '', item_reverso)
        reverso.write('AA8', '', item_reverso)
        reverso.write('AA9', '', item_reverso)
        reverso.write('AA10', '', item_reverso)
        reverso.write('AA11', '', item_reverso)
        reverso.write('AA12', '', item_reverso)
        reverso.write('AA13', '', item_reverso)
        reverso.write('AA14', '', item_reverso)
        reverso.write('AA15', '', item_reverso)
        reverso.write('AA16', '', item_reverso)
        reverso.write('AA17', '', item_reverso)
        reverso.write('AA18', '', item_reverso)
        reverso.write('AB7', '', item_reverso)
        reverso.write('AB8', '', item_reverso)
        reverso.write('AB9', '', item_reverso)
        reverso.write('AB10', '', item_reverso)
        reverso.write('AB11', '', item_reverso)
        reverso.write('AB12', '', item_reverso)
        reverso.write('AB13', '', item_reverso)
        reverso.write('AB14', '', item_reverso)
        reverso.write('AB15', '', item_reverso)
        reverso.write('AB16', '', item_reverso)
        reverso.write('AB17', '', item_reverso)
        reverso.write('AB18', '', item_reverso)
        reverso.write('AC7', '', item_reverso)
        reverso.write('AC8', '', item_reverso)
        reverso.write('AC9', '', item_reverso)
        reverso.write('AC10', '', item_reverso)
        reverso.write('AC11', '', item_reverso)
        reverso.write('AC12', '', item_reverso)
        reverso.write('AC13', '', item_reverso)
        reverso.write('AC14', '', item_reverso)
        reverso.write('AC15', '', item_reverso)
        reverso.write('AC16', '', item_reverso)
        reverso.write('AC17', '', item_reverso)
        reverso.write('AC18', '', item_reverso)
        reverso.merge_range(
            'A19:AC19', u'DISPOSITIVOS MÉDICOS / PRODUCTOS SANITARIOS',
            titulo_reverse)
        reverso.merge_range('A20:B20', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A21:B21', '', item_reverso)
        reverso.merge_range('A22:B22', '', item_reverso)
        reverso.merge_range('A23:B23', '', item_reverso)
        reverso.merge_range('A24:B24', '', item_reverso)
        reverso.merge_range('A25:B25', '', item_reverso)
        reverso.merge_range('A26:B26', '', item_reverso)
        reverso.merge_range('A27:B27', '', item_reverso)
        reverso.merge_range('A28:B28', '', item_reverso)
        reverso.merge_range('A29:B29', '', item_reverso)
        reverso.merge_range('C20:J20', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C21:J21', '', item_reverso)
        reverso.merge_range('C22:J22', '', item_reverso)
        reverso.merge_range('C23:J23', '', item_reverso)
        reverso.merge_range('C24:J24', '', item_reverso)
        reverso.merge_range('C25:J25', '', item_reverso)
        reverso.merge_range('C26:J26', '', item_reverso)
        reverso.merge_range('C27:J27', '', item_reverso)
        reverso.merge_range('C28:J28', '', item_reverso)
        reverso.merge_range('C29:J29', '', item_reverso)
        reverso.write('K20', 'PR', subtitulo_reverse)
        reverso.write('K21', '', item_reverso)
        reverso.write('K22', '', item_reverso)
        reverso.write('K23', '', item_reverso)
        reverso.write('K24', '', item_reverso)
        reverso.write('K25', '', item_reverso)
        reverso.write('K26', '', item_reverso)
        reverso.write('K27', '', item_reverso)
        reverso.write('K28', '', item_reverso)
        reverso.write('K29', '', item_reverso)
        reverso.write('L20', 'CARACT', subtitulo_reverse)
        reverso.write('L21', '', item_reverso)
        reverso.write('L22', '', item_reverso)
        reverso.write('L23', '', item_reverso)
        reverso.write('L24', '', item_reverso)
        reverso.write('L25', '', item_reverso)
        reverso.write('L26', '', item_reverso)
        reverso.write('L27', '', item_reverso)
        reverso.write('L28', '', item_reverso)
        reverso.write('L29', '', item_reverso)
        reverso.write('M20', 'PRES', subtitulo_reverse)
        reverso.write('M21', '', item_reverso)
        reverso.write('M22', '', item_reverso)
        reverso.write('M23', '', item_reverso)
        reverso.write('M24', '', item_reverso)
        reverso.write('M25', '', item_reverso)
        reverso.write('M26', '', item_reverso)
        reverso.write('M27', '', item_reverso)
        reverso.write('M28', '', item_reverso)
        reverso.write('M29', '', item_reverso)
        reverso.write('N20', 'ENTR', subtitulo_reverse)
        reverso.write('N21', '', item_reverso)
        reverso.write('N22', '', item_reverso)
        reverso.write('N23', '', item_reverso)
        reverso.write('N24', '', item_reverso)
        reverso.write('N25', '', item_reverso)
        reverso.write('N26', '', item_reverso)
        reverso.write('N27', '', item_reverso)
        reverso.write('N28', '', item_reverso)
        reverso.write('N29', '', item_reverso)
        reverso.write('O20', 'DX', subtitulo_reverse)
        reverso.write('O21', '', item_reverso)
        reverso.write('O22', '', item_reverso)
        reverso.write('O23', '', item_reverso)
        reverso.write('O24', '', item_reverso)
        reverso.write('O25', '', item_reverso)
        reverso.write('O26', '', item_reverso)
        reverso.write('O27', '', item_reverso)
        reverso.write('O28', '', item_reverso)
        reverso.write('O29', '', item_reverso)
        reverso.merge_range('P20:Q20', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('P21:Q21', '', item_reverso)
        reverso.merge_range('P22:Q22', '', item_reverso)
        reverso.merge_range('P23:Q23', '', item_reverso)
        reverso.merge_range('P24:Q24', '', item_reverso)
        reverso.merge_range('P25:Q25', '', item_reverso)
        reverso.merge_range('P26:Q26', '', item_reverso)
        reverso.merge_range('P27:Q27', '', item_reverso)
        reverso.merge_range('P28:Q28', '', item_reverso)
        reverso.merge_range('P29:Q29', '', item_reverso)
        reverso.merge_range('R20:X20', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('R21:X21', '', item_reverso)
        reverso.merge_range('R22:X22', '', item_reverso)
        reverso.merge_range('R23:X23', '', item_reverso)
        reverso.merge_range('R24:X24', '', item_reverso)
        reverso.merge_range('R25:X25', '', item_reverso)
        reverso.merge_range('R26:X26', '', item_reverso)
        reverso.merge_range('R27:X27', '', item_reverso)
        reverso.merge_range('R28:X28', '', item_reverso)
        reverso.merge_range('R29:X29', '', item_reverso)
        reverso.write('Y20', 'PR', subtitulo_reverse)
        reverso.write('Y21', '', item_reverso)
        reverso.write('Y22', '', item_reverso)
        reverso.write('Y23', '', item_reverso)
        reverso.write('Y24', '', item_reverso)
        reverso.write('Y25', '', item_reverso)
        reverso.write('Y26', '', item_reverso)
        reverso.write('Y27', '', item_reverso)
        reverso.write('Y28', '', item_reverso)
        reverso.write('Y29', '', item_reverso)
        reverso.write('Z20', 'CARACT', subtitulo_reverse)
        reverso.write('Z21', '', item_reverso)
        reverso.write('Z22', '', item_reverso)
        reverso.write('Z23', '', item_reverso)
        reverso.write('Z24', '', item_reverso)
        reverso.write('Z25', '', item_reverso)
        reverso.write('Z26', '', item_reverso)
        reverso.write('Z27', '', item_reverso)
        reverso.write('Z28', '', item_reverso)
        reverso.write('Z29', '', item_reverso)
        reverso.write('AA20', 'PRES', subtitulo_reverse)
        reverso.write('AA21', '', item_reverso)
        reverso.write('AA22', '', item_reverso)
        reverso.write('AA23', '', item_reverso)
        reverso.write('AA24', '', item_reverso)
        reverso.write('AA25', '', item_reverso)
        reverso.write('AA26', '', item_reverso)
        reverso.write('AA27', '', item_reverso)
        reverso.write('AA28', '', item_reverso)
        reverso.write('AA29', '', item_reverso)
        reverso.write('AB20', 'ENTR', subtitulo_reverse)
        reverso.write('AB21', '', item_reverso)
        reverso.write('AB22', '', item_reverso)
        reverso.write('AB23', '', item_reverso)
        reverso.write('AB24', '', item_reverso)
        reverso.write('AB25', '', item_reverso)
        reverso.write('AB26', '', item_reverso)
        reverso.write('AB27', '', item_reverso)
        reverso.write('AB28', '', item_reverso)
        reverso.write('AB29', '', item_reverso)
        reverso.write('AC20', 'DX', subtitulo_reverse)
        reverso.write('AC21', '', item_reverso)
        reverso.write('AC22', '', item_reverso)
        reverso.write('AC23', '', item_reverso)
        reverso.write('AC24', '', item_reverso)
        reverso.write('AC25', '', item_reverso)
        reverso.write('AC26', '', item_reverso)
        reverso.write('AC27', '', item_reverso)
        reverso.write('AC28', '', item_reverso)
        reverso.write('AC29', '', item_reverso)
        reverso.merge_range(
            'A30:AC30',
            u'PROCEDIMIENTOS/ DIAGNÓSTICO POR IMÁGENES/ LABORATORIO',
            titulo_reverse)
        reverso.merge_range('A31:B31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A32:B32', '59400', item_reverso)
        reverso.merge_range('A33:B33', '', item_reverso)
        reverso.merge_range('A34:B34', '', item_reverso)
        reverso.merge_range('A35:B35', '', item_reverso)
        reverso.merge_range('A36:B36', '', item_reverso)
        reverso.merge_range('A37:B37', '', item_reverso)
        reverso.merge_range('A38:B38', '', item_reverso)
        reverso.merge_range('A39:B39', '', item_reverso)
        reverso.merge_range('A40:B40', '', item_reverso)
        reverso.merge_range('A41:B41', '', item_reverso)
        reverso.merge_range('A42:B42', '', item_reverso)
        reverso.merge_range('C31:K31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range(
            'C32:K32', 'ATENCION OBSTETRICA DE RUTINA', item_reverso)
        reverso.merge_range('C33:K33', '', item_reverso)
        reverso.merge_range('C34:K34', '', item_reverso)
        reverso.merge_range('C35:K35', '', item_reverso)
        reverso.merge_range('C36:K36', '', item_reverso)
        reverso.merge_range('C37:K37', '', item_reverso)
        reverso.merge_range('C38:K38', '', item_reverso)
        reverso.merge_range('C39:K39', '', item_reverso)
        reverso.merge_range('C40:K40', '', item_reverso)
        reverso.merge_range('C41:K41', '', item_reverso)
        reverso.merge_range('C42:K42', '', item_reverso)
        reverso.write('L31', 'IND', subtitulo_reverse)
        reverso.write('L32', '1', item_reverso)
        reverso.write('L33', '', item_reverso)
        reverso.write('L34', '', item_reverso)
        reverso.write('L35', '', item_reverso)
        reverso.write('L36', '', item_reverso)
        reverso.write('L37', '', item_reverso)
        reverso.write('L38', '', item_reverso)
        reverso.write('L39', '', item_reverso)
        reverso.write('L40', '', item_reverso)
        reverso.write('L41', '', item_reverso)
        reverso.write('L42', '', item_reverso)
        reverso.write('M31', 'EJE', subtitulo_reverse)
        reverso.write('M32', '1', item_reverso)
        reverso.write('M33', '', item_reverso)
        reverso.write('M34', '', item_reverso)
        reverso.write('M35', '', item_reverso)
        reverso.write('M36', '', item_reverso)
        reverso.write('M37', '', item_reverso)
        reverso.write('M38', '', item_reverso)
        reverso.write('M39', '', item_reverso)
        reverso.write('M40', '', item_reverso)
        reverso.write('M41', '', item_reverso)
        reverso.write('M42', '', item_reverso)
        reverso.write('N31', 'DX', subtitulo_reverse)
        reverso.write('N32', '1', item_reverso)
        reverso.write('N33', '', item_reverso)
        reverso.write('N34', '', item_reverso)
        reverso.write('N35', '', item_reverso)
        reverso.write('N36', '', item_reverso)
        reverso.write('N37', '', item_reverso)
        reverso.write('N38', '', item_reverso)
        reverso.write('N39', '', item_reverso)
        reverso.write('N40', '', item_reverso)
        reverso.write('N41', '', item_reverso)
        reverso.write('N42', '', item_reverso)
        reverso.write('O31', 'RES', subtitulo_reverse)
        reverso.write('O32', '', item_reverso)
        reverso.write('O33', '', item_reverso)
        reverso.write('O34', '', item_reverso)
        reverso.write('O35', '', item_reverso)
        reverso.write('O36', '', item_reverso)
        reverso.write('O37', '', item_reverso)
        reverso.write('O38', '', item_reverso)
        reverso.write('O39', '', item_reverso)
        reverso.write('O40', '', item_reverso)
        reverso.write('O41', '', item_reverso)
        reverso.write('O42', '', item_reverso)
        reverso.merge_range('P31:Q31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('P32:Q32', '', item_reverso)
        reverso.merge_range('P33:Q33', '', item_reverso)
        reverso.merge_range('P34:Q34', '', item_reverso)
        reverso.merge_range('P35:Q35', '', item_reverso)
        reverso.merge_range('P36:Q36', '', item_reverso)
        reverso.merge_range('P37:Q37', '', item_reverso)
        reverso.merge_range('P38:Q38', '', item_reverso)
        reverso.merge_range('P39:Q39', '', item_reverso)
        reverso.merge_range('P40:Q40', '', item_reverso)
        reverso.merge_range('P41:Q41', '', item_reverso)
        reverso.merge_range('P42:Q42', '', item_reverso)
        reverso.merge_range('R31:Y31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('R32:Y32', '', item_reverso)
        reverso.merge_range('R33:Y33', '', item_reverso)
        reverso.merge_range('R34:Y34', '', item_reverso)
        reverso.merge_range('R35:Y35', '', item_reverso)
        reverso.merge_range('R36:Y36', '', item_reverso)
        reverso.merge_range('R37:Y37', '', item_reverso)
        reverso.merge_range('R38:Y38', '', item_reverso)
        reverso.merge_range('R39:Y39', '', item_reverso)
        reverso.merge_range('R40:Y40', '', item_reverso)
        reverso.merge_range('R41:Y41', '', item_reverso)
        reverso.merge_range('R42:Y42', '', item_reverso)
        reverso.write('Z31', 'IND', subtitulo_reverse)
        reverso.write('Z32', '', item_reverso)
        reverso.write('Z33', '', item_reverso)
        reverso.write('Z34', '', item_reverso)
        reverso.write('Z35', '', item_reverso)
        reverso.write('Z36', '', item_reverso)
        reverso.write('Z37', '', item_reverso)
        reverso.write('Z38', '', item_reverso)
        reverso.write('Z39', '', item_reverso)
        reverso.write('Z40', '', item_reverso)
        reverso.write('Z41', '', item_reverso)
        reverso.write('Z42', '', item_reverso)
        reverso.write('AA31', 'EJE', subtitulo_reverse)
        reverso.write('AA32', '', item_reverso)
        reverso.write('AA33', '', item_reverso)
        reverso.write('AA34', '', item_reverso)
        reverso.write('AA35', '', item_reverso)
        reverso.write('AA36', '', item_reverso)
        reverso.write('AA37', '', item_reverso)
        reverso.write('AA38', '', item_reverso)
        reverso.write('AA39', '', item_reverso)
        reverso.write('AA40', '', item_reverso)
        reverso.write('AA41', '', item_reverso)
        reverso.write('AA42', '', item_reverso)
        reverso.write('AB31', 'DX', subtitulo_reverse)
        reverso.write('AB32', '', item_reverso)
        reverso.write('AB33', '', item_reverso)
        reverso.write('AB34', '', item_reverso)
        reverso.write('AB35', '', item_reverso)
        reverso.write('AB36', '', item_reverso)
        reverso.write('AB37', '', item_reverso)
        reverso.write('AB38', '', item_reverso)
        reverso.write('AB39', '', item_reverso)
        reverso.write('AB40', '', item_reverso)
        reverso.write('AB41', '', item_reverso)
        reverso.write('AB42', '', item_reverso)
        reverso.write('AC31', 'RES', subtitulo_reverse)
        reverso.write('AC32', '', item_reverso)
        reverso.write('AC33', '', item_reverso)
        reverso.write('AC34', '', item_reverso)
        reverso.write('AC35', '', item_reverso)
        reverso.write('AC36', '', item_reverso)
        reverso.write('AC37', '', item_reverso)
        reverso.write('AC38', '', item_reverso)
        reverso.write('AC39', '', item_reverso)
        reverso.write('AC40', '', item_reverso)
        reverso.write('AC41', '', item_reverso)
        reverso.write('AC42', '', item_reverso)
        reverso.merge_range(
            'A43:AC43', 'SUB COMPONENTE PRESTACIONAL (PROCEDIMIENTOS)',
            titulo_reverse)
        reverso.merge_range('A44:B45', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A46:B46', '', item_reverso)
        reverso.merge_range('A47:B47', '', item_reverso)
        reverso.merge_range('A48:B48', '', item_reverso)
        reverso.merge_range('A49:B49', '', item_reverso)
        reverso.merge_range('A50:B50', '', item_reverso)
        reverso.merge_range('C44:M45', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C46:M46', '', item_reverso)
        reverso.merge_range('C47:M47', '', item_reverso)
        reverso.merge_range('C48:M48', '', item_reverso)
        reverso.merge_range('C49:M49', '', item_reverso)
        reverso.merge_range('C50:M50', '', item_reverso)
        reverso.merge_range('N44:Q45', 'CARACT', subtitulo_reverse)
        reverso.merge_range('N46:Q46', '', item_reverso)
        reverso.merge_range('N47:Q47', '', item_reverso)
        reverso.merge_range('N48:Q48', '', item_reverso)
        reverso.merge_range('N49:Q49', '', item_reverso)
        reverso.merge_range('N50:Q50', '', item_reverso)
        reverso.merge_range('R44:T45', 'IND/ PRES', subtitulo_reverse)
        reverso.merge_range('R46:T46', '', item_reverso)
        reverso.merge_range('R47:T47', '', item_reverso)
        reverso.merge_range('R48:T48', '', item_reverso)
        reverso.merge_range('R49:T49', '', item_reverso)
        reverso.merge_range('R50:T50', '', item_reverso)
        reverso.merge_range('U44:W45', 'EJE/ ENTR', subtitulo_reverse)
        reverso.merge_range('U46:W46', '', item_reverso)
        reverso.merge_range('U47:W47', '', item_reverso)
        reverso.merge_range('U48:W48', '', item_reverso)
        reverso.merge_range('U49:W49', '', item_reverso)
        reverso.merge_range('U50:W50', '', item_reverso)
        reverso.merge_range('X44:Y45', 'DX', subtitulo_reverse)
        reverso.merge_range('X46:Y46', '', item_reverso)
        reverso.merge_range('X47:Y47', '', item_reverso)
        reverso.merge_range('X48:Y48', '', item_reverso)
        reverso.merge_range('X49:Y49', '', item_reverso)
        reverso.merge_range('X50:Y50', '', item_reverso)
        reverso.merge_range('Z44:Z45', 'RES', subtitulo_reverse)
        reverso.write('Z46', '', item_reverso)
        reverso.write('Z47', '', item_reverso)
        reverso.write('Z48', '', item_reverso)
        reverso.write('Z49', '', item_reverso)
        reverso.write('Z50', '', item_reverso)
        reverso.merge_range('AA44:AA45', u'N° TICKET', subtitulo_reverse)
        reverso.write('AA46', '', item_reverso)
        reverso.write('AA47', '', item_reverso)
        reverso.write('AA48', '', item_reverso)
        reverso.write('AA49', '', item_reverso)
        reverso.write('AA50', '', item_reverso)
        reverso.merge_range('AB44:AC45', 'PO', subtitulo_reverse)
        reverso.merge_range('AB46:AC46', '', item_reverso)
        reverso.merge_range('AB47:AC47', '', item_reverso)
        reverso.merge_range('AB48:AC48', '', item_reverso)
        reverso.merge_range('AB49:AC49', '', item_reverso)
        reverso.merge_range('AB50:AC50', '', item_reverso)
        reverso.merge_range('A51:AC51', 'OBSERVACIONES', subtitulo_reverse)
        reverso.merge_range('A52:AC53', '', item_reverso)
        reverso.merge_range('A54:AC55', '', item_reverso)
        reverso.merge_range('A56:AC57', '', item_reverso)
        reverso.merge_range('A58:AC59', '', item_reverso)
        reverso.merge_range(
            'B70:K71', '/'.join([
                'Firma y Sello del Responsable de Procedimiento y',
                'o Farmacia y', 'o Laboratorio']), firma_reverso)
        reverso.merge_range('R61:V69', '', item_16)
        reverso.merge_range(
            'R70:V71', 'Huella Digital del Asegurado o del Apoderado', firma_reverso)

        workbook.close()
        return workbook


class Fua011ExcelReport(FuaBase):
    def get_book(self, output):
        workbook = xlsxwriter.Workbook(output)
        worksheet = workbook.add_worksheet('FUA011')
        worksheet.fit_to_pages(1, 1)
        worksheet.set_portrait()

        self.set_front_columns_dimension(worksheet)
        self.set_front_row_dimension(worksheet)

        section_format = workbook.add_format()
        self.bold_pattern_common(section_format)
        section_format.set_bg_color('#CCCCCC')
        section_format.set_font_size(11)

        subsection_format = workbook.add_format()
        self.bold_pattern_common(subsection_format)
        subsection_format.set_bg_color('#F2F2F2')
        subsection_format.set_font_size(10)

        item_16 = workbook.add_format()
        self.bold_common(item_16)
        item_16.set_font_size(16)

        check_format = workbook.add_format()
        self.bold_common(check_format)
        check_format.set_font_size(20)

        label_item = workbook.add_format()
        self.pattern_common(label_item)
        label_item.set_bg_color('#F2F2F2')
        label_item.set_font_size(9)

        item_section = workbook.add_format()
        self.common_formats(item_section)
        item_section.set_font_size(9)

        item_rotated = workbook.add_format()
        self.bold_pattern_common(item_rotated)
        item_rotated.set_bg_color('#F2F2F2')
        item_rotated.set_font_size(10)
        item_rotated.set_rotation(90)

        superscript = workbook.add_format({'font_script': 1})

        formato_leyenda = workbook.add_format()
        self.common_formats(formato_leyenda)
        formato_leyenda.set_font_size(7)

        formato_leyenda_8 = workbook.add_format()
        self.common_formats(formato_leyenda_8)
        formato_leyenda_8.set_font_size(8)

        responsable_formato = workbook.add_format()
        responsable_formato.set_align('vcenter')
        responsable_formato.set_bold()
        responsable_formato.set_font_name('Arial')
        responsable_formato.set_font_size(11)

        subrayado = workbook.add_format()
        subrayado.set_bottom(1)

        today = timezone.now()

        worksheet.insert_image(
            'A1', settings.STATIC_ROOT + '/img/minsa_logo.png',
            {'x_scale': 0.65, 'y_scale': 0.85})
        worksheet.merge_range('A1:BM4', '')
        worksheet.merge_range(
            'A5:BM5', u'FORMATO ÚNICO DE ATENCIÓN - FUA', section_format)
        worksheet.merge_range('R6:AO6', u'NÚMERO DE FORMATO', section_format)
        worksheet.merge_range(
            'R7:W8', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('X7:AA8', str(today.year)[2:], item_16)
        worksheet.merge_range('AB7:AO8', '', item_16)
        worksheet.merge_range(
            'AR6:BH6', u'INSTITUCIÓN EDUCATIVA', section_format)
        worksheet.merge_range('AR7:BH7', '', item_section)
        worksheet.merge_range('AR8:AT8', 'INIC.', subsection_format)
        worksheet.merge_range('AU8:AX8', 'PRIM.', subsection_format)
        worksheet.merge_range('AY8:AZ8', 'SEC.', subsection_format)
        worksheet.merge_range('BA8:BC8', '', item_section)
        worksheet.merge_range('BD8:BF8', u'SECCIÓN', subsection_format)
        worksheet.merge_range('BG8:BH8', '', item_section)
        worksheet.merge_range('BI6:BM6', u'CÓDIGO', section_format)
        worksheet.merge_range('BI7:BM7', '', item_section)
        worksheet.merge_range('BI8:BK8', 'TURNO', subsection_format)
        worksheet.merge_range('BL8:BM8', '', item_section)
        worksheet.merge_range(
            'A10:BM10', u'DE LA INSTITUCIÓN PRESTADORA DE SERVICIOS DE SALUD',
            section_format)
        worksheet.merge_range(
            'A11:S12', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range(
            'A13:S13', self.control.establecimiento.codigo, item_16)
        worksheet.merge_range(
            'T11:BM12', u'NOMBRE  DE LA IPRESS QUE REALIZA LA ATENCIÓN',
            subsection_format)
        worksheet.merge_range(
            'T13:BM13', self.control.establecimiento.nombre, item_16)
        worksheet.merge_range(
            'A15:S15', 'PERSONAL QUE ATIENDE', subsection_format)
        worksheet.merge_range(
            'T15:AB15', u'LUGAR DE ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AC15:AL15', u'ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AM15:BM15', 'REFERENCIA REALIZADA POR', subsection_format)
        worksheet.merge_range('A16:E17', 'DE LA IPRESS', label_item)
        worksheet.merge_range('A18:E18', 'ITINERANTE', label_item)
        worksheet.merge_range('A19:E19', 'OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'I16:S17', u'CÓDIGO DE LA OFERTA FLEXIBLE', label_item)
        worksheet.merge_range('F16:H17', 'X', check_format)
        worksheet.merge_range('F18:H18', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('I18:S19', '', check_format)
        worksheet.merge_range('T16:Z17', 'INTRAMURAL', label_item)
        worksheet.merge_range('T18:Z18', 'EXTRAMURAL', label_item)
        worksheet.merge_range('AA16:AB17', 'X', check_format)
        worksheet.merge_range('AA18:AB18', '', check_format)
        worksheet.merge_range('T19:AB19', '')
        worksheet.merge_range('AC16:AI17', 'AMBULATORIA', label_item)
        worksheet.merge_range('AC18:AI18', 'REFERENCIA', label_item)
        worksheet.merge_range('AC19:AI19', 'EMERGENCIA', label_item)
        worksheet.merge_range('AJ16:AL17', 'X', check_format)
        worksheet.merge_range('AJ18:AL18', '', check_format)
        worksheet.merge_range('AJ19:AL19', '', check_format)
        worksheet.merge_range('AM16:AT17', u'CÓD. RENAES', label_item)
        worksheet.merge_range(
            'AU16:BI17', u'NOMBRE DE LA IPRESS U OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'BJ16:BM17', u'N° HOJA DE REFERENCIA', label_item)
        worksheet.merge_range('AM18:AT19', '', item_16)
        worksheet.merge_range('AU18:BI19', '', item_16)
        worksheet.merge_range('BJ18:BM19', '', item_16)
        worksheet.merge_range(
            'A21:BM21', 'DEL ASEGURADO / USUARIO', section_format)
        worksheet.merge_range(
            'A22:O22', u'IDENTIFICACIÓN', subsection_format)
        worksheet.merge_range('A23:B24', 'TDI', label_item)
        worksheet.merge_range('A25:B25', '1', item_16)
        worksheet.merge_range(
            'C23:O24', u'N° DOCUMENTO DE IDENTIDAD', label_item)
        worksheet.merge_range(
            'C25:O25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'Q22:AI22', u'CÓDIGO DEL ASEGURADO SIS', subsection_format)
        worksheet.merge_range('Q23:V24', 'DIRESA / OTROS', label_item)
        worksheet.merge_range(
            'Q25:V25', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('W23:AI24', u'NÚMERO', label_item)
        worksheet.merge_range('W25:Y25', '2', item_16)
        worksheet.merge_range(
            'Z25:AI25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'AK22:BM22', 'ASEGURADO DE OTRA IAFAS', subsection_format)
        worksheet.merge_range('AK23:AP24', u'INSTITUCIÓN', label_item)
        worksheet.merge_range('AQ23:BM24', '', item_16)
        worksheet.merge_range('AK25:AP25', 'COD. SEGURO', label_item)
        worksheet.merge_range('AQ25:BM25', '', item_16)
        worksheet.merge_range(
            'A27:AI27', 'APELLIDO PATERNO', subsection_format)
        worksheet.merge_range(
            'A28:AI28', self.control.paciente.apellido_paterno, item_16)
        worksheet.merge_range(
            'AK27:BM27', 'APELLIDO MATERNO', subsection_format)
        worksheet.merge_range(
            'AK28:BM28', self.control.paciente.apellido_materno, item_16)

        nombres = self.control.paciente.nombres.split(' ')
        otros_nombres = ''
        try:
            otros_nombres += nombres[1]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[2]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[3]
        except Exception as e:
            print
            str(e)

        worksheet.merge_range('A30:AI30', 'PRIMER NOMBRE', subsection_format)
        worksheet.merge_range('A31:AI31', nombres[0], item_16)
        worksheet.merge_range('AK30:BM30', 'OTROS NOMBRES', subsection_format)
        worksheet.merge_range('AK31:BM31', otros_nombres, item_16)
        worksheet.merge_range('A33:G34', 'SEXO', subsection_format)
        worksheet.merge_range('A35:D35', 'MASCULINO', item_section)
        worksheet.merge_range('E35:G35', '', check_format)
        worksheet.merge_range('A36:D36', 'FEMENINO', item_section)
        worksheet.merge_range('E36:G36', 'X', check_format)
        worksheet.merge_range('A38:G40', 'SALUD MATERNA', subsection_format)
        worksheet.merge_range('A42:D46', 'GESTANTE', item_section)
        worksheet.merge_range('E42:G46', 'X', check_format)
        worksheet.merge_range('A47:D47', 'PUERPERA', item_section)
        worksheet.merge_range('E47:G47', '', check_format)
        worksheet.merge_range('I33:Q34', 'FECHA', subsection_format)
        worksheet.merge_range(
            'I35:Q36', 'FECHA PROBABLE DE PARTO / FECHA DE PARTO',
            item_section)
        worksheet.merge_range('I38:Q42', 'FECHA DE NACIMIENTO ', item_section)
        worksheet.merge_range(
            'I45:Q47', 'FECHA DE FALLECIMIENTO', item_section)

        fecha_nacimiento = self.control.paciente.fecha_nacimiento

        if fecha_nacimiento.day / 10 < 1:
            nacimiento_dia = '0' + str(fecha_nacimiento.day)
        else:
            nacimiento_dia = str(fecha_nacimiento.day)

        if fecha_nacimiento.month / 10 < 1:
            nacimiento_mes = '0' + str(fecha_nacimiento.month)
        else:
            nacimiento_mes = str(fecha_nacimiento.month)

        nacimiento_anio = str(fecha_nacimiento.year)

        fecha_probable_parto = self.control.fecha_probable_parto

        if fecha_probable_parto.month / 10 < 1:
            parto_mes = '0' + str(fecha_probable_parto.month)
        else:
            parto_mes = str(fecha_probable_parto.month)

        if fecha_probable_parto.day / 10 < 1:
            parto_dia = '0' + str(fecha_probable_parto.day)
        else:
            parto_dia = str(fecha_probable_parto.day)

        parto_anio = str(fecha_probable_parto.year)

        worksheet.merge_range('R33:X34', 'DIA', subsection_format)
        worksheet.merge_range('R35:U36', parto_dia[0], item_16)
        worksheet.merge_range('V35:X36', parto_dia[1], item_16)
        worksheet.merge_range('R38:U42', nacimiento_dia[0], item_16)
        worksheet.merge_range('V38:X42', nacimiento_dia[1], item_16)
        worksheet.merge_range('R45:U47', '', item_16)
        worksheet.merge_range('V45:X47', '', item_16)
        worksheet.merge_range('Y33:AD34', 'MES', subsection_format)
        worksheet.merge_range('Y35:Z36', parto_mes[0], item_16)
        worksheet.merge_range('AA35:AD36', parto_mes[1], item_16)
        worksheet.merge_range('Y38:Z42', nacimiento_mes[0], item_16)
        worksheet.merge_range('AA38:AD42', nacimiento_mes[1], item_16)
        worksheet.merge_range('Y45:Z47', '', item_16)
        worksheet.merge_range('AA45:AD47', '', item_16)
        worksheet.merge_range('AE33:AP34', u'AÑO', subsection_format)
        worksheet.merge_range('AE35:AG36', parto_anio[0], item_16)
        worksheet.merge_range('AH35:AJ36', parto_anio[1], item_16)
        worksheet.merge_range('AK35:AN36', parto_anio[2], item_16)
        worksheet.merge_range('AO35:AP36', parto_anio[3], item_16)
        worksheet.merge_range('AE38:AG42', nacimiento_anio[0], item_16)
        worksheet.merge_range('AH38:AJ42', nacimiento_anio[1], item_16)
        worksheet.merge_range('AK38:AN42', nacimiento_anio[2], item_16)
        worksheet.merge_range('AO38:AP42', nacimiento_anio[3], item_16)
        worksheet.merge_range('AE45:AG47', '', item_16)
        worksheet.merge_range('AH45:AJ47', '', item_16)
        worksheet.merge_range('AK45:AN47', '', item_16)
        worksheet.merge_range('AO45:AP47', '', item_16)
        worksheet.merge_range(
            'AR33:BD34', u'N° DE HISTORIA CLÍNICA', subsection_format)
        worksheet.merge_range(
            'AR35:BD36',
            self.control.paciente.historias_clinicas.last().numero, item_16)
        worksheet.merge_range('BF33:BM34', 'ETNIA', subsection_format)
        worksheet.merge_range('BF35:BM36', self.control.paciente.etnia_nombre, item_16)
        worksheet.merge_range(
            'AR38:BG39', u'DNI / CNV / AFILIACIÓN DEL RN 1', item_section)
        worksheet.merge_range('BH38:BM39', '', item_16)
        worksheet.merge_range(
            'AR42:BG45', u'DNI / CNV / AFILIACIÓN DEL RN 2', item_section)
        worksheet.merge_range('BH42:BM45', '', item_16)
        worksheet.merge_range(
            'AR47:BG47', u'DNI / CNV / AFILIACIÓN DEL RN 3', item_section)
        worksheet.merge_range('BH47:BM47', '', item_16)
        worksheet.merge_range('A49:BM49', u'DE LA ATENCIÓN', section_format)
        worksheet.merge_range(
            'A51:R51', u'FECHA DE ATENCIÓN', subsection_format)
        worksheet.merge_range('A52:B53', 'DIA', item_section)
        worksheet.merge_range('A54:A58', '', item_16)
        worksheet.merge_range('B54:B58', '', item_16)
        worksheet.merge_range('C52:F53', 'MES', item_section)
        worksheet.merge_range('C54:C58', '', item_16)
        worksheet.merge_range('D54:F58', '', item_16)
        worksheet.merge_range('G52:R53', u'AÑO', item_section)
        worksheet.merge_range('G54:K58', '', item_16)
        worksheet.merge_range('L54:M58', '', item_16)
        worksheet.merge_range('N54:O58', '', item_16)
        worksheet.merge_range('P54:R58', '', item_16)
        worksheet.merge_range('T51:Y52', 'HORA', subsection_format)
        worksheet.merge_range('T53:W58', '', item_16)
        worksheet.merge_range('X53:X58', ':', item_16)
        worksheet.merge_range('Y53:Y58', '', item_16)
        worksheet.merge_range(
            'A61:K62', 'REPORTE VINCULADO', subsection_format)
        worksheet.merge_range(
            'L61:Y61', u'CÓD. AUTORIZACIÓN', subsection_format)
        worksheet.merge_range('L62:Y62', '', item_16)
        worksheet.merge_range('AA51:AE52', 'UPS', subsection_format)
        worksheet.merge_range('AA53:AE58', '', item_16)
        worksheet.merge_range('AG51:AI52', u'CÓD. PRESTA.', subsection_format)
        worksheet.merge_range('AG53:AI58', '011', item_16)
        worksheet.merge_range(
            'AK51:AT52', u'CÓD. PRESTACION(ES) ADICIONAL (ES)',
            subsection_format)
        worksheet.merge_range('AK53:AT58', '', item_16)
        worksheet.merge_range(
            'AA61:AT61', u'N° FUA A VINCULAR', subsection_format)
        worksheet.merge_range('AA62:AT62', '', item_16)
        worksheet.merge_range('AW51:AY62', u'HOSPITALIZACIÓN', item_rotated)
        worksheet.merge_range('AZ51:BE51', 'FECHA', subsection_format)
        worksheet.merge_range('AZ52:BE54', 'DE INGRESO', item_section)
        worksheet.merge_range('AZ56:BE59', 'DE ALTA', item_section)
        worksheet.merge_range(
            'AZ61:BE62', 'DE CORTE ADMINISTRATIVO', item_section)
        worksheet.merge_range('BF51:BG51', 'DIA', subsection_format)
        worksheet.merge_range('BF52:BF54', '', item_16)
        worksheet.merge_range('BG52:BG54', '', item_16)
        worksheet.merge_range('BF56:BF59', '', item_16)
        worksheet.merge_range('BG56:BG59', '', item_16)
        worksheet.merge_range('BF61:BF62', '', item_16)
        worksheet.merge_range('BG61:BG62', '', item_16)
        worksheet.merge_range('BH51:BI51', 'MES', subsection_format)
        worksheet.merge_range('BH52:BH54', '', item_16)
        worksheet.merge_range('BI52:BI54', '', item_16)
        worksheet.merge_range('BH56:BH59', '', item_16)
        worksheet.merge_range('BI56:BI59', '', item_16)
        worksheet.merge_range('BH61:BH62', '', item_16)
        worksheet.merge_range('BI61:BI62', '', item_16)
        worksheet.merge_range('BJ51:BM51', u'AÑO', subsection_format)
        worksheet.merge_range('BJ52:BJ54', '', item_16)
        worksheet.merge_range('BK52:BK54', '', item_16)
        worksheet.merge_range('BL52:BL54', '', item_16)
        worksheet.merge_range('BM52:BM54', '', item_16)
        worksheet.merge_range('BJ56:BJ59', '', item_16)
        worksheet.merge_range('BK56:BK59', '', item_16)
        worksheet.merge_range('BL56:BL59', '', item_16)
        worksheet.merge_range('BM56:BM59', '', item_16)
        worksheet.merge_range('BJ61:BJ62', '', item_16)
        worksheet.merge_range('BK61:BK62', '', item_16)
        worksheet.merge_range('BL61:BL62', '', item_16)
        worksheet.merge_range('BM61:BM62', '', item_16)
        worksheet.merge_range(
            'A64:BM64', 'CONCEPTO PRESTACIONAL', section_format)
        worksheet.merge_range(
            'A65:C67', u'ATENCIÓN DIRECTA', subsection_format)
        worksheet.merge_range('D65:F67', 'X', check_format)
        worksheet.merge_range(
            'G65:X65', 'COB EXTRAORDINARIA', subsection_format)
        worksheet.merge_range('G66:O66', u'Nº Autorización', label_item)
        worksheet.merge_range('P66:X66', '', item_16)
        worksheet.merge_range('G67:N67', 'Monto S/.', label_item)
        worksheet.merge_range('O67:X67', '', item_16)
        worksheet.merge_range(
            'Y65:AK65', 'CARTA DE GARANTIA', subsection_format)
        worksheet.merge_range('Y66:AE66', u'Nº Autorización', label_item)
        worksheet.merge_range('AF66:AK66', '', item_16)
        worksheet.merge_range('Y67:AD67', 'Monto S/.', label_item)
        worksheet.merge_range('AE67:AK67', '', item_16)
        worksheet.merge_range('AL65:AQ67', 'TRASLADO', section_format)
        worksheet.merge_range('AR65:AS67', '', item_16)
        worksheet.merge_range('AT65:BM65', 'SEPELIO', subsection_format)
        worksheet.merge_range('AT66:BA67', 'NATIMUERTO', subsection_format)
        worksheet.merge_range('BB66:BD67', '', item_16)
        worksheet.merge_range('BE66:BG67', 'OBITO', subsection_format)
        worksheet.merge_range('BH66:BI67', '', item_16)
        worksheet.merge_range('BJ66:BK67', 'OTRO', subsection_format)
        worksheet.merge_range('BL66:BM67', '', item_16)
        worksheet.merge_range(
            'A69:BM69', 'DEL DESTINO DEL ASEGURADO/USUARIO', section_format)
        worksheet.merge_range('A70:A71', 'ALTA', label_item)
        worksheet.merge_range('B70:B71', '', item_16)
        worksheet.merge_range('C70:F71', 'CITA', label_item)
        worksheet.merge_range('G70:K71', 'X', check_format)
        worksheet.merge_range('L70:Q71', u'HOSPITALIZACIÓN', label_item)
        worksheet.merge_range('R70:S71', '', item_16)
        worksheet.merge_range('T70:AW70', 'REFERIDO', subsection_format)
        worksheet.merge_range('T71:Y71', 'EMERGENCIA', label_item)
        worksheet.merge_range('Z71:AA71', '', check_format)
        worksheet.merge_range('AB71:AI71', 'CONSULTA EXTERNA', label_item)
        worksheet.merge_range('AJ71:AL71', '', check_format)
        worksheet.merge_range('AM71:AT71', u'APOYO AL DIAGNÓSTICO', label_item)
        worksheet.merge_range('AU71:AW71', '', check_format)
        worksheet.merge_range('AX70:BC71', 'CONTRA REFERIDO', label_item)
        worksheet.merge_range('BD70:BD71', '', check_format)
        worksheet.merge_range('BE70:BH71', 'FALLECIDO', label_item)
        worksheet.merge_range('BI70:BI71', '', check_format)
        worksheet.merge_range('BJ70:BK71', 'CORTE ADMINIS.', label_item)
        worksheet.merge_range('BL70:BM71', '', check_format)
        worksheet.merge_range(
            'A73:BM73', 'SE REFIERE / CONTRARREFIERE A:', section_format)
        worksheet.merge_range(
            'A74:M74', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range('A75:M75', '', item_16)
        worksheet.merge_range(
            'N74:BC74',
            'NOMBRE DE LA IPRESS A LA QUE SE REFIERE / CONTRARREFIERE',
            subsection_format)
        worksheet.merge_range('N75:BC75', '', item_16)
        worksheet.merge_range(
            'BD74:BM74', u'N° HOJA DE REFER / CONTRARR.', subsection_format)
        worksheet.merge_range('BD75:BM75', '', item_16)
        worksheet.merge_range(
            'A77:AR77', 'ACTIVIDADES PREVENTIVAS Y OTROS', section_format)
        worksheet.merge_range('A78:I78', 'PESO (Kg)', subsection_format)
        worksheet.merge_range('J78:N78', '', item_16)
        worksheet.merge_range('O78:X78', 'TALLA (cm)', subsection_format)
        worksheet.merge_range('Y78:AB78', '', item_16)
        worksheet.merge_range('AC78:AM78', 'P.A. (mmHg)', subsection_format)
        worksheet.merge_range('AN78:AR78', '', item_16)
        worksheet.merge_range('A79:D79', 'DE LA GESTANTE', subsection_format)
        worksheet.merge_range('A80:B82', u'CPN (N°)', item_section)
        worksheet.merge_range('C80:D82', '', item_16)
        worksheet.merge_range('A83:B84', 'EDAD GEST', item_section)
        worksheet.merge_range('C83:D84', '', item_16)
        worksheet.merge_range('A85:B86', 'ALTURA UTERINA', item_section)
        worksheet.merge_range('C85:D86', '', item_16)
        worksheet.merge_range('A87:B88', 'PARTO VERTICAL', item_section)
        worksheet.merge_range('C87:D88', '', item_16)
        worksheet.merge_range('A89:B90', u'CONTROL PUERP (N°)', item_section)
        worksheet.merge_range('C89:D90', '', item_16)
        worksheet.merge_range(
            'F79:Q79', 'DEL RECIEN NACIDO', subsection_format)
        worksheet.merge_range('F80:N81', 'EDAD GEST RN (SEM)', item_section)
        worksheet.merge_range('O80:Q81', '', item_16)
        worksheet.merge_range('F83:K85', 'APGAR', item_section)
        worksheet.merge_range('L83:L85', u'1°', item_section)
        worksheet.merge_range('M83:M85', '', item_section)
        worksheet.merge_range('N83:N85', u'5°', item_section)
        worksheet.merge_range('O83:Q85', '', item_section)
        worksheet.merge_range(
            'F87:N88', u'Corte Tardío de Cordón (2 a 3 min)', item_section)
        worksheet.merge_range('O87:Q88', '', item_16)
        worksheet.merge_range('F90:P90', '3', item_section)
        worksheet.merge_range(
            'S79:AK79', u' / '.join([
                'GESTANTE', 'RN', u'NIÑO', 'ADOLESCENTE', 'JOVEN Y ADULTO',
                'ADULTO MAYOR']), subsection_format)
        worksheet.merge_range('S80:Z81', u'CRED N°', item_section)
        worksheet.merge_range('AA80:AA81', '', check_format)
        worksheet.merge_range('S83:Z83', 'R.N. PREMATURO', item_section)
        worksheet.write('AA83', '', check_format)
        worksheet.merge_range('S85:Z85', 'BAJO PESO AL NACER', item_section)
        worksheet.write('AA85', '', check_format)
        worksheet.merge_range(
            'S87:Z88', 'ENFER. CONGENITA / SECUELA AL NACER', item_section)
        worksheet.merge_range('AA87:AA88', '', check_format)
        worksheet.merge_range(
            'S90:Z90', u'N° FAMILIARES DE GEST / PUERP. CASA MAT.',
            item_section)
        worksheet.write('AA90', '', check_format)
        worksheet.merge_range('AC80:AG81', 'PAB (cm)', item_section)
        worksheet.merge_range('AH80:AK81', '', item_16)
        worksheet.merge_range('AC83:AH83', 'TAP / EEDP o TEPSI', item_section)
        worksheet.merge_range('AI83:AK83', '', item_16)
        worksheet.merge_range(
            'AC85:AH85', 'CONSEJERIA NUTRICIONAL', item_section)
        worksheet.merge_range('AI85:AK85', '', item_16)
        worksheet.merge_range('AC87:AH88', 'CONSEJERIA INTEGRAL', item_section)
        worksheet.merge_range('AI87:AK88', '', item_16)
        worksheet.merge_range('AC90:AH90', '', item_section)
        worksheet.write_rich_string(
            'AC90', label_item, 'IMC (Kg/M', superscript, '2', label_item,
            ')', item_section)
        worksheet.merge_range('AI90:AK90', self.control.imc, item_16)
        worksheet.merge_range('AM79:AR79', 'JOVEN Y ADULTO', label_item)
        worksheet.merge_range(
            'AM80:AP81', u'EVALUACIÓN INTEGRAL', item_section)
        worksheet.merge_range('AQ80:AR81', '', item_16)
        worksheet.merge_range('AM83:AR83', 'ADULTO MAYOR', label_item)
        worksheet.merge_range('AM84:AP85', 'VACAM', item_section)
        worksheet.merge_range('AQ84:AR85', '', item_16)
        worksheet.merge_range(
            'AM87:AP88', 'TAMIZAJE DE SALUD MENTAL', item_section)
        worksheet.merge_range('AQ87:AR87', 'PAT.', item_section)
        worksheet.merge_range('AQ88:AR88', 'NOR.', item_section)
        worksheet.merge_range('AM90:AR90', '', item_16)
        worksheet.merge_range(
            'AT77:BM77', u'VACUNAS N° DE DOSIS', section_format)
        worksheet.merge_range('AT78:AY78', 'BCG', item_section)
        worksheet.merge_range('AZ78:BB78', '', item_16)
        worksheet.merge_range('AT79:AY80', 'DPT', item_section)
        worksheet.merge_range('AZ79:BB80', '', item_16)
        worksheet.merge_range('AT81:AY82', 'APO', item_section)
        worksheet.merge_range('AZ81:BB82', '', item_16)
        worksheet.merge_range('AT83:AY84', 'ASA', item_section)
        worksheet.merge_range('AZ83:BB84', '', item_16)
        worksheet.merge_range('AT85:AY85', 'SPR', item_section)
        worksheet.merge_range('AZ85:BB85', '', item_16)
        worksheet.merge_range('AT86:AY87', 'SR', item_section)
        worksheet.merge_range('AZ86:BB87', '', item_16)
        worksheet.merge_range('AT88:AY89', 'HVB', item_section)
        worksheet.merge_range('AZ88:BB89', '', item_16)
        worksheet.merge_range('BC78:BF78', 'INFLUENZA', item_section)
        worksheet.merge_range('BG78:BH78', '', item_16)
        worksheet.merge_range('BC79:BF80', 'PAROTID', item_section)
        worksheet.merge_range('BG79:BH80', '', item_16)
        worksheet.merge_range('BC81:BF82', 'RUBEOLA', item_section)
        worksheet.merge_range('BG81:BH82', '', item_16)
        worksheet.merge_range('BC83:BF84', 'ROTAVIRUS', item_section)
        worksheet.merge_range('BG83:BH84', '', item_16)
        worksheet.merge_range(
            'BC85:BF85', u'DT ADULTO (N° DOSIS)', item_section)
        worksheet.merge_range('BG85:BH85', '', item_16)
        worksheet.merge_range('BC86:BF87', 'IPV', item_section)
        worksheet.merge_range('BG86:BH87', '', item_16)
        worksheet.merge_range('BC88:BF89', 'PENTAVAL', item_section)
        worksheet.merge_range('BG88:BH89', '', item_16)
        worksheet.merge_range('BI78:BK78', 'ANTIAMARILICA', item_section)
        worksheet.merge_range('BL78:BM78', '', item_16)
        worksheet.merge_range('BI79:BK80', 'ANTINEUMOC', item_section)
        worksheet.merge_range('BL79:BM80', '', item_16)
        worksheet.merge_range('BI81:BK82', 'ANTITETANICA', item_section)
        worksheet.merge_range('BL81:BM82', '', item_16)
        worksheet.merge_range(
            'BI83:BK84', ' COMPLETAS PARA LA EDAD', item_section)
        worksheet.merge_range('BL83:BL84', 'SI', item_section)
        worksheet.merge_range('BM83:BM84', 'NO', item_section)
        worksheet.merge_range('BI85:BK85', 'VPH', item_section)
        worksheet.merge_range('BL85:BM85', '', item_16)
        worksheet.merge_range('BI86:BK87', 'OTRA VACUNA', item_section)
        worksheet.merge_range('BL86:BM87', '', item_16)
        worksheet.merge_range('BI88:BK89', '____________', item_section)
        worksheet.merge_range('BL88:BM89', '', item_16)
        worksheet.merge_range('AT90:AZ90', 'GRUPO DE RIESGO HVB', item_section)
        worksheet.merge_range('BA90:BC90', '', item_16)
        worksheet.merge_range('BD90:BM90', '   '.join([
            'GRUPO DE RIESGO HVB: 1. TRABAJADOR DE SALUD',
            '2. TRABAJAD. SEXUALES', '3. HSH', '4. PRIVADO LIBERTAD',
            '5. FF. AA.', '6. POLICIA NACIONAL', '7. ESTUDIANTES DE SALUD',
            '8. POLITRANFUNDIDOS', '9. DROGO DEPENDIENTES ']), formato_leyenda)
        worksheet.merge_range('A93:BM93', '10', section_format)
        worksheet.merge_range('A94:A95', u'N°', subsection_format)
        worksheet.write('A96', '1', item_section)
        worksheet.write('A97', '2', item_section)
        worksheet.write('A98', '3', item_section)
        worksheet.write('A99', '4', item_section)
        worksheet.write('A100', '5', item_section)
        worksheet.merge_range('B94:AN95', u'DESCRIPCIÓN', subsection_format)
        worksheet.merge_range('B96:AN96', '', item_section)
        worksheet.merge_range('B97:AN97', '', item_section)
        worksheet.merge_range('B98:AN98', '', item_section)
        worksheet.merge_range('B99:AN99', '', item_section)
        worksheet.merge_range('B100:AN100', '', item_section)
        worksheet.merge_range('AO94:BD94', 'INGRESO', subsection_format)
        worksheet.merge_range('AO95:AW95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('AO96:AP96', 'P', item_section)
        worksheet.merge_range('AQ96:AS96', 'D', item_section)
        worksheet.merge_range('AT96:AW96', 'R', item_section)
        worksheet.merge_range('AO97:AP97', 'P', item_section)
        worksheet.merge_range('AQ97:AS97', 'D', item_section)
        worksheet.merge_range('AT97:AW97', 'R', item_section)
        worksheet.merge_range('AO98:AP98', 'P', item_section)
        worksheet.merge_range('AQ98:AS98', 'D', item_section)
        worksheet.merge_range('AT98:AW98', 'R', item_section)
        worksheet.merge_range('AO99:AP99', 'P', item_section)
        worksheet.merge_range('AQ99:AS99', 'D', item_section)
        worksheet.merge_range('AT99:AW99', 'R', item_section)
        worksheet.merge_range('AO100:AP100', 'P', item_section)
        worksheet.merge_range('AQ100:AS100', 'D', item_section)
        worksheet.merge_range('AT100:AW100', 'R', item_section)
        worksheet.merge_range('AX95:BD95', 'CIE - 10', subsection_format)
        worksheet.merge_range('AX96:BD96', '', item_16)
        worksheet.merge_range('AX97:BD97', '', item_16)
        worksheet.merge_range('AX98:BD98', '', item_16)
        worksheet.merge_range('AX99:BD99', '', item_16)
        worksheet.merge_range('AX100:BD100', '', item_16)
        worksheet.merge_range('BE94:BM94', 'EGRESO', subsection_format)
        worksheet.merge_range('BE95:BI95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('BE96:BG96', 'D', item_section)
        worksheet.merge_range('BH96:BI96', 'R', item_section)
        worksheet.merge_range('BE97:BG97', 'D', item_section)
        worksheet.merge_range('BH97:BI97', 'R', item_section)
        worksheet.merge_range('BE98:BG98', 'D', item_section)
        worksheet.merge_range('BH98:BI98', 'R', item_section)
        worksheet.merge_range('BE99:BG99', 'D', item_section)
        worksheet.merge_range('BH99:BI99', 'R', item_section)
        worksheet.merge_range('BE100:BG100', 'D', item_section)
        worksheet.merge_range('BH100:BI100', 'R', item_section)
        worksheet.merge_range('BJ95:BM95', 'CIE - 10', subsection_format)
        worksheet.merge_range('BJ96:BM96', '', item_16)
        worksheet.merge_range('BJ97:BM97', '', item_16)
        worksheet.merge_range('BJ98:BM98', '', item_16)
        worksheet.merge_range('BJ99:BM99', '', item_16)
        worksheet.merge_range('BJ100:BM100', '', item_16)
        worksheet.merge_range('A102:N102', u'N° DE DNI', section_format)
        worksheet.merge_range('A103:N103', self.request.user.dni, item_16)
        worksheet.merge_range(
            'O102:BE102', u'NOMBRE DEL RESPONSABLE DE LA ATENCIÓN',
            section_format)
        worksheet.merge_range(
            'O103:BE103', self.request.user.get_full_name(), item_16)
        worksheet.merge_range(
            'BF102:BM102', u'N° DE COLEGIATURA', section_format)
        worksheet.merge_range(
            'BF103:BM103', self.request.user.colegiatura, item_16)
        worksheet.merge_range(
            'A105:N105', u'RESPONSABLE DE LA ATENCIÓN', subsection_format)
        worksheet.merge_range('O105:Q105', '', item_section)
        worksheet.merge_range('R105:Y105', 'ESPECIALIDAD', subsection_format)
        worksheet.merge_range('Z105:AT105', '', item_section)
        worksheet.merge_range('AU105:AZ105', u'N° RNE', subsection_format)
        worksheet.merge_range('BA105:BE105', '', item_section)
        worksheet.merge_range('BF105:BK105', 'EGRESADO', subsection_format)
        worksheet.merge_range('BL105:BM105', '', item_16)
        worksheet.merge_range('A106:BM107', u'   '.join([
            u'1. MÉDICO', '2. FARMACEUTICO', '3. CIRUJANO DENTISTA',
            u'4. BIÓLOGO', '5. OBSTETRIZ', '6. ENFERMERA',
            '7. TRABAJADORA SOCIAL', '8. PSICOLOGA', '9.TECNOLOGO MEDICO',
            '10.NUTRICION', '11. TECNICO ENFERMERIA',
            '12. AUXILIAR DE ENFERMERIA', '13. OTRO']), formato_leyenda_8)
        worksheet.merge_range('B119:Y119', '', subrayado)
        worksheet.merge_range(
            'B121:Y121', u'FIRMA Y SELLO DEL RESPONSABLE DE LA ATENCIÓN ',
            responsable_formato)
        worksheet.merge_range('AH108:AM109', 'FIRMA', responsable_formato)
        worksheet.merge_range('AH110:AM111', 'ASEGURADO', responsable_formato)
        worksheet.merge_range('AO110:AP111', '', item_16)
        worksheet.merge_range('AH112:AM113', 'APODERADO', responsable_formato)
        worksheet.merge_range('AO112:AP113', '', item_16)
        worksheet.write('AH117', 'APODERADO:', responsable_formato)
        worksheet.merge_range('AQ117:BE117', '', subrayado)
        worksheet.write('AH118', 'NOMBRES Y APELLIDOS', responsable_formato)
        worksheet.merge_range('AQ118:BE118', '', subrayado)
        worksheet.write(
            'AH121', 'DNI o CE DEL APODERADO:', responsable_formato)
        worksheet.merge_range('AR121:BE121', '', subrayado)

        worksheet.merge_range('BH109:BL120', '', item_16)

        worksheet.merge_range(
            'BG122:BL124', 'Huella Digital del Asegurado o del Apoderado',
            item_section)

        reverso = workbook.add_worksheet('FUA011R')
        reverso.fit_to_pages(1, 1)
        reverso.set_portrait()

        self.set_back_column_dimension(reverso)
        self.set_back_row_dimension(reverso)

        titulo_reverse = workbook.add_format()
        self.bold_pattern_common(titulo_reverse)
        titulo_reverse.set_bg_color('#D9D9D9')
        titulo_reverse.set_font_size(22)

        subtitulo_reverse = workbook.add_format()
        self.bold_pattern_common(subtitulo_reverse)
        subtitulo_reverse.set_bg_color('#D9D9D9')
        subtitulo_reverse.set_font_size(20)

        item_reverso = workbook.add_format()
        self.bold_common(item_reverso)
        item_reverso.set_font_size(20)

        firma_reverso = workbook.add_format()
        firma_reverso.set_align('center')
        firma_reverso.set_align('vcenter')
        firma_reverso.set_bold()
        firma_reverso.set_font_name('Arial')
        firma_reverso.set_font_size(24)
        firma_reverso.set_text_wrap()
        firma_reverso.set_top()

        reverso.merge_range(
            'T1:AC1', u'FORMATO DE ATENCIÓN Nº', titulo_reverse)
        reverso.merge_range('T2:V2', '', item_16)
        reverso.merge_range('W2:Y2', '', item_16)
        reverso.merge_range('Z2:AC2', '', item_16)
        reverso.merge_range(
            'A4:AC4', 'PRODUCTOS FARMACEUTICOS / MEDICAMENTOS', titulo_reverse)
        reverso.merge_range('A5:B5', u'CÓDIGO SISMED', subtitulo_reverse)
        reverso.merge_range('C5:J5', 'NOMBRE', subtitulo_reverse)
        reverso.write('K5', 'FF', subtitulo_reverse)
        reverso.write('L5', 'CONCENTR', subtitulo_reverse)
        reverso.write('M5', 'PRES', subtitulo_reverse)
        reverso.write('N5', 'ENTR', subtitulo_reverse)
        reverso.write('O5', 'DX', subtitulo_reverse)
        reverso.merge_range('P5:Q5', u'CÓD. SISMED', subtitulo_reverse)
        reverso.merge_range('R5:X5', 'NOMBRE', subtitulo_reverse)
        reverso.write('Y5', 'FF', subtitulo_reverse)
        reverso.write('Z5', 'CONCENTR', subtitulo_reverse)
        reverso.write('AA5', 'PRES', subtitulo_reverse)
        reverso.write('AB5', 'ENTR', subtitulo_reverse)
        reverso.write('AC5', 'DX', subtitulo_reverse)
        reverso.merge_range('A6:B6', '', item_reverso)
        reverso.merge_range('C6:J6', '', item_reverso)
        reverso.write('L6', '', item_reverso)
        reverso.write('K6', '', item_reverso)
        reverso.write('M6', '', item_reverso)
        reverso.write('N6', '', item_reverso)
        reverso.write('O6', '', item_reverso)
        reverso.write('Y6', '', item_reverso)
        reverso.write('Z6', '', item_reverso)
        reverso.write('AA6', '', item_reverso)
        reverso.write('AB6', '', item_reverso)
        reverso.write('AC6', '', item_reverso)
        reverso.merge_range('A7:B7', '', item_reverso)
        reverso.merge_range('A8:B8', '', item_reverso)
        reverso.merge_range('A9:B9', '', item_reverso)
        reverso.merge_range('A10:B10', '', item_reverso)
        reverso.merge_range('A11:B11', '', item_reverso)
        reverso.merge_range('A12:B12', '', item_reverso)
        reverso.merge_range('A13:B13', '', item_reverso)
        reverso.merge_range('A14:B14', '', item_reverso)
        reverso.merge_range('A15:B15', '', item_reverso)
        reverso.merge_range('A16:B16', '', item_reverso)
        reverso.merge_range('A17:B17', '', item_reverso)
        reverso.merge_range('A18:B18', '', item_reverso)
        reverso.merge_range('C7:J7', '', item_reverso)
        reverso.merge_range('C8:J8', '', item_reverso)
        reverso.merge_range('C9:J9', '', item_reverso)
        reverso.merge_range('C10:J10', '', item_reverso)
        reverso.merge_range('C11:J11', '', item_reverso)
        reverso.merge_range('C12:J12', '', item_reverso)
        reverso.merge_range('C13:J13', '', item_reverso)
        reverso.merge_range('C14:J14', '', item_reverso)
        reverso.merge_range('C15:J15', '', item_reverso)
        reverso.merge_range('C16:J16', '', item_reverso)
        reverso.merge_range('C17:J17', '', item_reverso)
        reverso.merge_range('C18:J18', '', item_reverso)
        reverso.write('K7', '', item_reverso)
        reverso.write('K8', '', item_reverso)
        reverso.write('K9', '', item_reverso)
        reverso.write('K10', '', item_reverso)
        reverso.write('K11', '', item_reverso)
        reverso.write('K12', '', item_reverso)
        reverso.write('K13', '', item_reverso)
        reverso.write('K14', '', item_reverso)
        reverso.write('K15', '', item_reverso)
        reverso.write('K16', '', item_reverso)
        reverso.write('K17', '', item_reverso)
        reverso.write('K18', '', item_reverso)
        reverso.write('L7', '', item_reverso)
        reverso.write('L8', '', item_reverso)
        reverso.write('L9', '', item_reverso)
        reverso.write('L10', '', item_reverso)
        reverso.write('L11', '', item_reverso)
        reverso.write('L12', '', item_reverso)
        reverso.write('L13', '', item_reverso)
        reverso.write('L14', '', item_reverso)
        reverso.write('L15', '', item_reverso)
        reverso.write('L16', '', item_reverso)
        reverso.write('L17', '', item_reverso)
        reverso.write('L18', '', item_reverso)
        reverso.write('M7', '', item_reverso)
        reverso.write('M8', '', item_reverso)
        reverso.write('M9', '', item_reverso)
        reverso.write('M10', '', item_reverso)
        reverso.write('M11', '', item_reverso)
        reverso.write('M12', '', item_reverso)
        reverso.write('M13', '', item_reverso)
        reverso.write('M14', '', item_reverso)
        reverso.write('M15', '', item_reverso)
        reverso.write('M16', '', item_reverso)
        reverso.write('M17', '', item_reverso)
        reverso.write('M18', '', item_reverso)
        reverso.write('N7', '', item_reverso)
        reverso.write('N8', '', item_reverso)
        reverso.write('N9', '', item_reverso)
        reverso.write('N10', '', item_reverso)
        reverso.write('N11', '', item_reverso)
        reverso.write('N12', '', item_reverso)
        reverso.write('N13', '', item_reverso)
        reverso.write('N14', '', item_reverso)
        reverso.write('N15', '', item_reverso)
        reverso.write('N16', '', item_reverso)
        reverso.write('N17', '', item_reverso)
        reverso.write('N18', '', item_reverso)
        reverso.write('O7', '', item_reverso)
        reverso.write('O8', '', item_reverso)
        reverso.write('O9', '', item_reverso)
        reverso.write('O10', '', item_reverso)
        reverso.write('O11', '', item_reverso)
        reverso.write('O12', '', item_reverso)
        reverso.write('O13', '', item_reverso)
        reverso.write('O14', '', item_reverso)
        reverso.write('O15', '', item_reverso)
        reverso.write('O16', '', item_reverso)
        reverso.write('O17', '', item_reverso)
        reverso.write('O18', '', item_reverso)
        reverso.write('Y7', '', item_reverso)
        reverso.write('Y8', '', item_reverso)
        reverso.write('Y9', '', item_reverso)
        reverso.write('Y10', '', item_reverso)
        reverso.write('Y11', '', item_reverso)
        reverso.write('Y12', '', item_reverso)
        reverso.write('Y13', '', item_reverso)
        reverso.write('Y14', '', item_reverso)
        reverso.write('Y15', '', item_reverso)
        reverso.write('Y16', '', item_reverso)
        reverso.write('Y17', '', item_reverso)
        reverso.write('Y18', '', item_reverso)
        reverso.write('Z7', '', item_reverso)
        reverso.write('Z8', '', item_reverso)
        reverso.write('Z9', '', item_reverso)
        reverso.write('Z10', '', item_reverso)
        reverso.write('Z11', '', item_reverso)
        reverso.write('Z12', '', item_reverso)
        reverso.write('Z13', '', item_reverso)
        reverso.write('Z14', '', item_reverso)
        reverso.write('Z15', '', item_reverso)
        reverso.write('Z16', '', item_reverso)
        reverso.write('Z17', '', item_reverso)
        reverso.write('Z18', '', item_reverso)
        reverso.write('AA7', '', item_reverso)
        reverso.write('AA8', '', item_reverso)
        reverso.write('AA9', '', item_reverso)
        reverso.write('AA10', '', item_reverso)
        reverso.write('AA11', '', item_reverso)
        reverso.write('AA12', '', item_reverso)
        reverso.write('AA13', '', item_reverso)
        reverso.write('AA14', '', item_reverso)
        reverso.write('AA15', '', item_reverso)
        reverso.write('AA16', '', item_reverso)
        reverso.write('AA17', '', item_reverso)
        reverso.write('AA18', '', item_reverso)
        reverso.write('AB7', '', item_reverso)
        reverso.write('AB8', '', item_reverso)
        reverso.write('AB9', '', item_reverso)
        reverso.write('AB10', '', item_reverso)
        reverso.write('AB11', '', item_reverso)
        reverso.write('AB12', '', item_reverso)
        reverso.write('AB13', '', item_reverso)
        reverso.write('AB14', '', item_reverso)
        reverso.write('AB15', '', item_reverso)
        reverso.write('AB16', '', item_reverso)
        reverso.write('AB17', '', item_reverso)
        reverso.write('AB18', '', item_reverso)
        reverso.write('AC7', '', item_reverso)
        reverso.write('AC8', '', item_reverso)
        reverso.write('AC9', '', item_reverso)
        reverso.write('AC10', '', item_reverso)
        reverso.write('AC11', '', item_reverso)
        reverso.write('AC12', '', item_reverso)
        reverso.write('AC13', '', item_reverso)
        reverso.write('AC14', '', item_reverso)
        reverso.write('AC15', '', item_reverso)
        reverso.write('AC16', '', item_reverso)
        reverso.write('AC17', '', item_reverso)
        reverso.write('AC18', '', item_reverso)
        reverso.merge_range(
            'A19:AC19', u'DISPOSITIVOS MÉDICOS / PRODUCTOS SANITARIOS',
            titulo_reverse)
        reverso.merge_range('A20:B20', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A21:B21', '', item_reverso)
        reverso.merge_range('A22:B22', '', item_reverso)
        reverso.merge_range('A23:B23', '', item_reverso)
        reverso.merge_range('A24:B24', '', item_reverso)
        reverso.merge_range('A25:B25', '', item_reverso)
        reverso.merge_range('A26:B26', '', item_reverso)
        reverso.merge_range('A27:B27', '', item_reverso)
        reverso.merge_range('A28:B28', '', item_reverso)
        reverso.merge_range('A29:B29', '', item_reverso)
        reverso.merge_range('C20:J20', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C21:J21', '', item_reverso)
        reverso.merge_range('C22:J22', '', item_reverso)
        reverso.merge_range('C23:J23', '', item_reverso)
        reverso.merge_range('C24:J24', '', item_reverso)
        reverso.merge_range('C25:J25', '', item_reverso)
        reverso.merge_range('C26:J26', '', item_reverso)
        reverso.merge_range('C27:J27', '', item_reverso)
        reverso.merge_range('C28:J28', '', item_reverso)
        reverso.merge_range('C29:J29', '', item_reverso)
        reverso.write('K20', 'PR', subtitulo_reverse)
        reverso.write('K21', '', item_reverso)
        reverso.write('K22', '', item_reverso)
        reverso.write('K23', '', item_reverso)
        reverso.write('K24', '', item_reverso)
        reverso.write('K25', '', item_reverso)
        reverso.write('K26', '', item_reverso)
        reverso.write('K27', '', item_reverso)
        reverso.write('K28', '', item_reverso)
        reverso.write('K29', '', item_reverso)
        reverso.write('L20', 'CARACT', subtitulo_reverse)
        reverso.write('L21', '', item_reverso)
        reverso.write('L22', '', item_reverso)
        reverso.write('L23', '', item_reverso)
        reverso.write('L24', '', item_reverso)
        reverso.write('L25', '', item_reverso)
        reverso.write('L26', '', item_reverso)
        reverso.write('L27', '', item_reverso)
        reverso.write('L28', '', item_reverso)
        reverso.write('L29', '', item_reverso)
        reverso.write('M20', 'PRES', subtitulo_reverse)
        reverso.write('M21', '', item_reverso)
        reverso.write('M22', '', item_reverso)
        reverso.write('M23', '', item_reverso)
        reverso.write('M24', '', item_reverso)
        reverso.write('M25', '', item_reverso)
        reverso.write('M26', '', item_reverso)
        reverso.write('M27', '', item_reverso)
        reverso.write('M28', '', item_reverso)
        reverso.write('M29', '', item_reverso)
        reverso.write('N20', 'ENTR', subtitulo_reverse)
        reverso.write('N21', '', item_reverso)
        reverso.write('N22', '', item_reverso)
        reverso.write('N23', '', item_reverso)
        reverso.write('N24', '', item_reverso)
        reverso.write('N25', '', item_reverso)
        reverso.write('N26', '', item_reverso)
        reverso.write('N27', '', item_reverso)
        reverso.write('N28', '', item_reverso)
        reverso.write('N29', '', item_reverso)
        reverso.write('O20', 'DX', subtitulo_reverse)
        reverso.write('O21', '', item_reverso)
        reverso.write('O22', '', item_reverso)
        reverso.write('O23', '', item_reverso)
        reverso.write('O24', '', item_reverso)
        reverso.write('O25', '', item_reverso)
        reverso.write('O26', '', item_reverso)
        reverso.write('O27', '', item_reverso)
        reverso.write('O28', '', item_reverso)
        reverso.write('O29', '', item_reverso)
        reverso.merge_range('P20:Q20', u'CÓDIGO', subtitulo_reverse)

        reverso.merge_range('R20:X20', 'NOMBRE', subtitulo_reverse)

        reverso.write('Y20', 'PR', subtitulo_reverse)
        reverso.write('Y21', '', item_reverso)
        reverso.write('Y22', '', item_reverso)
        reverso.write('Y23', '', item_reverso)
        reverso.write('Y24', '', item_reverso)
        reverso.write('Y25', '', item_reverso)
        reverso.write('Y26', '', item_reverso)
        reverso.write('Y27', '', item_reverso)
        reverso.write('Y28', '', item_reverso)
        reverso.write('Y29', '', item_reverso)
        reverso.write('Z20', 'CARACT', subtitulo_reverse)
        reverso.write('Z21', '', item_reverso)
        reverso.write('Z22', '', item_reverso)
        reverso.write('Z23', '', item_reverso)
        reverso.write('Z24', '', item_reverso)
        reverso.write('Z25', '', item_reverso)
        reverso.write('Z26', '', item_reverso)
        reverso.write('Z27', '', item_reverso)
        reverso.write('Z28', '', item_reverso)
        reverso.write('Z29', '', item_reverso)
        reverso.write('AA20', 'PRES', subtitulo_reverse)
        reverso.write('AA21', '', item_reverso)
        reverso.write('AA22', '', item_reverso)
        reverso.write('AA23', '', item_reverso)
        reverso.write('AA24', '', item_reverso)
        reverso.write('AA25', '', item_reverso)
        reverso.write('AA26', '', item_reverso)
        reverso.write('AA27', '', item_reverso)
        reverso.write('AA28', '', item_reverso)
        reverso.write('AA29', '', item_reverso)
        reverso.write('AB20', 'ENTR', subtitulo_reverse)
        reverso.write('AB21', '', item_reverso)
        reverso.write('AB22', '', item_reverso)
        reverso.write('AB23', '', item_reverso)
        reverso.write('AB24', '', item_reverso)
        reverso.write('AB25', '', item_reverso)
        reverso.write('AB26', '', item_reverso)
        reverso.write('AB27', '', item_reverso)
        reverso.write('AB28', '', item_reverso)
        reverso.write('AB29', '', item_reverso)
        reverso.write('AC20', 'DX', subtitulo_reverse)
        reverso.write('AC21', '', item_reverso)
        reverso.write('AC22', '', item_reverso)
        reverso.write('AC23', '', item_reverso)
        reverso.write('AC24', '', item_reverso)
        reverso.write('AC25', '', item_reverso)
        reverso.write('AC26', '', item_reverso)
        reverso.write('AC27', '', item_reverso)
        reverso.write('AC28', '', item_reverso)
        reverso.write('AC29', '', item_reverso)
        reverso.merge_range(
            'A30:AC30',
            u'PROCEDIMIENTOS/ DIAGNÓSTICO POR IMÁGENES/ LABORATORIO',
            titulo_reverse)
        reverso.merge_range('A31:B31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A32:B32', '', item_reverso)
        reverso.merge_range('A33:B33', '', item_reverso)
        reverso.merge_range('A34:B34', '', item_reverso)
        reverso.merge_range('A35:B35', '', item_reverso)
        reverso.merge_range('A36:B36', '', item_reverso)
        reverso.merge_range('A37:B37', '', item_reverso)
        reverso.merge_range('A38:B38', '', item_reverso)
        reverso.merge_range('A39:B39', '', item_reverso)
        reverso.merge_range('A40:B40', '', item_reverso)
        reverso.merge_range('A41:B41', '', item_reverso)
        reverso.merge_range('A42:B42', '', item_reverso)
        reverso.merge_range('C31:K31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C32:K32', '', item_reverso)
        reverso.merge_range('C33:K33', '', item_reverso)
        reverso.merge_range('C34:K34', '', item_reverso)
        reverso.merge_range('C35:K35', '', item_reverso)
        reverso.merge_range('C36:K36', '', item_reverso)
        reverso.merge_range('C37:K37', '', item_reverso)
        reverso.merge_range('C38:K38', '', item_reverso)
        reverso.merge_range('C39:K39', '', item_reverso)
        reverso.merge_range('C40:K40', '', item_reverso)
        reverso.merge_range('C41:K41', '', item_reverso)
        reverso.merge_range('C42:K42', '', item_reverso)
        reverso.write('L31', 'IND', subtitulo_reverse)
        reverso.write('L32', '', item_reverso)
        reverso.write('L33', '', item_reverso)
        reverso.write('L34', '', item_reverso)
        reverso.write('L35', '', item_reverso)
        reverso.write('L36', '', item_reverso)
        reverso.write('L37', '', item_reverso)
        reverso.write('L38', '', item_reverso)
        reverso.write('L39', '', item_reverso)
        reverso.write('L40', '', item_reverso)
        reverso.write('L41', '', item_reverso)
        reverso.write('L42', '', item_reverso)
        reverso.write('M31', 'EJE', subtitulo_reverse)
        reverso.write('M32', '', item_reverso)
        reverso.write('M33', '', item_reverso)
        reverso.write('M34', '', item_reverso)
        reverso.write('M35', '', item_reverso)
        reverso.write('M36', '', item_reverso)
        reverso.write('M37', '', item_reverso)
        reverso.write('M38', '', item_reverso)
        reverso.write('M39', '', item_reverso)
        reverso.write('M40', '', item_reverso)
        reverso.write('M41', '', item_reverso)
        reverso.write('M42', '', item_reverso)
        reverso.write('N31', 'DX', subtitulo_reverse)
        reverso.write('N32', '', item_reverso)
        reverso.write('N33', '', item_reverso)
        reverso.write('N34', '', item_reverso)
        reverso.write('N35', '', item_reverso)
        reverso.write('N36', '', item_reverso)
        reverso.write('N37', '', item_reverso)
        reverso.write('N38', '', item_reverso)
        reverso.write('N39', '', item_reverso)
        reverso.write('N40', '', item_reverso)
        reverso.write('N41', '', item_reverso)
        reverso.write('N42', '', item_reverso)
        reverso.write('O31', 'RES', subtitulo_reverse)
        reverso.write('O32', '', item_reverso)
        reverso.write('O33', '', item_reverso)
        reverso.write('O34', '', item_reverso)
        reverso.write('O35', '', item_reverso)
        reverso.write('O36', '', item_reverso)
        reverso.write('O37', '', item_reverso)
        reverso.write('O38', '', item_reverso)
        reverso.write('O39', '', item_reverso)
        reverso.write('O40', '', item_reverso)
        reverso.write('O41', '', item_reverso)
        reverso.write('O42', '', item_reverso)
        reverso.merge_range('P31:Q31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('P32:Q32', '', item_reverso)
        reverso.merge_range('P33:Q33', '', item_reverso)
        reverso.merge_range('P34:Q34', '', item_reverso)
        reverso.merge_range('P35:Q35', '', item_reverso)
        reverso.merge_range('P36:Q36', '', item_reverso)
        reverso.merge_range('P37:Q37', '', item_reverso)
        reverso.merge_range('P38:Q38', '', item_reverso)
        reverso.merge_range('P39:Q39', '', item_reverso)
        reverso.merge_range('P40:Q40', '', item_reverso)
        reverso.merge_range('P41:Q41', '', item_reverso)
        reverso.merge_range('P42:Q42', '', item_reverso)
        reverso.merge_range('R31:Y31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('R32:Y32', '', item_reverso)
        reverso.merge_range('R33:Y33', '', item_reverso)
        reverso.merge_range('R34:Y34', '', item_reverso)
        reverso.merge_range('R35:Y35', '', item_reverso)
        reverso.merge_range('R36:Y36', '', item_reverso)
        reverso.merge_range('R37:Y37', '', item_reverso)
        reverso.merge_range('R38:Y38', '', item_reverso)
        reverso.merge_range('R39:Y39', '', item_reverso)
        reverso.merge_range('R40:Y40', '', item_reverso)
        reverso.merge_range('R41:Y41', '', item_reverso)
        reverso.merge_range('R42:Y42', '', item_reverso)
        reverso.write('Z31', 'IND', subtitulo_reverse)
        reverso.write('Z32', '', item_reverso)
        reverso.write('Z33', '', item_reverso)
        reverso.write('Z34', '', item_reverso)
        reverso.write('Z35', '', item_reverso)
        reverso.write('Z36', '', item_reverso)
        reverso.write('Z37', '', item_reverso)
        reverso.write('Z38', '', item_reverso)
        reverso.write('Z39', '', item_reverso)
        reverso.write('Z40', '', item_reverso)
        reverso.write('Z41', '', item_reverso)
        reverso.write('Z42', '', item_reverso)
        reverso.write('AA31', 'EJE', subtitulo_reverse)
        reverso.write('AA32', '', item_reverso)
        reverso.write('AA33', '', item_reverso)
        reverso.write('AA34', '', item_reverso)
        reverso.write('AA35', '', item_reverso)
        reverso.write('AA36', '', item_reverso)
        reverso.write('AA37', '', item_reverso)
        reverso.write('AA38', '', item_reverso)
        reverso.write('AA39', '', item_reverso)
        reverso.write('AA40', '', item_reverso)
        reverso.write('AA41', '', item_reverso)
        reverso.write('AA42', '', item_reverso)
        reverso.write('AB31', 'DX', subtitulo_reverse)
        reverso.write('AB32', '', item_reverso)
        reverso.write('AB33', '', item_reverso)
        reverso.write('AB34', '', item_reverso)
        reverso.write('AB35', '', item_reverso)
        reverso.write('AB36', '', item_reverso)
        reverso.write('AB37', '', item_reverso)
        reverso.write('AB38', '', item_reverso)
        reverso.write('AB39', '', item_reverso)
        reverso.write('AB40', '', item_reverso)
        reverso.write('AB41', '', item_reverso)
        reverso.write('AB42', '', item_reverso)
        reverso.write('AC31', 'RES', subtitulo_reverse)
        reverso.write('AC32', '', item_reverso)
        reverso.write('AC33', '', item_reverso)
        reverso.write('AC34', '', item_reverso)
        reverso.write('AC35', '', item_reverso)
        reverso.write('AC36', '', item_reverso)
        reverso.write('AC37', '', item_reverso)
        reverso.write('AC38', '', item_reverso)
        reverso.write('AC39', '', item_reverso)
        reverso.write('AC40', '', item_reverso)
        reverso.write('AC41', '', item_reverso)
        reverso.write('AC42', '', item_reverso)
        reverso.merge_range(
            'A43:AC43', 'SUB COMPONENTE PRESTACIONAL (PROCEDIMIENTOS)',
            titulo_reverse)
        reverso.merge_range('A44:B45', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A46:B46', '', item_reverso)
        reverso.merge_range('A47:B47', '', item_reverso)
        reverso.merge_range('A48:B48', '', item_reverso)
        reverso.merge_range('A49:B49', '', item_reverso)
        reverso.merge_range('A50:B50', '', item_reverso)
        reverso.merge_range('C44:M45', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C46:M46', '', item_reverso)
        reverso.merge_range('C47:M47', '', item_reverso)
        reverso.merge_range('C48:M48', '', item_reverso)
        reverso.merge_range('C49:M49', '', item_reverso)
        reverso.merge_range('C50:M50', '', item_reverso)
        reverso.merge_range('N44:Q45', 'CARACT', subtitulo_reverse)
        reverso.merge_range('N46:Q46', '', item_reverso)
        reverso.merge_range('N47:Q47', '', item_reverso)
        reverso.merge_range('N48:Q48', '', item_reverso)
        reverso.merge_range('N49:Q49', '', item_reverso)
        reverso.merge_range('N50:Q50', '', item_reverso)
        reverso.merge_range('R44:T45', 'IND/ PRES', subtitulo_reverse)
        reverso.merge_range('R46:T46', '', item_reverso)
        reverso.merge_range('R47:T47', '', item_reverso)
        reverso.merge_range('R48:T48', '', item_reverso)
        reverso.merge_range('R49:T49', '', item_reverso)
        reverso.merge_range('R50:T50', '', item_reverso)
        reverso.merge_range('U44:W45', 'EJE/ ENTR', subtitulo_reverse)
        reverso.merge_range('U46:W46', '', item_reverso)
        reverso.merge_range('U47:W47', '', item_reverso)
        reverso.merge_range('U48:W48', '', item_reverso)
        reverso.merge_range('U49:W49', '', item_reverso)
        reverso.merge_range('U50:W50', '', item_reverso)
        reverso.merge_range('X44:Y45', 'DX', subtitulo_reverse)
        reverso.merge_range('X46:Y46', '', item_reverso)
        reverso.merge_range('X47:Y47', '', item_reverso)
        reverso.merge_range('X48:Y48', '', item_reverso)
        reverso.merge_range('X49:Y49', '', item_reverso)
        reverso.merge_range('X50:Y50', '', item_reverso)
        reverso.merge_range('Z44:Z45', 'RES', subtitulo_reverse)
        reverso.write('Z46', '', item_reverso)
        reverso.write('Z47', '', item_reverso)
        reverso.write('Z48', '', item_reverso)
        reverso.write('Z49', '', item_reverso)
        reverso.write('Z50', '', item_reverso)
        reverso.merge_range('AA44:AA45', u'N° TICKET', subtitulo_reverse)
        reverso.write('AA46', '', item_reverso)
        reverso.write('AA47', '', item_reverso)
        reverso.write('AA48', '', item_reverso)
        reverso.write('AA49', '', item_reverso)
        reverso.write('AA50', '', item_reverso)
        reverso.merge_range('AB44:AC45', 'PO', subtitulo_reverse)
        reverso.merge_range('AB46:AC46', '', item_reverso)
        reverso.merge_range('AB47:AC47', '', item_reverso)
        reverso.merge_range('AB48:AC48', '', item_reverso)
        reverso.merge_range('AB49:AC49', '', item_reverso)
        reverso.merge_range('AB50:AC50', '', item_reverso)
        reverso.merge_range('A51:AC51', 'OBSERVACIONES', subtitulo_reverse)
        reverso.merge_range('A52:AC53', '', item_reverso)
        reverso.merge_range('A54:AC55', '', item_reverso)
        reverso.merge_range('A56:AC57', '', item_reverso)
        reverso.merge_range('A58:AC59', '', item_reverso)
        reverso.merge_range(
            'B70:K71', '/'.join([
                'Firma y Sello del Responsable de Procedimiento y',
                'o Farmacia y', 'o Laboratorio']), firma_reverso)
        reverso.merge_range('R61:V69', '', item_16)
        reverso.merge_range(
            'R70:V71', 'Huella Digital del Asegurado o del Apoderado', firma_reverso)

        workbook.close()
        return workbook


class Fua013ExcelReport(FuaBase):
    def get_book(self, output):
        workbook = xlsxwriter.Workbook(output)
        worksheet = workbook.add_worksheet('FUA013')
        worksheet.fit_to_pages(1, 1)
        worksheet.set_portrait()

        self.set_front_columns_dimension(worksheet)
        self.set_front_row_dimension(worksheet)

        section_format = workbook.add_format()
        self.bold_pattern_common(section_format)
        section_format.set_bg_color('#CCCCCC')
        section_format.set_font_size(11)

        subsection_format = workbook.add_format()
        self.bold_pattern_common(subsection_format)
        subsection_format.set_bg_color('#F2F2F2')
        subsection_format.set_font_size(10)

        item_16 = workbook.add_format()
        self.bold_common(item_16)
        item_16.set_font_size(16)

        check_format = workbook.add_format()
        self.bold_common(check_format)
        check_format.set_font_size(20)

        label_item = workbook.add_format()
        self.pattern_common(label_item)
        label_item.set_bg_color('#F2F2F2')
        label_item.set_font_size(9)

        item_section = workbook.add_format()
        self.common_formats(item_section)
        item_section.set_font_size(9)

        item_rotated = workbook.add_format()
        self.bold_pattern_common(item_rotated)
        item_rotated.set_bg_color('#F2F2F2')
        item_rotated.set_font_size(10)
        item_rotated.set_rotation(90)

        superscript = workbook.add_format({'font_script': 1})

        formato_leyenda = workbook.add_format()
        self.common_formats(formato_leyenda)
        formato_leyenda.set_font_size(7)

        formato_leyenda_8 = workbook.add_format()
        self.common_formats(formato_leyenda_8)
        formato_leyenda_8.set_font_size(8)

        responsable_formato = workbook.add_format()
        responsable_formato.set_align('vcenter')
        responsable_formato.set_bold()
        responsable_formato.set_font_name('Arial')
        responsable_formato.set_font_size(11)

        subrayado = workbook.add_format()
        subrayado.set_bottom(1)

        today = timezone.now()

        worksheet.insert_image(
            'A1', settings.STATIC_ROOT + '/img/minsa_logo.png',
            {'x_scale': 0.65, 'y_scale': 0.85})
        worksheet.merge_range('A1:BM4', '')
        worksheet.merge_range(
            'A5:BM5', u'FORMATO ÚNICO DE ATENCIÓN - FUA', section_format)
        worksheet.merge_range('R6:AO6', u'NÚMERO DE FORMATO', section_format)
        worksheet.merge_range(
            'R7:W8', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('X7:AA8', str(today.year)[2:], item_16)
        worksheet.merge_range('AB7:AO8', '', item_16)
        worksheet.merge_range(
            'AR6:BH6', u'INSTITUCIÓN EDUCATIVA', section_format)
        worksheet.merge_range('AR7:BH7', '', item_section)
        worksheet.merge_range('AR8:AT8', 'INIC.', subsection_format)
        worksheet.merge_range('AU8:AX8', 'PRIM.', subsection_format)
        worksheet.merge_range('AY8:AZ8', 'SEC.', subsection_format)
        worksheet.merge_range('BA8:BC8', '', item_section)
        worksheet.merge_range('BD8:BF8', u'SECCIÓN', subsection_format)
        worksheet.merge_range('BG8:BH8', '', item_section)
        worksheet.merge_range('BI6:BM6', u'CÓDIGO', section_format)
        worksheet.merge_range('BI7:BM7', '', item_section)
        worksheet.merge_range('BI8:BK8', 'TURNO', subsection_format)
        worksheet.merge_range('BL8:BM8', '', item_section)
        worksheet.merge_range(
            'A10:BM10', u'DE LA INSTITUCIÓN PRESTADORA DE SERVICIOS DE SALUD',
            section_format)
        worksheet.merge_range(
            'A11:S12', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range(
            'A13:S13', self.control.establecimiento.codigo, item_16)
        worksheet.merge_range(
            'T11:BM12', u'NOMBRE  DE LA IPRESS QUE REALIZA LA ATENCIÓN',
            subsection_format)
        worksheet.merge_range(
            'T13:BM13', self.control.establecimiento.nombre, item_16)
        worksheet.merge_range(
            'A15:S15', 'PERSONAL QUE ATIENDE', subsection_format)
        worksheet.merge_range(
            'T15:AB15', u'LUGAR DE ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AC15:AL15', u'ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AM15:BM15', 'REFERENCIA REALIZADA POR', subsection_format)
        worksheet.merge_range('A16:E17', 'DE LA IPRESS', label_item)
        worksheet.merge_range('A18:E18', 'ITINERANTE', label_item)
        worksheet.merge_range('A19:E19', 'OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'I16:S17', u'CÓDIGO DE LA OFERTA FLEXIBLE', label_item)
        worksheet.merge_range('F16:H17', 'X', check_format)
        worksheet.merge_range('F18:H18', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('I18:S19', '', check_format)
        worksheet.merge_range('T16:Z17', 'INTRAMURAL', label_item)
        worksheet.merge_range('T18:Z18', 'EXTRAMURAL', label_item)
        worksheet.merge_range('AA16:AB17', 'X', check_format)
        worksheet.merge_range('AA18:AB18', '', check_format)
        worksheet.merge_range('T19:AB19', '')
        worksheet.merge_range('AC16:AI17', 'AMBULATORIA', label_item)
        worksheet.merge_range('AC18:AI18', 'REFERENCIA', label_item)
        worksheet.merge_range('AC19:AI19', 'EMERGENCIA', label_item)
        worksheet.merge_range('AJ16:AL17', 'X', check_format)
        worksheet.merge_range('AJ18:AL18', '', check_format)
        worksheet.merge_range('AJ19:AL19', '', check_format)
        worksheet.merge_range('AM16:AT17', u'CÓD. RENAES', label_item)
        worksheet.merge_range(
            'AU16:BI17', u'NOMBRE DE LA IPRESS U OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'BJ16:BM17', u'N° HOJA DE REFERENCIA', label_item)
        worksheet.merge_range('AM18:AT19', '', item_16)
        worksheet.merge_range('AU18:BI19', '', item_16)
        worksheet.merge_range('BJ18:BM19', '', item_16)
        worksheet.merge_range(
            'A21:BM21', 'DEL ASEGURADO / USUARIO', section_format)
        worksheet.merge_range(
            'A22:O22', u'IDENTIFICACIÓN', subsection_format)
        worksheet.merge_range('A23:B24', 'TDI', label_item)
        worksheet.merge_range('A25:B25', '1', item_16)
        worksheet.merge_range(
            'C23:O24', u'N° DOCUMENTO DE IDENTIDAD', label_item)
        worksheet.merge_range(
            'C25:O25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'Q22:AI22', u'CÓDIGO DEL ASEGURADO SIS', subsection_format)
        worksheet.merge_range('Q23:V24', 'DIRESA / OTROS', label_item)
        worksheet.merge_range(
            'Q25:V25', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('W23:AI24', u'NÚMERO', label_item)
        worksheet.merge_range('W25:Y25', '2', item_16)
        worksheet.merge_range(
            'Z25:AI25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'AK22:BM22', 'ASEGURADO DE OTRA IAFAS', subsection_format)
        worksheet.merge_range('AK23:AP24', u'INSTITUCIÓN', label_item)
        worksheet.merge_range('AQ23:BM24', '', item_16)
        worksheet.merge_range('AK25:AP25', 'COD. SEGURO', label_item)
        worksheet.merge_range('AQ25:BM25', '', item_16)
        worksheet.merge_range(
            'A27:AI27', 'APELLIDO PATERNO', subsection_format)
        worksheet.merge_range(
            'A28:AI28', self.control.paciente.apellido_paterno, item_16)
        worksheet.merge_range(
            'AK27:BM27', 'APELLIDO MATERNO', subsection_format)
        worksheet.merge_range(
            'AK28:BM28', self.control.paciente.apellido_materno, item_16)

        nombres = self.control.paciente.nombres.split(' ')
        otros_nombres = ''
        try:
            otros_nombres += nombres[1]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[2]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[3]
        except Exception as e:
            print
            str(e)

        worksheet.merge_range('A30:AI30', 'PRIMER NOMBRE', subsection_format)
        worksheet.merge_range('A31:AI31', nombres[0], item_16)
        worksheet.merge_range('AK30:BM30', 'OTROS NOMBRES', subsection_format)
        worksheet.merge_range('AK31:BM31', otros_nombres, item_16)
        worksheet.merge_range('A33:G34', 'SEXO', subsection_format)
        worksheet.merge_range('A35:D35', 'MASCULINO', item_section)
        worksheet.merge_range('E35:G35', '', check_format)
        worksheet.merge_range('A36:D36', 'FEMENINO', item_section)
        worksheet.merge_range('E36:G36', 'X', check_format)
        worksheet.merge_range('A38:G40', 'SALUD MATERNA', subsection_format)
        worksheet.merge_range('A42:D46', 'GESTANTE', item_section)
        worksheet.merge_range('E42:G46', 'X', check_format)
        worksheet.merge_range('A47:D47', 'PUERPERA', item_section)
        worksheet.merge_range('E47:G47', '', check_format)
        worksheet.merge_range('I33:Q34', 'FECHA', subsection_format)
        worksheet.merge_range(
            'I35:Q36', 'FECHA PROBABLE DE PARTO / FECHA DE PARTO',
            item_section)
        worksheet.merge_range('I38:Q42', 'FECHA DE NACIMIENTO ', item_section)
        worksheet.merge_range(
            'I45:Q47', 'FECHA DE FALLECIMIENTO', item_section)

        fecha_nacimiento = self.control.paciente.fecha_nacimiento

        if fecha_nacimiento.day / 10 < 1:
            nacimiento_dia = '0' + str(fecha_nacimiento.day)
        else:
            nacimiento_dia = str(fecha_nacimiento.day)

        if fecha_nacimiento.month / 10 < 1:
            nacimiento_mes = '0' + str(fecha_nacimiento.month)
        else:
            nacimiento_mes = str(fecha_nacimiento.month)

        nacimiento_anio = str(fecha_nacimiento.year)

        fecha_probable_parto = self.control.fecha_probable_parto

        if fecha_probable_parto.month / 10 < 1:
            parto_mes = '0' + str(fecha_probable_parto.month)
        else:
            parto_mes = str(fecha_probable_parto.month)

        if fecha_probable_parto.day / 10 < 1:
            parto_dia = '0' + str(fecha_probable_parto.day)
        else:
            parto_dia = str(fecha_probable_parto.day)

        parto_anio = str(fecha_probable_parto.year)

        worksheet.merge_range('R33:X34', 'DIA', subsection_format)
        worksheet.merge_range('R35:U36', parto_dia[0], item_16)
        worksheet.merge_range('V35:X36', parto_dia[1], item_16)
        worksheet.merge_range('R38:U42', nacimiento_dia[0], item_16)
        worksheet.merge_range('V38:X42', nacimiento_dia[1], item_16)
        worksheet.merge_range('R45:U47', '', item_16)
        worksheet.merge_range('V45:X47', '', item_16)
        worksheet.merge_range('Y33:AD34', 'MES', subsection_format)
        worksheet.merge_range('Y35:Z36', parto_mes[0], item_16)
        worksheet.merge_range('AA35:AD36', parto_mes[1], item_16)
        worksheet.merge_range('Y38:Z42', nacimiento_mes[0], item_16)
        worksheet.merge_range('AA38:AD42', nacimiento_mes[1], item_16)
        worksheet.merge_range('Y45:Z47', '', item_16)
        worksheet.merge_range('AA45:AD47', '', item_16)
        worksheet.merge_range('AE33:AP34', u'AÑO', subsection_format)
        worksheet.merge_range('AE35:AG36', parto_anio[0], item_16)
        worksheet.merge_range('AH35:AJ36', parto_anio[1], item_16)
        worksheet.merge_range('AK35:AN36', parto_anio[2], item_16)
        worksheet.merge_range('AO35:AP36', parto_anio[3], item_16)
        worksheet.merge_range('AE38:AG42', nacimiento_anio[0], item_16)
        worksheet.merge_range('AH38:AJ42', nacimiento_anio[1], item_16)
        worksheet.merge_range('AK38:AN42', nacimiento_anio[2], item_16)
        worksheet.merge_range('AO38:AP42', nacimiento_anio[3], item_16)
        worksheet.merge_range('AE45:AG47', '', item_16)
        worksheet.merge_range('AH45:AJ47', '', item_16)
        worksheet.merge_range('AK45:AN47', '', item_16)
        worksheet.merge_range('AO45:AP47', '', item_16)
        worksheet.merge_range(
            'AR33:BD34', u'N° DE HISTORIA CLÍNICA', subsection_format)
        worksheet.merge_range(
            'AR35:BD36',
            self.control.paciente.historias_clinicas.last().numero, item_16)
        worksheet.merge_range('BF33:BM34', 'ETNIA', subsection_format)
        worksheet.merge_range('BF35:BM36', self.control.paciente.etnia_nombre, item_16)
        worksheet.merge_range(
            'AR38:BG39', u'DNI / CNV / AFILIACIÓN DEL RN 1', item_section)
        worksheet.merge_range('BH38:BM39', '', item_16)
        worksheet.merge_range(
            'AR42:BG45', u'DNI / CNV / AFILIACIÓN DEL RN 2', item_section)
        worksheet.merge_range('BH42:BM45', '', item_16)
        worksheet.merge_range(
            'AR47:BG47', u'DNI / CNV / AFILIACIÓN DEL RN 3', item_section)
        worksheet.merge_range('BH47:BM47', '', item_16)
        worksheet.merge_range('A49:BM49', u'DE LA ATENCIÓN', section_format)
        worksheet.merge_range(
            'A51:R51', u'FECHA DE ATENCIÓN', subsection_format)
        worksheet.merge_range('A52:B53', 'DIA', item_section)
        worksheet.merge_range('A54:A58', '', item_16)
        worksheet.merge_range('B54:B58', '', item_16)
        worksheet.merge_range('C52:F53', 'MES', item_section)
        worksheet.merge_range('C54:C58', '', item_16)
        worksheet.merge_range('D54:F58', '', item_16)
        worksheet.merge_range('G52:R53', u'AÑO', item_section)
        worksheet.merge_range('G54:K58', '', item_16)
        worksheet.merge_range('L54:M58', '', item_16)
        worksheet.merge_range('N54:O58', '', item_16)
        worksheet.merge_range('P54:R58', '', item_16)
        worksheet.merge_range('T51:Y52', 'HORA', subsection_format)
        worksheet.merge_range('T53:W58', '', item_16)
        worksheet.merge_range('X53:X58', ':', item_16)
        worksheet.merge_range('Y53:Y58', '', item_16)
        worksheet.merge_range(
            'A61:K62', 'REPORTE VINCULADO', subsection_format)
        worksheet.merge_range(
            'L61:Y61', u'CÓD. AUTORIZACIÓN', subsection_format)
        worksheet.merge_range('L62:Y62', '', item_16)
        worksheet.merge_range('AA51:AE52', 'UPS', subsection_format)
        worksheet.merge_range('AA53:AE58', '', check_format)
        worksheet.merge_range('AG51:AI52', u'CÓD. PRESTA.', subsection_format)
        worksheet.merge_range('AG53:AI58', '013', item_16)
        worksheet.merge_range(
            'AK51:AT52', u'CÓD. PRESTACION(ES) ADICIONAL (ES)',
            subsection_format)
        worksheet.merge_range('AK53:AT58', '', item_16)
        worksheet.merge_range(
            'AA61:AT61', u'N° FUA A VINCULAR', subsection_format)
        worksheet.merge_range('AA62:AT62', '', item_16)
        worksheet.merge_range('AW51:AY62', u'HOSPITALIZACIÓN', item_rotated)
        worksheet.merge_range('AZ51:BE51', 'FECHA', subsection_format)
        worksheet.merge_range('AZ52:BE54', 'DE INGRESO', item_section)
        worksheet.merge_range('AZ56:BE59', 'DE ALTA', item_section)
        worksheet.merge_range(
            'AZ61:BE62', 'DE CORTE ADMINISTRATIVO', item_section)
        worksheet.merge_range('BF51:BG51', 'DIA', subsection_format)
        worksheet.merge_range('BF52:BF54', '', item_16)
        worksheet.merge_range('BG52:BG54', '', item_16)
        worksheet.merge_range('BF56:BF59', '', item_16)
        worksheet.merge_range('BG56:BG59', '', item_16)
        worksheet.merge_range('BF61:BF62', '', item_16)
        worksheet.merge_range('BG61:BG62', '', item_16)
        worksheet.merge_range('BH51:BI51', 'MES', subsection_format)
        worksheet.merge_range('BH52:BH54', '', item_16)
        worksheet.merge_range('BI52:BI54', '', item_16)
        worksheet.merge_range('BH56:BH59', '', item_16)
        worksheet.merge_range('BI56:BI59', '', item_16)
        worksheet.merge_range('BH61:BH62', '', item_16)
        worksheet.merge_range('BI61:BI62', '', item_16)
        worksheet.merge_range('BJ51:BM51', u'AÑO', subsection_format)
        worksheet.merge_range('BJ52:BJ54', '', item_16)
        worksheet.merge_range('BK52:BK54', '', item_16)
        worksheet.merge_range('BL52:BL54', '', item_16)
        worksheet.merge_range('BM52:BM54', '', item_16)
        worksheet.merge_range('BJ56:BJ59', '', item_16)
        worksheet.merge_range('BK56:BK59', '', item_16)
        worksheet.merge_range('BL56:BL59', '', item_16)
        worksheet.merge_range('BM56:BM59', '', item_16)
        worksheet.merge_range('BJ61:BJ62', '', item_16)
        worksheet.merge_range('BK61:BK62', '', item_16)
        worksheet.merge_range('BL61:BL62', '', item_16)
        worksheet.merge_range('BM61:BM62', '', item_16)
        worksheet.merge_range(
            'A64:BM64', 'CONCEPTO PRESTACIONAL', section_format)
        worksheet.merge_range(
            'A65:C67', u'ATENCIÓN DIRECTA', subsection_format)
        worksheet.merge_range('D65:F67', 'X', check_format)
        worksheet.merge_range(
            'G65:X65', 'COB EXTRAORDINARIA', subsection_format)
        worksheet.merge_range('G66:O66', u'Nº Autorización', label_item)
        worksheet.merge_range('P66:X66', '', item_16)
        worksheet.merge_range('G67:N67', 'Monto S/.', label_item)
        worksheet.merge_range('O67:X67', '', item_16)
        worksheet.merge_range(
            'Y65:AK65', 'CARTA DE GARANTIA', subsection_format)
        worksheet.merge_range('Y66:AE66', u'Nº Autorización', label_item)
        worksheet.merge_range('AF66:AK66', '', item_16)
        worksheet.merge_range('Y67:AD67', 'Monto S/.', label_item)
        worksheet.merge_range('AE67:AK67', '', item_16)
        worksheet.merge_range('AL65:AQ67', 'TRASLADO', section_format)
        worksheet.merge_range('AR65:AS67', '', item_16)
        worksheet.merge_range('AT65:BM65', 'SEPELIO', subsection_format)
        worksheet.merge_range('AT66:BA67', 'NATIMUERTO', subsection_format)
        worksheet.merge_range('BB66:BD67', '', item_16)
        worksheet.merge_range('BE66:BG67', 'OBITO', subsection_format)
        worksheet.merge_range('BH66:BI67', '', item_16)
        worksheet.merge_range('BJ66:BK67', 'OTRO', subsection_format)
        worksheet.merge_range('BL66:BM67', '', item_16)
        worksheet.merge_range(
            'A69:BM69', 'DEL DESTINO DEL ASEGURADO/USUARIO', section_format)
        worksheet.merge_range('A70:A71', 'ALTA', label_item)
        worksheet.merge_range('B70:B71', '', item_16)
        worksheet.merge_range('C70:F71', 'CITA', label_item)
        worksheet.merge_range('G70:K71', 'X', check_format)
        worksheet.merge_range('L70:Q71', u'HOSPITALIZACIÓN', label_item)
        worksheet.merge_range('R70:S71', '', item_16)
        worksheet.merge_range('T70:AW70', 'REFERIDO', subsection_format)
        worksheet.merge_range('T71:Y71', 'EMERGENCIA', label_item)
        worksheet.merge_range('Z71:AA71', '', check_format)
        worksheet.merge_range('AB71:AI71', 'CONSULTA EXTERNA', label_item)
        worksheet.merge_range('AJ71:AL71', '', check_format)
        worksheet.merge_range('AM71:AT71', u'APOYO AL DIAGNÓSTICO', label_item)
        worksheet.merge_range('AU71:AW71', '', check_format)
        worksheet.merge_range('AX70:BC71', 'CONTRA REFERIDO', label_item)
        worksheet.merge_range('BD70:BD71', '', check_format)
        worksheet.merge_range('BE70:BH71', 'FALLECIDO', label_item)
        worksheet.merge_range('BI70:BI71', '', check_format)
        worksheet.merge_range('BJ70:BK71', 'CORTE ADMINIS.', label_item)
        worksheet.merge_range('BL70:BM71', '', check_format)
        worksheet.merge_range(
            'A73:BM73', 'SE REFIERE / CONTRARREFIERE A:', section_format)
        worksheet.merge_range(
            'A74:M74', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range('A75:M75', '', item_16)
        worksheet.merge_range(
            'N74:BC74',
            'NOMBRE DE LA IPRESS A LA QUE SE REFIERE / CONTRARREFIERE',
            subsection_format)
        worksheet.merge_range('N75:BC75', '', item_16)
        worksheet.merge_range(
            'BD74:BM74', u'N° HOJA DE REFER / CONTRARR.', subsection_format)
        worksheet.merge_range('BD75:BM75', '', item_16)
        worksheet.merge_range(
            'A77:AR77', 'ACTIVIDADES PREVENTIVAS Y OTROS', section_format)
        worksheet.merge_range('A78:I78', 'PESO (Kg)', subsection_format)
        worksheet.merge_range('J78:N78', '', item_16)
        worksheet.merge_range('O78:X78', 'TALLA (cm)', subsection_format)
        worksheet.merge_range('Y78:AB78', '', item_16)
        worksheet.merge_range('AC78:AM78', 'P.A. (mmHg)', subsection_format)
        worksheet.merge_range('AN78:AR78', '', item_16)
        worksheet.merge_range('A79:D79', 'DE LA GESTANTE', subsection_format)
        worksheet.merge_range('A80:B82', u'CPN (N°)', item_section)
        worksheet.merge_range('C80:D82', '', item_16)
        worksheet.merge_range('A83:B84', 'EDAD GEST', item_section)
        worksheet.merge_range('C83:D84', '', item_16)
        worksheet.merge_range('A85:B86', 'ALTURA UTERINA', item_section)
        worksheet.merge_range('C85:D86', '', item_16)
        worksheet.merge_range('A87:B88', 'PARTO VERTICAL', item_section)
        worksheet.merge_range('C87:D88', '', item_16)
        worksheet.merge_range('A89:B90', u'CONTROL PUERP (N°)', item_section)
        worksheet.merge_range('C89:D90', '', item_16)
        worksheet.merge_range(
            'F79:Q79', 'DEL RECIEN NACIDO', subsection_format)
        worksheet.merge_range('F80:N81', 'EDAD GEST RN (SEM)', item_section)
        worksheet.merge_range('O80:Q81', '', item_16)
        worksheet.merge_range('F83:K85', 'APGAR', item_section)
        worksheet.merge_range('L83:L85', u'1°', item_section)
        worksheet.merge_range('M83:M85', '', item_section)
        worksheet.merge_range('N83:N85', u'5°', item_section)
        worksheet.merge_range('O83:Q85', '', item_section)
        worksheet.merge_range(
            'F87:N88', u'Corte Tardío de Cordón (2 a 3 min)', item_section)
        worksheet.merge_range('O87:Q88', '', item_16)
        worksheet.merge_range('F90:P90', '3', item_section)
        worksheet.merge_range(
            'S79:AK79', u' / '.join([
                'GESTANTE', 'RN', u'NIÑO', 'ADOLESCENTE', 'JOVEN Y ADULTO',
                'ADULTO MAYOR']), subsection_format)
        worksheet.merge_range('S80:Z81', u'CRED N°', item_section)
        worksheet.merge_range('AA80:AA81', '', check_format)
        worksheet.merge_range('S83:Z83', 'R.N. PREMATURO', item_section)
        worksheet.write('AA83', '', check_format)
        worksheet.merge_range('S85:Z85', 'BAJO PESO AL NACER', item_section)
        worksheet.write('AA85', '', check_format)
        worksheet.merge_range(
            'S87:Z88', 'ENFER. CONGENITA / SECUELA AL NACER', item_section)
        worksheet.merge_range('AA87:AA88', '', check_format)
        worksheet.merge_range(
            'S90:Z90', u'N° FAMILIARES DE GEST / PUERP. CASA MAT.',
            item_section)
        worksheet.write('AA90', '', check_format)
        worksheet.merge_range('AC80:AG81', 'PAB (cm)', item_section)
        worksheet.merge_range('AH80:AK81', '', item_16)
        worksheet.merge_range('AC83:AH83', 'TAP / EEDP o TEPSI', item_section)
        worksheet.merge_range('AI83:AK83', '', item_16)
        worksheet.merge_range(
            'AC85:AH85', 'CONSEJERIA NUTRICIONAL', item_section)
        worksheet.merge_range('AI85:AK85', '', item_16)
        worksheet.merge_range('AC87:AH88', 'CONSEJERIA INTEGRAL', item_section)
        worksheet.merge_range('AI87:AK88', '', item_16)
        worksheet.merge_range('AC90:AH90', '', item_section)
        worksheet.write_rich_string(
            'AC90', label_item, 'IMC (Kg/M', superscript, '2', label_item,
            ')', item_section)
        worksheet.merge_range('AI90:AK90', self.control.imc, item_16)
        worksheet.merge_range('AM79:AR79', 'JOVEN Y ADULTO', label_item)
        worksheet.merge_range(
            'AM80:AP81', u'EVALUACIÓN INTEGRAL', item_section)
        worksheet.merge_range('AQ80:AR81', '', item_16)
        worksheet.merge_range('AM83:AR83', 'ADULTO MAYOR', label_item)
        worksheet.merge_range('AM84:AP85', 'VACAM', item_section)
        worksheet.merge_range('AQ84:AR85', '', item_16)
        worksheet.merge_range(
            'AM87:AP88', 'TAMIZAJE DE SALUD MENTAL', item_section)
        worksheet.merge_range('AQ87:AR87', 'PAT.', item_section)
        worksheet.merge_range('AQ88:AR88', 'NOR.', item_section)
        worksheet.merge_range('AM90:AR90', '', item_16)
        worksheet.merge_range(
            'AT77:BM77', u'VACUNAS N° DE DOSIS', section_format)
        worksheet.merge_range('AT78:AY78', 'BCG', item_section)
        worksheet.merge_range('AZ78:BB78', '', item_16)
        worksheet.merge_range('AT79:AY80', 'DPT', item_section)
        worksheet.merge_range('AZ79:BB80', '', item_16)
        worksheet.merge_range('AT81:AY82', 'APO', item_section)
        worksheet.merge_range('AZ81:BB82', '', item_16)
        worksheet.merge_range('AT83:AY84', 'ASA', item_section)
        worksheet.merge_range('AZ83:BB84', '', item_16)
        worksheet.merge_range('AT85:AY85', 'SPR', item_section)
        worksheet.merge_range('AZ85:BB85', '', item_16)
        worksheet.merge_range('AT86:AY87', 'SR', item_section)
        worksheet.merge_range('AZ86:BB87', '', item_16)
        worksheet.merge_range('AT88:AY89', 'HVB', item_section)
        worksheet.merge_range('AZ88:BB89', '', item_16)
        worksheet.merge_range('BC78:BF78', 'INFLUENZA', item_section)
        worksheet.merge_range('BG78:BH78', '', item_16)
        worksheet.merge_range('BC79:BF80', 'PAROTID', item_section)
        worksheet.merge_range('BG79:BH80', '', item_16)
        worksheet.merge_range('BC81:BF82', 'RUBEOLA', item_section)
        worksheet.merge_range('BG81:BH82', '', item_16)
        worksheet.merge_range('BC83:BF84', 'ROTAVIRUS', item_section)
        worksheet.merge_range('BG83:BH84', '', item_16)
        worksheet.merge_range(
            'BC85:BF85', u'DT ADULTO (N° DOSIS)', item_section)
        worksheet.merge_range('BG85:BH85', '', item_16)
        worksheet.merge_range('BC86:BF87', 'IPV', item_section)
        worksheet.merge_range('BG86:BH87', '', item_16)
        worksheet.merge_range('BC88:BF89', 'PENTAVAL', item_section)
        worksheet.merge_range('BG88:BH89', '', item_16)
        worksheet.merge_range('BI78:BK78', 'ANTIAMARILICA', item_section)
        worksheet.merge_range('BL78:BM78', '', item_16)
        worksheet.merge_range('BI79:BK80', 'ANTINEUMOC', item_section)
        worksheet.merge_range('BL79:BM80', '', item_16)
        worksheet.merge_range('BI81:BK82', 'ANTITETANICA', item_section)
        worksheet.merge_range('BL81:BM82', '', item_16)
        worksheet.merge_range(
            'BI83:BK84', ' COMPLETAS PARA LA EDAD', item_section)
        worksheet.merge_range('BL83:BL84', 'SI', item_section)
        worksheet.merge_range('BM83:BM84', 'NO', item_section)
        worksheet.merge_range('BI85:BK85', 'VPH', item_section)
        worksheet.merge_range('BL85:BM85', '', item_16)
        worksheet.merge_range('BI86:BK87', 'OTRA VACUNA', item_section)
        worksheet.merge_range('BL86:BM87', '', item_16)
        worksheet.merge_range('BI88:BK89', '____________', item_section)
        worksheet.merge_range('BL88:BM89', '', item_16)
        worksheet.merge_range('AT90:AZ90', 'GRUPO DE RIESGO HVB', item_section)
        worksheet.merge_range('BA90:BC90', '', item_16)
        worksheet.merge_range('BD90:BM90', '   '.join([
            'GRUPO DE RIESGO HVB: 1. TRABAJADOR DE SALUD',
            '2. TRABAJAD. SEXUALES', '3. HSH', '4. PRIVADO LIBERTAD',
            '5. FF. AA.', '6. POLICIA NACIONAL', '7. ESTUDIANTES DE SALUD',
            '8. POLITRANFUNDIDOS', '9. DROGO DEPENDIENTES ']), formato_leyenda)
        worksheet.merge_range('A93:BM93', '10', section_format)
        worksheet.merge_range('A94:A95', u'N°', subsection_format)
        worksheet.write('A96', '1', item_section)
        worksheet.write('A97', '2', item_section)
        worksheet.write('A98', '3', item_section)
        worksheet.write('A99', '4', item_section)
        worksheet.write('A100', '5', item_section)
        worksheet.merge_range('B94:AN95', u'DESCRIPCIÓN', subsection_format)
        worksheet.merge_range('B96:AN96', '', item_section)
        worksheet.merge_range('B97:AN97', '', item_section)
        worksheet.merge_range('B98:AN98', '', item_section)
        worksheet.merge_range('B99:AN99', '', item_section)
        worksheet.merge_range('B100:AN100', '', item_section)
        worksheet.merge_range('AO94:BD94', 'INGRESO', subsection_format)
        worksheet.merge_range('AO95:AW95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('AO96:AP96', 'P', item_section)
        worksheet.merge_range('AQ96:AS96', 'D', item_section)
        worksheet.merge_range('AT96:AW96', 'R', item_section)
        worksheet.merge_range('AO97:AP97', 'P', item_section)
        worksheet.merge_range('AQ97:AS97', 'D', item_section)
        worksheet.merge_range('AT97:AW97', 'R', item_section)
        worksheet.merge_range('AO98:AP98', 'P', item_section)
        worksheet.merge_range('AQ98:AS98', 'D', item_section)
        worksheet.merge_range('AT98:AW98', 'R', item_section)
        worksheet.merge_range('AO99:AP99', 'P', item_section)
        worksheet.merge_range('AQ99:AS99', 'D', item_section)
        worksheet.merge_range('AT99:AW99', 'R', item_section)
        worksheet.merge_range('AO100:AP100', 'P', item_section)
        worksheet.merge_range('AQ100:AS100', 'D', item_section)
        worksheet.merge_range('AT100:AW100', 'R', item_section)
        worksheet.merge_range('AX95:BD95', 'CIE - 10', subsection_format)
        worksheet.merge_range('AX96:BD96', '', item_16)
        worksheet.merge_range('AX97:BD97', '', item_16)
        worksheet.merge_range('AX98:BD98', '', item_16)
        worksheet.merge_range('AX99:BD99', '', item_16)
        worksheet.merge_range('AX100:BD100', '', item_16)
        worksheet.merge_range('BE94:BM94', 'EGRESO', subsection_format)
        worksheet.merge_range('BE95:BI95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('BE96:BG96', 'D', item_section)
        worksheet.merge_range('BH96:BI96', 'R', item_section)
        worksheet.merge_range('BE97:BG97', 'D', item_section)
        worksheet.merge_range('BH97:BI97', 'R', item_section)
        worksheet.merge_range('BE98:BG98', 'D', item_section)
        worksheet.merge_range('BH98:BI98', 'R', item_section)
        worksheet.merge_range('BE99:BG99', 'D', item_section)
        worksheet.merge_range('BH99:BI99', 'R', item_section)
        worksheet.merge_range('BE100:BG100', 'D', item_section)
        worksheet.merge_range('BH100:BI100', 'R', item_section)
        worksheet.merge_range('BJ95:BM95', 'CIE - 10', subsection_format)
        worksheet.merge_range('BJ96:BM96', '', item_16)
        worksheet.merge_range('BJ97:BM97', '', item_16)
        worksheet.merge_range('BJ98:BM98', '', item_16)
        worksheet.merge_range('BJ99:BM99', '', item_16)
        worksheet.merge_range('BJ100:BM100', '', item_16)
        worksheet.merge_range('A102:N102', u'N° DE DNI', section_format)
        worksheet.merge_range('A103:N103', self.request.user.dni, item_16)
        worksheet.merge_range(
            'O102:BE102', u'NOMBRE DEL RESPONSABLE DE LA ATENCIÓN',
            section_format)
        worksheet.merge_range(
            'O103:BE103', self.request.user.get_full_name(), item_16)
        worksheet.merge_range(
            'BF102:BM102', u'N° DE COLEGIATURA', section_format)
        worksheet.merge_range(
            'BF103:BM103', self.request.user.colegiatura, item_16)
        worksheet.merge_range(
            'A105:N105', u'RESPONSABLE DE LA ATENCIÓN', subsection_format)
        worksheet.merge_range('O105:Q105', '', item_section)
        worksheet.merge_range('R105:Y105', 'ESPECIALIDAD', subsection_format)
        worksheet.merge_range('Z105:AT105', '', item_section)
        worksheet.merge_range('AU105:AZ105', u'N° RNE', subsection_format)
        worksheet.merge_range('BA105:BE105', '', item_section)
        worksheet.merge_range('BF105:BK105', 'EGRESADO', subsection_format)
        worksheet.merge_range('BL105:BM105', '', item_16)
        worksheet.merge_range('A106:BM107', u'   '.join([
            u'1. MÉDICO', '2. FARMACEUTICO', '3. CIRUJANO DENTISTA',
            u'4. BIÓLOGO', '5. OBSTETRIZ', '6. ENFERMERA',
            '7. TRABAJADORA SOCIAL', '8. PSICOLOGA', '9.TECNOLOGO MEDICO',
            '10.NUTRICION', '11. TECNICO ENFERMERIA',
            '12. AUXILIAR DE ENFERMERIA', '13. OTRO']), formato_leyenda_8)
        worksheet.merge_range('B119:Y119', '', subrayado)
        worksheet.merge_range(
            'B121:Y121', u'FIRMA Y SELLO DEL RESPONSABLE DE LA ATENCIÓN ',
            responsable_formato)
        worksheet.merge_range('AH108:AM109', 'FIRMA', responsable_formato)
        worksheet.merge_range('AH110:AM111', 'ASEGURADO', responsable_formato)
        worksheet.merge_range('AO110:AP111', '', item_16)
        worksheet.merge_range('AH112:AM113', 'APODERADO', responsable_formato)
        worksheet.merge_range('AO112:AP113', '', item_16)
        worksheet.write('AH117', 'APODERADO:', responsable_formato)
        worksheet.merge_range('AQ117:BE117', '', subrayado)
        worksheet.write('AH118', 'NOMBRES Y APELLIDOS', responsable_formato)
        worksheet.merge_range('AQ118:BE118', '', subrayado)
        worksheet.write(
            'AH121', 'DNI o CE DEL APODERADO:', responsable_formato)
        worksheet.merge_range('AR121:BE121', '', subrayado)

        worksheet.merge_range('BH109:BL120', '', item_16)

        worksheet.merge_range(
            'BG122:BL124', 'Huella Digital del Asegurado o del Apoderado',
            item_section)

        reverso = workbook.add_worksheet('FUA013R')
        reverso.fit_to_pages(1, 1)
        reverso.set_portrait()

        self.set_back_column_dimension(reverso)
        self.set_back_row_dimension(reverso)

        titulo_reverse = workbook.add_format()
        self.bold_pattern_common(titulo_reverse)
        titulo_reverse.set_bg_color('#D9D9D9')
        titulo_reverse.set_font_size(22)

        subtitulo_reverse = workbook.add_format()
        self.bold_pattern_common(subtitulo_reverse)
        subtitulo_reverse.set_bg_color('#D9D9D9')
        subtitulo_reverse.set_font_size(20)

        item_reverso = workbook.add_format()
        self.bold_common(item_reverso)
        item_reverso.set_font_size(20)

        firma_reverso = workbook.add_format()
        firma_reverso.set_align('center')
        firma_reverso.set_align('vcenter')
        firma_reverso.set_bold()
        firma_reverso.set_font_name('Arial')
        firma_reverso.set_font_size(24)
        firma_reverso.set_text_wrap()
        firma_reverso.set_top()

        reverso.merge_range(
            'T1:AC1', u'FORMATO DE ATENCIÓN Nº', titulo_reverse)
        reverso.merge_range('T2:V2', '', item_16)
        reverso.merge_range('W2:Y2', '', item_16)
        reverso.merge_range('Z2:AC2', '', item_16)
        reverso.merge_range(
            'A4:AC4', 'PRODUCTOS FARMACEUTICOS / MEDICAMENTOS', titulo_reverse)
        reverso.merge_range('A5:B5', u'CÓDIGO SISMED', subtitulo_reverse)
        reverso.merge_range('C5:J5', 'NOMBRE', subtitulo_reverse)
        reverso.write('K5', 'FF', subtitulo_reverse)
        reverso.write('L5', 'CONCENTR', subtitulo_reverse)
        reverso.write('M5', 'PRES', subtitulo_reverse)
        reverso.write('N5', 'ENTR', subtitulo_reverse)
        reverso.write('O5', 'DX', subtitulo_reverse)
        reverso.merge_range('P5:Q5', u'CÓD. SISMED', subtitulo_reverse)
        reverso.merge_range('R5:X5', 'NOMBRE', subtitulo_reverse)
        reverso.write('Y5', 'FF', subtitulo_reverse)
        reverso.write('Z5', 'CONCENTR', subtitulo_reverse)
        reverso.write('AA5', 'PRES', subtitulo_reverse)
        reverso.write('AB5', 'ENTR', subtitulo_reverse)
        reverso.write('AC5', 'DX', subtitulo_reverse)
        reverso.merge_range('A6:B6', '', item_reverso)
        reverso.merge_range('C6:J6', '', item_reverso)
        reverso.write('L6', '', item_reverso)
        reverso.write('K6', '', item_reverso)
        reverso.write('M6', '', item_reverso)
        reverso.write('N6', '', item_reverso)
        reverso.write('O6', '', item_reverso)
        reverso.write('Y6', '', item_reverso)
        reverso.write('Z6', '', item_reverso)
        reverso.write('AA6', '', item_reverso)
        reverso.write('AB6', '', item_reverso)
        reverso.write('AC6', '', item_reverso)
        reverso.merge_range('A7:B7', '', item_reverso)
        reverso.merge_range('A8:B8', '', item_reverso)
        reverso.merge_range('A9:B9', '', item_reverso)
        reverso.merge_range('A10:B10', '', item_reverso)
        reverso.merge_range('A11:B11', '', item_reverso)
        reverso.merge_range('A12:B12', '', item_reverso)
        reverso.merge_range('A13:B13', '', item_reverso)
        reverso.merge_range('A14:B14', '', item_reverso)
        reverso.merge_range('A15:B15', '', item_reverso)
        reverso.merge_range('A16:B16', '', item_reverso)
        reverso.merge_range('A17:B17', '', item_reverso)
        reverso.merge_range('A18:B18', '', item_reverso)
        reverso.merge_range('C7:J7', '', item_reverso)
        reverso.merge_range('C8:J8', '', item_reverso)
        reverso.merge_range('C9:J9', '', item_reverso)
        reverso.merge_range('C10:J10', '', item_reverso)
        reverso.merge_range('C11:J11', '', item_reverso)
        reverso.merge_range('C12:J12', '', item_reverso)
        reverso.merge_range('C13:J13', '', item_reverso)
        reverso.merge_range('C14:J14', '', item_reverso)
        reverso.merge_range('C15:J15', '', item_reverso)
        reverso.merge_range('C16:J16', '', item_reverso)
        reverso.merge_range('C17:J17', '', item_reverso)
        reverso.merge_range('C18:J18', '', item_reverso)
        reverso.write('K7', '', item_reverso)
        reverso.write('K8', '', item_reverso)
        reverso.write('K9', '', item_reverso)
        reverso.write('K10', '', item_reverso)
        reverso.write('K11', '', item_reverso)
        reverso.write('K12', '', item_reverso)
        reverso.write('K13', '', item_reverso)
        reverso.write('K14', '', item_reverso)
        reverso.write('K15', '', item_reverso)
        reverso.write('K16', '', item_reverso)
        reverso.write('K17', '', item_reverso)
        reverso.write('K18', '', item_reverso)
        reverso.write('L7', '', item_reverso)
        reverso.write('L8', '', item_reverso)
        reverso.write('L9', '', item_reverso)
        reverso.write('L10', '', item_reverso)
        reverso.write('L11', '', item_reverso)
        reverso.write('L12', '', item_reverso)
        reverso.write('L13', '', item_reverso)
        reverso.write('L14', '', item_reverso)
        reverso.write('L15', '', item_reverso)
        reverso.write('L16', '', item_reverso)
        reverso.write('L17', '', item_reverso)
        reverso.write('L18', '', item_reverso)
        reverso.write('M7', '', item_reverso)
        reverso.write('M8', '', item_reverso)
        reverso.write('M9', '', item_reverso)
        reverso.write('M10', '', item_reverso)
        reverso.write('M11', '', item_reverso)
        reverso.write('M12', '', item_reverso)
        reverso.write('M13', '', item_reverso)
        reverso.write('M14', '', item_reverso)
        reverso.write('M15', '', item_reverso)
        reverso.write('M16', '', item_reverso)
        reverso.write('M17', '', item_reverso)
        reverso.write('M18', '', item_reverso)
        reverso.write('N7', '', item_reverso)
        reverso.write('N8', '', item_reverso)
        reverso.write('N9', '', item_reverso)
        reverso.write('N10', '', item_reverso)
        reverso.write('N11', '', item_reverso)
        reverso.write('N12', '', item_reverso)
        reverso.write('N13', '', item_reverso)
        reverso.write('N14', '', item_reverso)
        reverso.write('N15', '', item_reverso)
        reverso.write('N16', '', item_reverso)
        reverso.write('N17', '', item_reverso)
        reverso.write('N18', '', item_reverso)
        reverso.write('O7', '', item_reverso)
        reverso.write('O8', '', item_reverso)
        reverso.write('O9', '', item_reverso)
        reverso.write('O10', '', item_reverso)
        reverso.write('O11', '', item_reverso)
        reverso.write('O12', '', item_reverso)
        reverso.write('O13', '', item_reverso)
        reverso.write('O14', '', item_reverso)
        reverso.write('O15', '', item_reverso)
        reverso.write('O16', '', item_reverso)
        reverso.write('O17', '', item_reverso)
        reverso.write('O18', '', item_reverso)
        reverso.write('Y7', '', item_reverso)
        reverso.write('Y8', '', item_reverso)
        reverso.write('Y9', '', item_reverso)
        reverso.write('Y10', '', item_reverso)
        reverso.write('Y11', '', item_reverso)
        reverso.write('Y12', '', item_reverso)
        reverso.write('Y13', '', item_reverso)
        reverso.write('Y14', '', item_reverso)
        reverso.write('Y15', '', item_reverso)
        reverso.write('Y16', '', item_reverso)
        reverso.write('Y17', '', item_reverso)
        reverso.write('Y18', '', item_reverso)
        reverso.write('Z7', '', item_reverso)
        reverso.write('Z8', '', item_reverso)
        reverso.write('Z9', '', item_reverso)
        reverso.write('Z10', '', item_reverso)
        reverso.write('Z11', '', item_reverso)
        reverso.write('Z12', '', item_reverso)
        reverso.write('Z13', '', item_reverso)
        reverso.write('Z14', '', item_reverso)
        reverso.write('Z15', '', item_reverso)
        reverso.write('Z16', '', item_reverso)
        reverso.write('Z17', '', item_reverso)
        reverso.write('Z18', '', item_reverso)
        reverso.write('AA7', '', item_reverso)
        reverso.write('AA8', '', item_reverso)
        reverso.write('AA9', '', item_reverso)
        reverso.write('AA10', '', item_reverso)
        reverso.write('AA11', '', item_reverso)
        reverso.write('AA12', '', item_reverso)
        reverso.write('AA13', '', item_reverso)
        reverso.write('AA14', '', item_reverso)
        reverso.write('AA15', '', item_reverso)
        reverso.write('AA16', '', item_reverso)
        reverso.write('AA17', '', item_reverso)
        reverso.write('AA18', '', item_reverso)
        reverso.write('AB7', '', item_reverso)
        reverso.write('AB8', '', item_reverso)
        reverso.write('AB9', '', item_reverso)
        reverso.write('AB10', '', item_reverso)
        reverso.write('AB11', '', item_reverso)
        reverso.write('AB12', '', item_reverso)
        reverso.write('AB13', '', item_reverso)
        reverso.write('AB14', '', item_reverso)
        reverso.write('AB15', '', item_reverso)
        reverso.write('AB16', '', item_reverso)
        reverso.write('AB17', '', item_reverso)
        reverso.write('AB18', '', item_reverso)
        reverso.write('AC7', '', item_reverso)
        reverso.write('AC8', '', item_reverso)
        reverso.write('AC9', '', item_reverso)
        reverso.write('AC10', '', item_reverso)
        reverso.write('AC11', '', item_reverso)
        reverso.write('AC12', '', item_reverso)
        reverso.write('AC13', '', item_reverso)
        reverso.write('AC14', '', item_reverso)
        reverso.write('AC15', '', item_reverso)
        reverso.write('AC16', '', item_reverso)
        reverso.write('AC17', '', item_reverso)
        reverso.write('AC18', '', item_reverso)
        reverso.merge_range(
            'A19:AC19', u'DISPOSITIVOS MÉDICOS / PRODUCTOS SANITARIOS',
            titulo_reverse)
        reverso.merge_range('A20:B20', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A21:B21', '', item_reverso)
        reverso.merge_range('A22:B22', '', item_reverso)
        reverso.merge_range('A23:B23', '', item_reverso)
        reverso.merge_range('A24:B24', '', item_reverso)
        reverso.merge_range('A25:B25', '', item_reverso)
        reverso.merge_range('A26:B26', '', item_reverso)
        reverso.merge_range('A27:B27', '', item_reverso)
        reverso.merge_range('A28:B28', '', item_reverso)
        reverso.merge_range('A29:B29', '', item_reverso)
        reverso.merge_range('C20:J20', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C21:J21', '', item_reverso)
        reverso.merge_range('C22:J22', '', item_reverso)
        reverso.merge_range('C23:J23', '', item_reverso)
        reverso.merge_range('C24:J24', '', item_reverso)
        reverso.merge_range('C25:J25', '', item_reverso)
        reverso.merge_range('C26:J26', '', item_reverso)
        reverso.merge_range('C27:J27', '', item_reverso)
        reverso.merge_range('C28:J28', '', item_reverso)
        reverso.merge_range('C29:J29', '', item_reverso)
        reverso.write('K20', 'PR', subtitulo_reverse)
        reverso.write('K21', '', item_reverso)
        reverso.write('K22', '', item_reverso)
        reverso.write('K23', '', item_reverso)
        reverso.write('K24', '', item_reverso)
        reverso.write('K25', '', item_reverso)
        reverso.write('K26', '', item_reverso)
        reverso.write('K27', '', item_reverso)
        reverso.write('K28', '', item_reverso)
        reverso.write('K29', '', item_reverso)
        reverso.write('L20', 'CARACT', subtitulo_reverse)
        reverso.write('L21', '', item_reverso)
        reverso.write('L22', '', item_reverso)
        reverso.write('L23', '', item_reverso)
        reverso.write('L24', '', item_reverso)
        reverso.write('L25', '', item_reverso)
        reverso.write('L26', '', item_reverso)
        reverso.write('L27', '', item_reverso)
        reverso.write('L28', '', item_reverso)
        reverso.write('L29', '', item_reverso)
        reverso.write('M20', 'PRES', subtitulo_reverse)
        reverso.write('M21', '', item_reverso)
        reverso.write('M22', '', item_reverso)
        reverso.write('M23', '', item_reverso)
        reverso.write('M24', '', item_reverso)
        reverso.write('M25', '', item_reverso)
        reverso.write('M26', '', item_reverso)
        reverso.write('M27', '', item_reverso)
        reverso.write('M28', '', item_reverso)
        reverso.write('M29', '', item_reverso)
        reverso.write('N20', 'ENTR', subtitulo_reverse)
        reverso.write('N21', '', item_reverso)
        reverso.write('N22', '', item_reverso)
        reverso.write('N23', '', item_reverso)
        reverso.write('N24', '', item_reverso)
        reverso.write('N25', '', item_reverso)
        reverso.write('N26', '', item_reverso)
        reverso.write('N27', '', item_reverso)
        reverso.write('N28', '', item_reverso)
        reverso.write('N29', '', item_reverso)
        reverso.write('O20', 'DX', subtitulo_reverse)
        reverso.write('O21', '', item_reverso)
        reverso.write('O22', '', item_reverso)
        reverso.write('O23', '', item_reverso)
        reverso.write('O24', '', item_reverso)
        reverso.write('O25', '', item_reverso)
        reverso.write('O26', '', item_reverso)
        reverso.write('O27', '', item_reverso)
        reverso.write('O28', '', item_reverso)
        reverso.write('O29', '', item_reverso)
        reverso.merge_range('P20:Q20', u'CÓDIGO', subtitulo_reverse)

        reverso.merge_range('R20:X20', 'NOMBRE', subtitulo_reverse)

        reverso.write('Y20', 'PR', subtitulo_reverse)
        reverso.write('Y21', '', item_reverso)
        reverso.write('Y22', '', item_reverso)
        reverso.write('Y23', '', item_reverso)
        reverso.write('Y24', '', item_reverso)
        reverso.write('Y25', '', item_reverso)
        reverso.write('Y26', '', item_reverso)
        reverso.write('Y27', '', item_reverso)
        reverso.write('Y28', '', item_reverso)
        reverso.write('Y29', '', item_reverso)
        reverso.write('Z20', 'CARACT', subtitulo_reverse)
        reverso.write('Z21', '', item_reverso)
        reverso.write('Z22', '', item_reverso)
        reverso.write('Z23', '', item_reverso)
        reverso.write('Z24', '', item_reverso)
        reverso.write('Z25', '', item_reverso)
        reverso.write('Z26', '', item_reverso)
        reverso.write('Z27', '', item_reverso)
        reverso.write('Z28', '', item_reverso)
        reverso.write('Z29', '', item_reverso)
        reverso.write('AA20', 'PRES', subtitulo_reverse)
        reverso.write('AA21', '', item_reverso)
        reverso.write('AA22', '', item_reverso)
        reverso.write('AA23', '', item_reverso)
        reverso.write('AA24', '', item_reverso)
        reverso.write('AA25', '', item_reverso)
        reverso.write('AA26', '', item_reverso)
        reverso.write('AA27', '', item_reverso)
        reverso.write('AA28', '', item_reverso)
        reverso.write('AA29', '', item_reverso)
        reverso.write('AB20', 'ENTR', subtitulo_reverse)
        reverso.write('AB21', '', item_reverso)
        reverso.write('AB22', '', item_reverso)
        reverso.write('AB23', '', item_reverso)
        reverso.write('AB24', '', item_reverso)
        reverso.write('AB25', '', item_reverso)
        reverso.write('AB26', '', item_reverso)
        reverso.write('AB27', '', item_reverso)
        reverso.write('AB28', '', item_reverso)
        reverso.write('AB29', '', item_reverso)
        reverso.write('AC20', 'DX', subtitulo_reverse)
        reverso.write('AC21', '', item_reverso)
        reverso.write('AC22', '', item_reverso)
        reverso.write('AC23', '', item_reverso)
        reverso.write('AC24', '', item_reverso)
        reverso.write('AC25', '', item_reverso)
        reverso.write('AC26', '', item_reverso)
        reverso.write('AC27', '', item_reverso)
        reverso.write('AC28', '', item_reverso)
        reverso.write('AC29', '', item_reverso)
        reverso.merge_range(
            'A30:AC30',
            u'PROCEDIMIENTOS/ DIAGNÓSTICO POR IMÁGENES/ LABORATORIO',
            titulo_reverse)
        reverso.merge_range('A31:B31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A32:B32', '', item_reverso)
        reverso.merge_range('A33:B33', '', item_reverso)
        reverso.merge_range('A34:B34', '', item_reverso)
        reverso.merge_range('A35:B35', '', item_reverso)
        reverso.merge_range('A36:B36', '', item_reverso)
        reverso.merge_range('A37:B37', '', item_reverso)
        reverso.merge_range('A38:B38', '', item_reverso)
        reverso.merge_range('A39:B39', '', item_reverso)
        reverso.merge_range('A40:B40', '', item_reverso)
        reverso.merge_range('A41:B41', '', item_reverso)
        reverso.merge_range('A42:B42', '', item_reverso)
        reverso.merge_range('C31:K31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C32:K32', '', item_reverso)
        reverso.merge_range('C33:K33', '', item_reverso)
        reverso.merge_range('C34:K34', '', item_reverso)
        reverso.merge_range('C35:K35', '', item_reverso)
        reverso.merge_range('C36:K36', '', item_reverso)
        reverso.merge_range('C37:K37', '', item_reverso)
        reverso.merge_range('C38:K38', '', item_reverso)
        reverso.merge_range('C39:K39', '', item_reverso)
        reverso.merge_range('C40:K40', '', item_reverso)
        reverso.merge_range('C41:K41', '', item_reverso)
        reverso.merge_range('C42:K42', '', item_reverso)
        reverso.write('L31', 'IND', subtitulo_reverse)
        reverso.write('L32', '', item_reverso)
        reverso.write('L33', '', item_reverso)
        reverso.write('L34', '', item_reverso)
        reverso.write('L35', '', item_reverso)
        reverso.write('L36', '', item_reverso)
        reverso.write('L37', '', item_reverso)
        reverso.write('L38', '', item_reverso)
        reverso.write('L39', '', item_reverso)
        reverso.write('L40', '', item_reverso)
        reverso.write('L41', '', item_reverso)
        reverso.write('L42', '', item_reverso)
        reverso.write('M31', 'EJE', subtitulo_reverse)
        reverso.write('M32', '', item_reverso)
        reverso.write('M33', '', item_reverso)
        reverso.write('M34', '', item_reverso)
        reverso.write('M35', '', item_reverso)
        reverso.write('M36', '', item_reverso)
        reverso.write('M37', '', item_reverso)
        reverso.write('M38', '', item_reverso)
        reverso.write('M39', '', item_reverso)
        reverso.write('M40', '', item_reverso)
        reverso.write('M41', '', item_reverso)
        reverso.write('M42', '', item_reverso)
        reverso.write('N31', 'DX', subtitulo_reverse)
        reverso.write('N32', '', item_reverso)
        reverso.write('N33', '', item_reverso)
        reverso.write('N34', '', item_reverso)
        reverso.write('N35', '', item_reverso)
        reverso.write('N36', '', item_reverso)
        reverso.write('N37', '', item_reverso)
        reverso.write('N38', '', item_reverso)
        reverso.write('N39', '', item_reverso)
        reverso.write('N40', '', item_reverso)
        reverso.write('N41', '', item_reverso)
        reverso.write('N42', '', item_reverso)
        reverso.write('O31', 'RES', subtitulo_reverse)
        reverso.write('O32', '', item_reverso)
        reverso.write('O33', '', item_reverso)
        reverso.write('O34', '', item_reverso)
        reverso.write('O35', '', item_reverso)
        reverso.write('O36', '', item_reverso)
        reverso.write('O37', '', item_reverso)
        reverso.write('O38', '', item_reverso)
        reverso.write('O39', '', item_reverso)
        reverso.write('O40', '', item_reverso)
        reverso.write('O41', '', item_reverso)
        reverso.write('O42', '', item_reverso)
        reverso.merge_range('P31:Q31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('P32:Q32', '', item_reverso)
        reverso.merge_range('P33:Q33', '', item_reverso)
        reverso.merge_range('P34:Q34', '', item_reverso)
        reverso.merge_range('P35:Q35', '', item_reverso)
        reverso.merge_range('P36:Q36', '', item_reverso)
        reverso.merge_range('P37:Q37', '', item_reverso)
        reverso.merge_range('P38:Q38', '', item_reverso)
        reverso.merge_range('P39:Q39', '', item_reverso)
        reverso.merge_range('P40:Q40', '', item_reverso)
        reverso.merge_range('P41:Q41', '', item_reverso)
        reverso.merge_range('P42:Q42', '', item_reverso)
        reverso.merge_range('R31:Y31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('R32:Y32', '', item_reverso)
        reverso.merge_range('R33:Y33', '', item_reverso)
        reverso.merge_range('R34:Y34', '', item_reverso)
        reverso.merge_range('R35:Y35', '', item_reverso)
        reverso.merge_range('R36:Y36', '', item_reverso)
        reverso.merge_range('R37:Y37', '', item_reverso)
        reverso.merge_range('R38:Y38', '', item_reverso)
        reverso.merge_range('R39:Y39', '', item_reverso)
        reverso.merge_range('R40:Y40', '', item_reverso)
        reverso.merge_range('R41:Y41', '', item_reverso)
        reverso.merge_range('R42:Y42', '', item_reverso)
        reverso.write('Z31', 'IND', subtitulo_reverse)
        reverso.write('Z32', '', item_reverso)
        reverso.write('Z33', '', item_reverso)
        reverso.write('Z34', '', item_reverso)
        reverso.write('Z35', '', item_reverso)
        reverso.write('Z36', '', item_reverso)
        reverso.write('Z37', '', item_reverso)
        reverso.write('Z38', '', item_reverso)
        reverso.write('Z39', '', item_reverso)
        reverso.write('Z40', '', item_reverso)
        reverso.write('Z41', '', item_reverso)
        reverso.write('Z42', '', item_reverso)
        reverso.write('AA31', 'EJE', subtitulo_reverse)
        reverso.write('AA32', '', item_reverso)
        reverso.write('AA33', '', item_reverso)
        reverso.write('AA34', '', item_reverso)
        reverso.write('AA35', '', item_reverso)
        reverso.write('AA36', '', item_reverso)
        reverso.write('AA37', '', item_reverso)
        reverso.write('AA38', '', item_reverso)
        reverso.write('AA39', '', item_reverso)
        reverso.write('AA40', '', item_reverso)
        reverso.write('AA41', '', item_reverso)
        reverso.write('AA42', '', item_reverso)
        reverso.write('AB31', 'DX', subtitulo_reverse)
        reverso.write('AB32', '', item_reverso)
        reverso.write('AB33', '', item_reverso)
        reverso.write('AB34', '', item_reverso)
        reverso.write('AB35', '', item_reverso)
        reverso.write('AB36', '', item_reverso)
        reverso.write('AB37', '', item_reverso)
        reverso.write('AB38', '', item_reverso)
        reverso.write('AB39', '', item_reverso)
        reverso.write('AB40', '', item_reverso)
        reverso.write('AB41', '', item_reverso)
        reverso.write('AB42', '', item_reverso)
        reverso.write('AC31', 'RES', subtitulo_reverse)
        reverso.write('AC32', '', item_reverso)
        reverso.write('AC33', '', item_reverso)
        reverso.write('AC34', '', item_reverso)
        reverso.write('AC35', '', item_reverso)
        reverso.write('AC36', '', item_reverso)
        reverso.write('AC37', '', item_reverso)
        reverso.write('AC38', '', item_reverso)
        reverso.write('AC39', '', item_reverso)
        reverso.write('AC40', '', item_reverso)
        reverso.write('AC41', '', item_reverso)
        reverso.write('AC42', '', item_reverso)
        reverso.merge_range(
            'A43:AC43', 'SUB COMPONENTE PRESTACIONAL (PROCEDIMIENTOS)',
            titulo_reverse)
        reverso.merge_range('A44:B45', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A46:B46', '', item_reverso)
        reverso.merge_range('A47:B47', '', item_reverso)
        reverso.merge_range('A48:B48', '', item_reverso)
        reverso.merge_range('A49:B49', '', item_reverso)
        reverso.merge_range('A50:B50', '', item_reverso)
        reverso.merge_range('C44:M45', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C46:M46', '', item_reverso)
        reverso.merge_range('C47:M47', '', item_reverso)
        reverso.merge_range('C48:M48', '', item_reverso)
        reverso.merge_range('C49:M49', '', item_reverso)
        reverso.merge_range('C50:M50', '', item_reverso)
        reverso.merge_range('N44:Q45', 'CARACT', subtitulo_reverse)
        reverso.merge_range('N46:Q46', '', item_reverso)
        reverso.merge_range('N47:Q47', '', item_reverso)
        reverso.merge_range('N48:Q48', '', item_reverso)
        reverso.merge_range('N49:Q49', '', item_reverso)
        reverso.merge_range('N50:Q50', '', item_reverso)
        reverso.merge_range('R44:T45', 'IND/ PRES', subtitulo_reverse)
        reverso.merge_range('R46:T46', '', item_reverso)
        reverso.merge_range('R47:T47', '', item_reverso)
        reverso.merge_range('R48:T48', '', item_reverso)
        reverso.merge_range('R49:T49', '', item_reverso)
        reverso.merge_range('R50:T50', '', item_reverso)
        reverso.merge_range('U44:W45', 'EJE/ ENTR', subtitulo_reverse)
        reverso.merge_range('U46:W46', '', item_reverso)
        reverso.merge_range('U47:W47', '', item_reverso)
        reverso.merge_range('U48:W48', '', item_reverso)
        reverso.merge_range('U49:W49', '', item_reverso)
        reverso.merge_range('U50:W50', '', item_reverso)
        reverso.merge_range('X44:Y45', 'DX', subtitulo_reverse)
        reverso.merge_range('X46:Y46', '', item_reverso)
        reverso.merge_range('X47:Y47', '', item_reverso)
        reverso.merge_range('X48:Y48', '', item_reverso)
        reverso.merge_range('X49:Y49', '', item_reverso)
        reverso.merge_range('X50:Y50', '', item_reverso)
        reverso.merge_range('Z44:Z45', 'RES', subtitulo_reverse)
        reverso.write('Z46', '', item_reverso)
        reverso.write('Z47', '', item_reverso)
        reverso.write('Z48', '', item_reverso)
        reverso.write('Z49', '', item_reverso)
        reverso.write('Z50', '', item_reverso)
        reverso.merge_range('AA44:AA45', u'N° TICKET', subtitulo_reverse)
        reverso.write('AA46', '', item_reverso)
        reverso.write('AA47', '', item_reverso)
        reverso.write('AA48', '', item_reverso)
        reverso.write('AA49', '', item_reverso)
        reverso.write('AA50', '', item_reverso)
        reverso.merge_range('AB44:AC45', 'PO', subtitulo_reverse)
        reverso.merge_range('AB46:AC46', '', item_reverso)
        reverso.merge_range('AB47:AC47', '', item_reverso)
        reverso.merge_range('AB48:AC48', '', item_reverso)
        reverso.merge_range('AB49:AC49', '', item_reverso)
        reverso.merge_range('AB50:AC50', '', item_reverso)
        reverso.merge_range('A51:AC51', 'OBSERVACIONES', subtitulo_reverse)
        reverso.merge_range('A52:AC53', '', item_reverso)
        reverso.merge_range('A54:AC55', '', item_reverso)
        reverso.merge_range('A56:AC57', '', item_reverso)
        reverso.merge_range('A58:AC59', '', item_reverso)
        reverso.merge_range(
            'B70:K71', '/'.join([
                'Firma y Sello del Responsable de Procedimiento y',
                'o Farmacia y', 'o Laboratorio']), firma_reverso)
        reverso.merge_range('R61:V69', '', item_16)
        reverso.merge_range(
            'R70:V71', 'Huella Digital del Asegurado o del Apoderado', firma_reverso)

        workbook.close()
        return workbook


class Fua024ExcelReport(FuaBase):
    def get_book(self, output):
        workbook = xlsxwriter.Workbook(output)
        worksheet = workbook.add_worksheet('FUA024')
        worksheet.fit_to_pages(1, 1)
        worksheet.set_portrait()

        self.set_front_columns_dimension(worksheet)
        self.set_front_row_dimension(worksheet)

        section_format = workbook.add_format()
        self.bold_pattern_common(section_format)
        section_format.set_bg_color('#CCCCCC')
        section_format.set_font_size(11)

        subsection_format = workbook.add_format()
        self.bold_pattern_common(subsection_format)
        subsection_format.set_bg_color('#F2F2F2')
        subsection_format.set_font_size(10)

        item_16 = workbook.add_format()
        self.bold_common(item_16)
        item_16.set_font_size(16)

        check_format = workbook.add_format()
        self.bold_common(check_format)
        check_format.set_font_size(20)

        label_item = workbook.add_format()
        self.pattern_common(label_item)
        label_item.set_bg_color('#F2F2F2')
        label_item.set_font_size(9)

        item_section = workbook.add_format()
        self.common_formats(item_section)
        item_section.set_font_size(9)

        item_rotated = workbook.add_format()
        self.bold_pattern_common(item_rotated)
        item_rotated.set_bg_color('#F2F2F2')
        item_rotated.set_font_size(10)
        item_rotated.set_rotation(90)

        superscript = workbook.add_format({'font_script': 1})

        formato_leyenda = workbook.add_format()
        self.common_formats(formato_leyenda)
        formato_leyenda.set_font_size(7)

        formato_leyenda_8 = workbook.add_format()
        self.common_formats(formato_leyenda_8)
        formato_leyenda_8.set_font_size(8)

        responsable_formato = workbook.add_format()
        responsable_formato.set_align('vcenter')
        responsable_formato.set_bold()
        responsable_formato.set_font_name('Arial')
        responsable_formato.set_font_size(11)

        subrayado = workbook.add_format()
        subrayado.set_bottom(1)

        today = timezone.now()

        worksheet.insert_image(
            'A1', settings.STATIC_ROOT + '/img/minsa_logo.png',
            {'x_scale': 0.65, 'y_scale': 0.85})
        worksheet.merge_range('A1:BM4', '')
        worksheet.merge_range(
            'A5:BM5', u'FORMATO ÚNICO DE ATENCIÓN - FUA', section_format)
        worksheet.merge_range('R6:AO6', u'NÚMERO DE FORMATO', section_format)
        worksheet.merge_range(
            'R7:W8', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('X7:AA8', str(today.year)[2:], item_16)
        worksheet.merge_range('AB7:AO8', '', item_16)
        worksheet.merge_range(
            'AR6:BH6', u'INSTITUCIÓN EDUCATIVA', section_format)
        worksheet.merge_range('AR7:BH7', '', item_section)
        worksheet.merge_range('AR8:AT8', 'INIC.', subsection_format)
        worksheet.merge_range('AU8:AX8', 'PRIM.', subsection_format)
        worksheet.merge_range('AY8:AZ8', 'SEC.', subsection_format)
        worksheet.merge_range('BA8:BC8', '', item_section)
        worksheet.merge_range('BD8:BF8', u'SECCIÓN', subsection_format)
        worksheet.merge_range('BG8:BH8', '', item_section)
        worksheet.merge_range('BI6:BM6', u'CÓDIGO', section_format)
        worksheet.merge_range('BI7:BM7', '', item_section)
        worksheet.merge_range('BI8:BK8', 'TURNO', subsection_format)
        worksheet.merge_range('BL8:BM8', '', item_section)
        worksheet.merge_range(
            'A10:BM10', u'DE LA INSTITUCIÓN PRESTADORA DE SERVICIOS DE SALUD',
            section_format)
        worksheet.merge_range(
            'A11:S12', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range(
            'A13:S13', self.control.establecimiento.codigo, item_16)
        worksheet.merge_range(
            'T11:BM12', u'NOMBRE  DE LA IPRESS QUE REALIZA LA ATENCIÓN',
            subsection_format)
        worksheet.merge_range(
            'T13:BM13', self.control.establecimiento.nombre, item_16)
        worksheet.merge_range(
            'A15:S15', 'PERSONAL QUE ATIENDE', subsection_format)
        worksheet.merge_range(
            'T15:AB15', u'LUGAR DE ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AC15:AL15', u'ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AM15:BM15', 'REFERENCIA REALIZADA POR', subsection_format)
        worksheet.merge_range('A16:E17', 'DE LA IPRESS', label_item)
        worksheet.merge_range('A18:E18', 'ITINERANTE', label_item)
        worksheet.merge_range('A19:E19', 'OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'I16:S17', u'CÓDIGO DE LA OFERTA FLEXIBLE', label_item)
        worksheet.merge_range('F16:H17', 'X', check_format)
        worksheet.merge_range('F18:H18', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('I18:S19', '', check_format)
        worksheet.merge_range('T16:Z17', 'INTRAMURAL', label_item)
        worksheet.merge_range('T18:Z18', 'EXTRAMURAL', label_item)
        worksheet.merge_range('AA16:AB17', 'X', check_format)
        worksheet.merge_range('AA18:AB18', '', check_format)
        worksheet.merge_range('T19:AB19', '')
        worksheet.merge_range('AC16:AI17', 'AMBULATORIA', label_item)
        worksheet.merge_range('AC18:AI18', 'REFERENCIA', label_item)
        worksheet.merge_range('AC19:AI19', 'EMERGENCIA', label_item)
        worksheet.merge_range('AJ16:AL17', 'X', check_format)
        worksheet.merge_range('AJ18:AL18', '', check_format)
        worksheet.merge_range('AJ19:AL19', '', check_format)
        worksheet.merge_range('AM16:AT17', u'CÓD. RENAES', label_item)
        worksheet.merge_range(
            'AU16:BI17', u'NOMBRE DE LA IPRESS U OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'BJ16:BM17', u'N° HOJA DE REFERENCIA', label_item)
        worksheet.merge_range('AM18:AT19', '', item_16)
        worksheet.merge_range('AU18:BI19', '', item_16)
        worksheet.merge_range('BJ18:BM19', '', item_16)
        worksheet.merge_range(
            'A21:BM21', 'DEL ASEGURADO / USUARIO', section_format)
        worksheet.merge_range(
            'A22:O22', u'IDENTIFICACIÓN', subsection_format)
        worksheet.merge_range('A23:B24', 'TDI', label_item)
        worksheet.merge_range('A25:B25', '1', item_16)
        worksheet.merge_range(
            'C23:O24', u'N° DOCUMENTO DE IDENTIDAD', label_item)
        worksheet.merge_range(
            'C25:O25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'Q22:AI22', u'CÓDIGO DEL ASEGURADO SIS', subsection_format)
        worksheet.merge_range('Q23:V24', 'DIRESA / OTROS', label_item)
        worksheet.merge_range(
            'Q25:V25', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('W23:AI24', u'NÚMERO', label_item)
        worksheet.merge_range('W25:Y25', '2', item_16)
        worksheet.merge_range(
            'Z25:AI25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'AK22:BM22', 'ASEGURADO DE OTRA IAFAS', subsection_format)
        worksheet.merge_range('AK23:AP24', u'INSTITUCIÓN', label_item)
        worksheet.merge_range('AQ23:BM24', '', item_16)
        worksheet.merge_range('AK25:AP25', 'COD. SEGURO', label_item)
        worksheet.merge_range('AQ25:BM25', '', item_16)
        worksheet.merge_range(
            'A27:AI27', 'APELLIDO PATERNO', subsection_format)
        worksheet.merge_range(
            'A28:AI28', self.control.paciente.apellido_paterno, item_16)
        worksheet.merge_range(
            'AK27:BM27', 'APELLIDO MATERNO', subsection_format)
        worksheet.merge_range(
            'AK28:BM28', self.control.paciente.apellido_materno, item_16)

        nombres = self.control.paciente.nombres.split(' ')
        otros_nombres = ''
        try:
            otros_nombres += nombres[1]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[2]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[3]
        except Exception as e:
            print
            str(e)

        worksheet.merge_range('A30:AI30', 'PRIMER NOMBRE', subsection_format)
        worksheet.merge_range('A31:AI31', nombres[0], item_16)
        worksheet.merge_range('AK30:BM30', 'OTROS NOMBRES', subsection_format)
        worksheet.merge_range('AK31:BM31', otros_nombres, item_16)
        worksheet.merge_range('A33:G34', 'SEXO', subsection_format)
        worksheet.merge_range('A35:D35', 'MASCULINO', item_section)
        worksheet.merge_range('E35:G35', '', check_format)
        worksheet.merge_range('A36:D36', 'FEMENINO', item_section)
        worksheet.merge_range('E36:G36', 'X', check_format)
        worksheet.merge_range('A38:G40', 'SALUD MATERNA', subsection_format)
        worksheet.merge_range('A42:D46', 'GESTANTE', item_section)
        worksheet.merge_range('E42:G46', 'X', check_format)
        worksheet.merge_range('A47:D47', 'PUERPERA', item_section)
        worksheet.merge_range('E47:G47', '', check_format)
        worksheet.merge_range('I33:Q34', 'FECHA', subsection_format)
        worksheet.merge_range(
            'I35:Q36', 'FECHA PROBABLE DE PARTO / FECHA DE PARTO',
            item_section)
        worksheet.merge_range('I38:Q42', 'FECHA DE NACIMIENTO ', item_section)
        worksheet.merge_range(
            'I45:Q47', 'FECHA DE FALLECIMIENTO', item_section)

        fecha_nacimiento = self.control.paciente.fecha_nacimiento

        if fecha_nacimiento.day / 10 < 1:
            nacimiento_dia = '0' + str(fecha_nacimiento.day)
        else:
            nacimiento_dia = str(fecha_nacimiento.day)

        if fecha_nacimiento.month / 10 < 1:
            nacimiento_mes = '0' + str(fecha_nacimiento.month)
        else:
            nacimiento_mes = str(fecha_nacimiento.month)

        nacimiento_anio = str(fecha_nacimiento.year)

        fecha_probable_parto = self.control.fecha_probable_parto

        if fecha_probable_parto.month / 10 < 1:
            parto_mes = '0' + str(fecha_probable_parto.month)
        else:
            parto_mes = str(fecha_probable_parto.month)

        if fecha_probable_parto.day / 10 < 1:
            parto_dia = '0' + str(fecha_probable_parto.day)
        else:
            parto_dia = str(fecha_probable_parto.day)

        parto_anio = str(fecha_probable_parto.year)

        worksheet.merge_range('R33:X34', 'DIA', subsection_format)
        worksheet.merge_range('R35:U36', parto_dia[0], item_16)
        worksheet.merge_range('V35:X36', parto_dia[1], item_16)
        worksheet.merge_range('R38:U42', nacimiento_dia[0], item_16)
        worksheet.merge_range('V38:X42', nacimiento_dia[1], item_16)
        worksheet.merge_range('R45:U47', '', item_16)
        worksheet.merge_range('V45:X47', '', item_16)
        worksheet.merge_range('Y33:AD34', 'MES', subsection_format)
        worksheet.merge_range('Y35:Z36', parto_mes[0], item_16)
        worksheet.merge_range('AA35:AD36', parto_mes[1], item_16)
        worksheet.merge_range('Y38:Z42', nacimiento_mes[0], item_16)
        worksheet.merge_range('AA38:AD42', nacimiento_mes[1], item_16)
        worksheet.merge_range('Y45:Z47', '', item_16)
        worksheet.merge_range('AA45:AD47', '', item_16)
        worksheet.merge_range('AE33:AP34', u'AÑO', subsection_format)
        worksheet.merge_range('AE35:AG36', parto_anio[0], item_16)
        worksheet.merge_range('AH35:AJ36', parto_anio[1], item_16)
        worksheet.merge_range('AK35:AN36', parto_anio[2], item_16)
        worksheet.merge_range('AO35:AP36', parto_anio[3], item_16)
        worksheet.merge_range('AE38:AG42', nacimiento_anio[0], item_16)
        worksheet.merge_range('AH38:AJ42', nacimiento_anio[1], item_16)
        worksheet.merge_range('AK38:AN42', nacimiento_anio[2], item_16)
        worksheet.merge_range('AO38:AP42', nacimiento_anio[3], item_16)
        worksheet.merge_range('AE45:AG47', '', item_16)
        worksheet.merge_range('AH45:AJ47', '', item_16)
        worksheet.merge_range('AK45:AN47', '', item_16)
        worksheet.merge_range('AO45:AP47', '', item_16)
        worksheet.merge_range(
            'AR33:BD34', u'N° DE HISTORIA CLÍNICA', subsection_format)
        worksheet.merge_range(
            'AR35:BD36',
            self.control.paciente.historias_clinicas.last().numero, item_16)
        worksheet.merge_range('BF33:BM34', 'ETNIA', subsection_format)
        worksheet.merge_range('BF35:BM36', self.control.paciente.etnia_nombre, item_16)
        worksheet.merge_range(
            'AR38:BG39', u'DNI / CNV / AFILIACIÓN DEL RN 1', item_section)
        worksheet.merge_range('BH38:BM39', '', item_16)
        worksheet.merge_range(
            'AR42:BG45', u'DNI / CNV / AFILIACIÓN DEL RN 2', item_section)
        worksheet.merge_range('BH42:BM45', '', item_16)
        worksheet.merge_range(
            'AR47:BG47', u'DNI / CNV / AFILIACIÓN DEL RN 3', item_section)
        worksheet.merge_range('BH47:BM47', '', item_16)
        worksheet.merge_range('A49:BM49', u'DE LA ATENCIÓN', section_format)
        worksheet.merge_range(
            'A51:R51', u'FECHA DE ATENCIÓN', subsection_format)

        atencion_fecha = self.control.atencion_fecha

        if atencion_fecha.day / 10 < 1:
            atencion_dia = '0' + str(atencion_fecha.day)
        else:
            atencion_dia = str(atencion_fecha.day)

        if atencion_fecha.month / 10 < 1:
            atencion_mes = '0' + str(atencion_fecha.month)
        else:
            atencion_mes = str(atencion_fecha.month)

        atencion_anio = str(atencion_fecha.year)

        worksheet.merge_range('A52:B53', 'DIA', item_section)
        worksheet.merge_range('A54:A58', atencion_dia[0], item_16)
        worksheet.merge_range('B54:B58', atencion_dia[1], item_16)
        worksheet.merge_range('C52:F53', 'MES', item_section)
        worksheet.merge_range('C54:C58', atencion_mes[0], item_16)
        worksheet.merge_range('D54:F58', atencion_mes[1], item_16)
        worksheet.merge_range('G52:R53', u'AÑO', item_section)
        worksheet.merge_range('G54:K58', atencion_anio[0], item_16)
        worksheet.merge_range('L54:M58', atencion_anio[1], item_16)
        worksheet.merge_range('N54:O58', atencion_anio[2], item_16)
        worksheet.merge_range('P54:R58', atencion_anio[3], item_16)

        atencion_tiempo = self.control.atencion_hora

        worksheet.merge_range('T51:Y52', 'HORA', subsection_format)
        worksheet.merge_range('T53:W58', str(atencion_tiempo.hour), item_16)
        worksheet.merge_range('X53:X58', ':', item_16)
        worksheet.merge_range('Y53:Y58', str(atencion_tiempo.minute), item_16)
        worksheet.merge_range(
            'A61:K62', 'REPORTE VINCULADO', subsection_format)
        worksheet.merge_range(
            'L61:Y61', u'CÓD. AUTORIZACIÓN', subsection_format)
        worksheet.merge_range('L62:Y62', '', item_16)
        worksheet.merge_range('AA51:AE52', 'UPS', subsection_format)
        worksheet.merge_range('AA53:AE58', '', check_format)
        worksheet.merge_range('AG51:AI52', u'CÓD. PRESTA.', subsection_format)
        worksheet.merge_range('AG53:AI58', '024', item_16)
        worksheet.merge_range(
            'AK51:AT52', u'CÓD. PRESTACION(ES) ADICIONAL (ES)',
            subsection_format)
        worksheet.merge_range('AK53:AT58', '', item_16)
        worksheet.merge_range(
            'AA61:AT61', u'N° FUA A VINCULAR', subsection_format)
        worksheet.merge_range('AA62:AT62', '', item_16)
        worksheet.merge_range('AW51:AY62', u'HOSPITALIZACIÓN', item_rotated)
        worksheet.merge_range('AZ51:BE51', 'FECHA', subsection_format)
        worksheet.merge_range('AZ52:BE54', 'DE INGRESO', item_section)
        worksheet.merge_range('AZ56:BE59', 'DE ALTA', item_section)
        worksheet.merge_range(
            'AZ61:BE62', 'DE CORTE ADMINISTRATIVO', item_section)
        worksheet.merge_range('BF51:BG51', 'DIA', subsection_format)
        worksheet.merge_range('BF52:BF54', '', item_16)
        worksheet.merge_range('BG52:BG54', '', item_16)
        worksheet.merge_range('BF56:BF59', '', item_16)
        worksheet.merge_range('BG56:BG59', '', item_16)
        worksheet.merge_range('BF61:BF62', '', item_16)
        worksheet.merge_range('BG61:BG62', '', item_16)
        worksheet.merge_range('BH51:BI51', 'MES', subsection_format)
        worksheet.merge_range('BH52:BH54', '', item_16)
        worksheet.merge_range('BI52:BI54', '', item_16)
        worksheet.merge_range('BH56:BH59', '', item_16)
        worksheet.merge_range('BI56:BI59', '', item_16)
        worksheet.merge_range('BH61:BH62', '', item_16)
        worksheet.merge_range('BI61:BI62', '', item_16)
        worksheet.merge_range('BJ51:BM51', u'AÑO', subsection_format)
        worksheet.merge_range('BJ52:BJ54', '', item_16)
        worksheet.merge_range('BK52:BK54', '', item_16)
        worksheet.merge_range('BL52:BL54', '', item_16)
        worksheet.merge_range('BM52:BM54', '', item_16)
        worksheet.merge_range('BJ56:BJ59', '', item_16)
        worksheet.merge_range('BK56:BK59', '', item_16)
        worksheet.merge_range('BL56:BL59', '', item_16)
        worksheet.merge_range('BM56:BM59', '', item_16)
        worksheet.merge_range('BJ61:BJ62', '', item_16)
        worksheet.merge_range('BK61:BK62', '', item_16)
        worksheet.merge_range('BL61:BL62', '', item_16)
        worksheet.merge_range('BM61:BM62', '', item_16)
        worksheet.merge_range(
            'A64:BM64', 'CONCEPTO PRESTACIONAL', section_format)
        worksheet.merge_range(
            'A65:C67', u'ATENCIÓN DIRECTA', subsection_format)
        worksheet.merge_range('D65:F67', 'X', check_format)
        worksheet.merge_range(
            'G65:X65', 'COB EXTRAORDINARIA', subsection_format)
        worksheet.merge_range('G66:O66', u'Nº Autorización', label_item)
        worksheet.merge_range('P66:X66', '', item_16)
        worksheet.merge_range('G67:N67', 'Monto S/.', label_item)
        worksheet.merge_range('O67:X67', '', item_16)
        worksheet.merge_range(
            'Y65:AK65', 'CARTA DE GARANTIA', subsection_format)
        worksheet.merge_range('Y66:AE66', u'Nº Autorización', label_item)
        worksheet.merge_range('AF66:AK66', '', item_16)
        worksheet.merge_range('Y67:AD67', 'Monto S/.', label_item)
        worksheet.merge_range('AE67:AK67', '', item_16)
        worksheet.merge_range('AL65:AQ67', 'TRASLADO', section_format)
        worksheet.merge_range('AR65:AS67', '', item_16)
        worksheet.merge_range('AT65:BM65', 'SEPELIO', subsection_format)
        worksheet.merge_range('AT66:BA67', 'NATIMUERTO', subsection_format)
        worksheet.merge_range('BB66:BD67', '', item_16)
        worksheet.merge_range('BE66:BG67', 'OBITO', subsection_format)
        worksheet.merge_range('BH66:BI67', '', item_16)
        worksheet.merge_range('BJ66:BK67', 'OTRO', subsection_format)
        worksheet.merge_range('BL66:BM67', '', item_16)
        worksheet.merge_range(
            'A69:BM69', 'DEL DESTINO DEL ASEGURADO/USUARIO', section_format)
        worksheet.merge_range('A70:A71', 'ALTA', label_item)
        worksheet.merge_range('B70:B71', '', item_16)
        worksheet.merge_range('C70:F71', 'CITA', label_item)
        worksheet.merge_range('G70:K71', 'X', check_format)
        worksheet.merge_range('L70:Q71', u'HOSPITALIZACIÓN', label_item)
        worksheet.merge_range('R70:S71', '', item_16)
        worksheet.merge_range('T70:AW70', 'REFERIDO', subsection_format)
        worksheet.merge_range('T71:Y71', 'EMERGENCIA', label_item)
        worksheet.merge_range('Z71:AA71', '', check_format)
        worksheet.merge_range('AB71:AI71', 'CONSULTA EXTERNA', label_item)
        worksheet.merge_range('AJ71:AL71', '', check_format)
        worksheet.merge_range('AM71:AT71', u'APOYO AL DIAGNÓSTICO', label_item)
        worksheet.merge_range('AU71:AW71', '', check_format)
        worksheet.merge_range('AX70:BC71', 'CONTRA REFERIDO', label_item)
        worksheet.merge_range('BD70:BD71', '', check_format)
        worksheet.merge_range('BE70:BH71', 'FALLECIDO', label_item)
        worksheet.merge_range('BI70:BI71', '', check_format)
        worksheet.merge_range('BJ70:BK71', 'CORTE ADMINIS.', label_item)
        worksheet.merge_range('BL70:BM71', '', check_format)
        worksheet.merge_range(
            'A73:BM73', 'SE REFIERE / CONTRARREFIERE A:', section_format)
        worksheet.merge_range(
            'A74:M74', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range('A75:M75', '', item_16)
        worksheet.merge_range(
            'N74:BC74',
            'NOMBRE DE LA IPRESS A LA QUE SE REFIERE / CONTRARREFIERE',
            subsection_format)
        worksheet.merge_range('N75:BC75', '', item_16)
        worksheet.merge_range(
            'BD74:BM74', u'N° HOJA DE REFER / CONTRARR.', subsection_format)
        worksheet.merge_range('BD75:BM75', '', item_16)
        worksheet.merge_range(
            'A77:AR77', 'ACTIVIDADES PREVENTIVAS Y OTROS', section_format)
        worksheet.merge_range('A78:I78', 'PESO (Kg)', subsection_format)
        worksheet.merge_range('J78:N78', self.control.peso, item_16)
        worksheet.merge_range('O78:X78', 'TALLA (cm)', subsection_format)
        worksheet.merge_range('Y78:AB78', self.control.embarazo.talla, item_16)
        worksheet.merge_range('AC78:AM78', 'P.A. (mmHg)', subsection_format)
        worksheet.merge_range(
            'AN78:AR78', self.control.presion_arterial, item_16)
        worksheet.merge_range('A79:D79', 'DE LA GESTANTE', subsection_format)
        worksheet.merge_range('A80:B82', u'CPN (N°)', item_section)
        worksheet.merge_range('C80:D82', '', item_16)
        worksheet.merge_range('A83:B84', 'EDAD GEST', item_section)
        worksheet.merge_range(
            'C83:D84', str(self.control.calculate_edad_gestacional_semanas()),
            item_16)
        worksheet.merge_range('A85:B86', 'ALTURA UTERINA', item_section)
        worksheet.merge_range('C85:D86', '', item_16)
        worksheet.merge_range('A87:B88', 'PARTO VERTICAL', item_section)
        worksheet.merge_range('C87:D88', '', item_16)
        worksheet.merge_range('A89:B90', u'CONTROL PUERP (N°)', item_section)
        worksheet.merge_range('C89:D90', '', item_16)
        worksheet.merge_range(
            'F79:Q79', 'DEL RECIEN NACIDO', subsection_format)
        worksheet.merge_range('F80:N81', 'EDAD GEST RN (SEM)', item_section)
        worksheet.merge_range('O80:Q81', '', item_16)
        worksheet.merge_range('F83:K85', 'APGAR', item_section)
        worksheet.merge_range('L83:L85', u'1°', item_section)
        worksheet.merge_range('M83:M85', '', item_section)
        worksheet.merge_range('N83:N85', u'5°', item_section)
        worksheet.merge_range('O83:Q85', '', item_section)
        worksheet.merge_range(
            'F87:N88', u'Corte Tardío de Cordón (2 a 3 min)', item_section)
        worksheet.merge_range('O87:Q88', '', item_16)
        worksheet.merge_range('F90:P90', '3', item_section)
        worksheet.merge_range(
            'S79:AK79', u' / '.join([
                'GESTANTE', 'RN', u'NIÑO', 'ADOLESCENTE', 'JOVEN Y ADULTO',
                'ADULTO MAYOR']), subsection_format)
        worksheet.merge_range('S80:Z81', u'CRED N°', item_section)
        worksheet.merge_range('AA80:AA81', '', check_format)
        worksheet.merge_range('S83:Z83', 'R.N. PREMATURO', item_section)
        worksheet.write('AA83', '', check_format)
        worksheet.merge_range('S85:Z85', 'BAJO PESO AL NACER', item_section)
        worksheet.write('AA85', '', check_format)
        worksheet.merge_range(
            'S87:Z88', 'ENFER. CONGENITA / SECUELA AL NACER', item_section)
        worksheet.merge_range('AA87:AA88', '', check_format)
        worksheet.merge_range(
            'S90:Z90', u'N° FAMILIARES DE GEST / PUERP. CASA MAT.',
            item_section)
        worksheet.write('AA90', '', check_format)
        worksheet.merge_range('AC80:AG81', 'PAB (cm)', item_section)
        worksheet.merge_range('AH80:AK81', '', item_16)
        worksheet.merge_range('AC83:AH83', 'TAP / EEDP o TEPSI', item_section)
        worksheet.merge_range('AI83:AK83', '', item_16)
        worksheet.merge_range(
            'AC85:AH85', 'CONSEJERIA NUTRICIONAL', item_section)
        worksheet.merge_range('AI85:AK85', '', item_16)
        worksheet.merge_range('AC87:AH88', 'CONSEJERIA INTEGRAL', item_section)
        worksheet.merge_range('AI87:AK88', 'X', item_16)
        worksheet.merge_range('AC90:AH90', '', item_section)
        worksheet.write_rich_string(
            'AC90', label_item, 'IMC (Kg/M', superscript, '2', label_item,
            ')', item_section)
        worksheet.merge_range('AI90:AK90', self.control.imc, item_16)
        worksheet.merge_range('AM79:AR79', 'JOVEN Y ADULTO', label_item)
        worksheet.merge_range(
            'AM80:AP81', u'EVALUACIÓN INTEGRAL', item_section)
        worksheet.merge_range('AQ80:AR81', '', item_16)
        worksheet.merge_range('AM83:AR83', 'ADULTO MAYOR', label_item)
        worksheet.merge_range('AM84:AP85', 'VACAM', item_section)
        worksheet.merge_range('AQ84:AR85', '', item_16)
        worksheet.merge_range(
            'AM87:AP88', 'TAMIZAJE DE SALUD MENTAL', item_section)
        worksheet.merge_range('AQ87:AR87', 'PAT.', item_section)
        worksheet.merge_range('AQ88:AR88', 'NOR.', item_section)
        worksheet.merge_range('AM90:AR90', '', item_16)
        worksheet.merge_range(
            'AT77:BM77', u'VACUNAS N° DE DOSIS', section_format)
        worksheet.merge_range('AT78:AY78', 'BCG', item_section)
        worksheet.merge_range('AZ78:BB78', '', item_16)
        worksheet.merge_range('AT79:AY80', 'DPT', item_section)
        worksheet.merge_range('AZ79:BB80', '', item_16)
        worksheet.merge_range('AT81:AY82', 'APO', item_section)
        worksheet.merge_range('AZ81:BB82', '', item_16)
        worksheet.merge_range('AT83:AY84', 'ASA', item_section)
        worksheet.merge_range('AZ83:BB84', '', item_16)
        worksheet.merge_range('AT85:AY85', 'SPR', item_section)
        worksheet.merge_range('AZ85:BB85', '', item_16)
        worksheet.merge_range('AT86:AY87', 'SR', item_section)
        worksheet.merge_range('AZ86:BB87', '', item_16)
        worksheet.merge_range('AT88:AY89', 'HVB', item_section)
        worksheet.merge_range('AZ88:BB89', '', item_16)
        worksheet.merge_range('BC78:BF78', 'INFLUENZA', item_section)
        worksheet.merge_range('BG78:BH78', '', item_16)
        worksheet.merge_range('BC79:BF80', 'PAROTID', item_section)
        worksheet.merge_range('BG79:BH80', '', item_16)
        worksheet.merge_range('BC81:BF82', 'RUBEOLA', item_section)
        worksheet.merge_range('BG81:BH82', '', item_16)
        worksheet.merge_range('BC83:BF84', 'ROTAVIRUS', item_section)
        worksheet.merge_range('BG83:BH84', '', item_16)
        worksheet.merge_range(
            'BC85:BF85', u'DT ADULTO (N° DOSIS)', item_section)
        worksheet.merge_range('BG85:BH85', '', item_16)
        worksheet.merge_range('BC86:BF87', 'IPV', item_section)
        worksheet.merge_range('BG86:BH87', '', item_16)
        worksheet.merge_range('BC88:BF89', 'PENTAVAL', item_section)
        worksheet.merge_range('BG88:BH89', '', item_16)
        worksheet.merge_range('BI78:BK78', 'ANTIAMARILICA', item_section)
        worksheet.merge_range('BL78:BM78', '', item_16)
        worksheet.merge_range('BI79:BK80', 'ANTINEUMOC', item_section)
        worksheet.merge_range('BL79:BM80', '', item_16)
        worksheet.merge_range('BI81:BK82', 'ANTITETANICA', item_section)
        worksheet.merge_range('BL81:BM82', '', item_16)
        worksheet.merge_range(
            'BI83:BK84', ' COMPLETAS PARA LA EDAD', item_section)
        worksheet.merge_range('BL83:BL84', 'SI', item_section)
        worksheet.merge_range('BM83:BM84', 'NO', item_section)
        worksheet.merge_range('BI85:BK85', 'VPH', item_section)
        worksheet.merge_range('BL85:BM85', '', item_16)
        worksheet.merge_range('BI86:BK87', 'OTRA VACUNA', item_section)
        worksheet.merge_range('BL86:BM87', '', item_16)
        worksheet.merge_range('BI88:BK89', '____________', item_section)
        worksheet.merge_range('BL88:BM89', '', item_16)
        worksheet.merge_range('AT90:AZ90', 'GRUPO DE RIESGO HVB', item_section)
        worksheet.merge_range('BA90:BC90', '', item_16)
        worksheet.merge_range('BD90:BM90', '   '.join([
            'GRUPO DE RIESGO HVB: 1. TRABAJADOR DE SALUD',
            '2. TRABAJAD. SEXUALES', '3. HSH', '4. PRIVADO LIBERTAD',
            '5. FF. AA.', '6. POLICIA NACIONAL', '7. ESTUDIANTES DE SALUD',
            '8. POLITRANFUNDIDOS', '9. DROGO DEPENDIENTES ']), formato_leyenda)
        worksheet.merge_range('A93:BM93', '10', section_format)
        worksheet.merge_range('A94:A95', u'N°', subsection_format)
        worksheet.write('A96', '1', item_section)
        worksheet.write('A97', '2', item_section)
        worksheet.write('A98', '3', item_section)
        worksheet.write('A99', '4', item_section)
        worksheet.write('A100', '5', item_section)
        worksheet.merge_range('B94:AN95', u'DESCRIPCIÓN', subsection_format)
        worksheet.merge_range(
            'B96:AN96', 'EXAMEN GINECOLOGICO (GENERAL) (DE RUTINA)',
            item_section)
        worksheet.merge_range('B97:AN97', '', item_section)
        worksheet.merge_range('B98:AN98', '', item_section)
        worksheet.merge_range('B99:AN99', '', item_section)
        worksheet.merge_range('B100:AN100', '', item_section)
        worksheet.merge_range('AO94:BD94', 'INGRESO', subsection_format)
        worksheet.merge_range('AO95:AW95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('AO96:AP96', 'P', item_section)
        worksheet.merge_range('AQ96:AS96', 'X', item_16)
        worksheet.merge_range('AT96:AW96', 'R', item_section)
        worksheet.merge_range('AO97:AP97', 'P', item_section)
        worksheet.merge_range('AQ97:AS97', 'D', item_section)
        worksheet.merge_range('AT97:AW97', 'R', item_section)
        worksheet.merge_range('AO98:AP98', 'P', item_section)
        worksheet.merge_range('AQ98:AS98', 'D', item_section)
        worksheet.merge_range('AT98:AW98', 'R', item_section)
        worksheet.merge_range('AO99:AP99', 'P', item_section)
        worksheet.merge_range('AQ99:AS99', 'D', item_section)
        worksheet.merge_range('AT99:AW99', 'R', item_section)
        worksheet.merge_range('AO100:AP100', 'P', item_section)
        worksheet.merge_range('AQ100:AS100', 'D', item_section)
        worksheet.merge_range('AT100:AW100', 'R', item_section)
        worksheet.merge_range('AX95:BD95', 'CIE - 10', subsection_format)
        worksheet.merge_range('AX96:BD96', 'Z01.4', item_16)
        worksheet.merge_range('AX97:BD97', '', item_16)
        worksheet.merge_range('AX98:BD98', '', item_16)
        worksheet.merge_range('AX99:BD99', '', item_16)
        worksheet.merge_range('AX100:BD100', '', item_16)
        worksheet.merge_range('BE94:BM94', 'EGRESO', subsection_format)
        worksheet.merge_range('BE95:BI95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('BE96:BG96', 'D', item_section)
        worksheet.merge_range('BH96:BI96', 'R', item_section)
        worksheet.merge_range('BE97:BG97', 'D', item_section)
        worksheet.merge_range('BH97:BI97', 'R', item_section)
        worksheet.merge_range('BE98:BG98', 'D', item_section)
        worksheet.merge_range('BH98:BI98', 'R', item_section)
        worksheet.merge_range('BE99:BG99', 'D', item_section)
        worksheet.merge_range('BH99:BI99', 'R', item_section)
        worksheet.merge_range('BE100:BG100', 'D', item_section)
        worksheet.merge_range('BH100:BI100', 'R', item_section)
        worksheet.merge_range('BJ95:BM95', 'CIE - 10', subsection_format)
        worksheet.merge_range('BJ96:BM96', '', item_16)
        worksheet.merge_range('BJ97:BM97', '', item_16)
        worksheet.merge_range('BJ98:BM98', '', item_16)
        worksheet.merge_range('BJ99:BM99', '', item_16)
        worksheet.merge_range('BJ100:BM100', '', item_16)
        worksheet.merge_range('A102:N102', u'N° DE DNI', section_format)
        worksheet.merge_range('A103:N103', self.request.user.dni, item_16)
        worksheet.merge_range(
            'O102:BE102', u'NOMBRE DEL RESPONSABLE DE LA ATENCIÓN',
            section_format)
        worksheet.merge_range(
            'O103:BE103', self.request.user.get_full_name(), item_16)
        worksheet.merge_range(
            'BF102:BM102', u'N° DE COLEGIATURA', section_format)
        worksheet.merge_range(
            'BF103:BM103', self.request.user.colegiatura, item_16)
        worksheet.merge_range(
            'A105:N105', u'RESPONSABLE DE LA ATENCIÓN', subsection_format)
        worksheet.merge_range('O105:Q105', '5', item_section)
        worksheet.merge_range('R105:Y105', 'ESPECIALIDAD', subsection_format)
        worksheet.merge_range('Z105:AT105', '', item_section)
        worksheet.merge_range('AU105:AZ105', u'N° RNE', subsection_format)
        worksheet.merge_range('BA105:BE105', '', item_section)
        worksheet.merge_range('BF105:BK105', 'EGRESADO', subsection_format)
        worksheet.merge_range('BL105:BM105', '', item_16)
        worksheet.merge_range('A106:BM107', u'   '.join([
            u'1. MÉDICO', '2. FARMACEUTICO', '3. CIRUJANO DENTISTA',
            u'4. BIÓLOGO', '5. OBSTETRIZ', '6. ENFERMERA',
            '7. TRABAJADORA SOCIAL', '8. PSICOLOGA', '9.TECNOLOGO MEDICO',
            '10.NUTRICION', '11. TECNICO ENFERMERIA',
            '12. AUXILIAR DE ENFERMERIA', '13. OTRO']), formato_leyenda_8)
        worksheet.merge_range('B119:Y119', '', subrayado)
        worksheet.merge_range(
            'B121:Y121', u'FIRMA Y SELLO DEL RESPONSABLE DE LA ATENCIÓN ',
            responsable_formato)
        worksheet.merge_range('AH108:AM109', 'FIRMA', responsable_formato)
        worksheet.merge_range('AH110:AM111', 'ASEGURADO', responsable_formato)
        worksheet.merge_range('AO110:AP111', '', item_16)
        worksheet.merge_range('AH112:AM113', 'APODERADO', responsable_formato)
        worksheet.merge_range('AO112:AP113', '', item_16)
        worksheet.write('AH117', 'APODERADO:', responsable_formato)
        worksheet.merge_range('AQ117:BE117', '', subrayado)
        worksheet.write('AH118', 'NOMBRES Y APELLIDOS', responsable_formato)
        worksheet.merge_range('AQ118:BE118', '', subrayado)
        worksheet.write(
            'AH121', 'DNI o CE DEL APODERADO:', responsable_formato)
        worksheet.merge_range('AR121:BE121', '', subrayado)

        worksheet.merge_range('BH109:BL120', '', item_16)

        worksheet.merge_range(
            'BG122:BL124', 'Huella Digital del Asegurado o del Apoderado',
            item_section)

        reverso = workbook.add_worksheet('FUA024R')
        reverso.fit_to_pages(1, 1)
        reverso.set_portrait()

        self.set_back_column_dimension(reverso)
        self.set_back_row_dimension(reverso)

        titulo_reverse = workbook.add_format()
        self.bold_pattern_common(titulo_reverse)
        titulo_reverse.set_bg_color('#D9D9D9')
        titulo_reverse.set_font_size(22)

        subtitulo_reverse = workbook.add_format()
        self.bold_pattern_common(subtitulo_reverse)
        subtitulo_reverse.set_bg_color('#D9D9D9')
        subtitulo_reverse.set_font_size(20)

        item_reverso = workbook.add_format()
        self.bold_common(item_reverso)
        item_reverso.set_font_size(20)

        firma_reverso = workbook.add_format()
        firma_reverso.set_align('center')
        firma_reverso.set_align('vcenter')
        firma_reverso.set_bold()
        firma_reverso.set_font_name('Arial')
        firma_reverso.set_font_size(24)
        firma_reverso.set_text_wrap()
        firma_reverso.set_top()

        reverso.merge_range(
            'T1:AC1', u'FORMATO DE ATENCIÓN Nº', titulo_reverse)
        reverso.merge_range('T2:V2', '', item_16)
        reverso.merge_range('W2:Y2', '', item_16)
        reverso.merge_range('Z2:AC2', '', item_16)
        reverso.merge_range(
            'A4:AC4', 'PRODUCTOS FARMACEUTICOS / MEDICAMENTOS', titulo_reverse)
        reverso.merge_range('A5:B5', u'CÓDIGO SISMED', subtitulo_reverse)
        reverso.merge_range('C5:J5', 'NOMBRE', subtitulo_reverse)
        reverso.write('K5', 'FF', subtitulo_reverse)
        reverso.write('L5', 'CONCENTR', subtitulo_reverse)
        reverso.write('M5', 'PRES', subtitulo_reverse)
        reverso.write('N5', 'ENTR', subtitulo_reverse)
        reverso.write('O5', 'DX', subtitulo_reverse)
        reverso.merge_range('P5:Q5', u'CÓD. SISMED', subtitulo_reverse)
        reverso.merge_range('R5:X5', 'NOMBRE', subtitulo_reverse)
        reverso.write('Y5', 'FF', subtitulo_reverse)
        reverso.write('Z5', 'CONCENTR', subtitulo_reverse)
        reverso.write('AA5', 'PRES', subtitulo_reverse)
        reverso.write('AB5', 'ENTR', subtitulo_reverse)
        reverso.write('AC5', 'DX', subtitulo_reverse)
        reverso.merge_range('A6:B6', '', item_reverso)
        reverso.merge_range('C6:J6', '', item_reverso)
        reverso.write('L6', '', item_reverso)
        reverso.write('K6', '', item_reverso)
        reverso.write('M6', '', item_reverso)
        reverso.write('N6', '', item_reverso)
        reverso.write('O6', '', item_reverso)
        reverso.write('Y6', '', item_reverso)
        reverso.write('Z6', '', item_reverso)
        reverso.write('AA6', '', item_reverso)
        reverso.write('AB6', '', item_reverso)
        reverso.write('AC6', '', item_reverso)

        reverso.merge_range('A7:B7', '', item_reverso)
        reverso.merge_range('A8:B8', '', item_reverso)
        reverso.merge_range('A9:B9', '', item_reverso)
        reverso.merge_range('A10:B10', '', item_reverso)
        reverso.merge_range('A11:B11', '', item_reverso)
        reverso.merge_range('A12:B12', '', item_reverso)
        reverso.merge_range('A13:B13', '', item_reverso)
        reverso.merge_range('A14:B14', '', item_reverso)
        reverso.merge_range('A15:B15', '', item_reverso)
        reverso.merge_range('A16:B16', '', item_reverso)
        reverso.merge_range('A17:B17', '', item_reverso)
        reverso.merge_range('A18:B18', '', item_reverso)
        reverso.merge_range('C7:J7', '', item_reverso)
        reverso.merge_range('C8:J8', '', item_reverso)
        reverso.merge_range('C9:J9', '', item_reverso)
        reverso.merge_range('C10:J10', '', item_reverso)
        reverso.merge_range('C11:J11', '', item_reverso)
        reverso.merge_range('C12:J12', '', item_reverso)
        reverso.merge_range('C13:J13', '', item_reverso)
        reverso.merge_range('C14:J14', '', item_reverso)
        reverso.merge_range('C15:J15', '', item_reverso)
        reverso.merge_range('C16:J16', '', item_reverso)
        reverso.merge_range('C17:J17', '', item_reverso)
        reverso.merge_range('C18:J18', '', item_reverso)
        reverso.write('K7', '', item_reverso)
        reverso.write('K8', '', item_reverso)
        reverso.write('K9', '', item_reverso)
        reverso.write('K10', '', item_reverso)
        reverso.write('K11', '', item_reverso)
        reverso.write('K12', '', item_reverso)
        reverso.write('K13', '', item_reverso)
        reverso.write('K14', '', item_reverso)
        reverso.write('K15', '', item_reverso)
        reverso.write('K16', '', item_reverso)
        reverso.write('K17', '', item_reverso)
        reverso.write('K18', '', item_reverso)
        reverso.write('L7', '', item_reverso)
        reverso.write('L8', '', item_reverso)
        reverso.write('L9', '', item_reverso)
        reverso.write('L10', '', item_reverso)
        reverso.write('L11', '', item_reverso)
        reverso.write('L12', '', item_reverso)
        reverso.write('L13', '', item_reverso)
        reverso.write('L14', '', item_reverso)
        reverso.write('L15', '', item_reverso)
        reverso.write('L16', '', item_reverso)
        reverso.write('L17', '', item_reverso)
        reverso.write('L18', '', item_reverso)
        reverso.write('M7', '', item_reverso)
        reverso.write('M8', '', item_reverso)
        reverso.write('M9', '', item_reverso)
        reverso.write('M10', '', item_reverso)
        reverso.write('M11', '', item_reverso)
        reverso.write('M12', '', item_reverso)
        reverso.write('M13', '', item_reverso)
        reverso.write('M14', '', item_reverso)
        reverso.write('M15', '', item_reverso)
        reverso.write('M16', '', item_reverso)
        reverso.write('M17', '', item_reverso)
        reverso.write('M18', '', item_reverso)
        reverso.write('N7', '', item_reverso)
        reverso.write('N8', '', item_reverso)
        reverso.write('N9', '', item_reverso)
        reverso.write('N10', '', item_reverso)
        reverso.write('N11', '', item_reverso)
        reverso.write('N12', '', item_reverso)
        reverso.write('N13', '', item_reverso)
        reverso.write('N14', '', item_reverso)
        reverso.write('N15', '', item_reverso)
        reverso.write('N16', '', item_reverso)
        reverso.write('N17', '', item_reverso)
        reverso.write('N18', '', item_reverso)
        reverso.write('O7', '', item_reverso)
        reverso.write('O8', '', item_reverso)
        reverso.write('O9', '', item_reverso)
        reverso.write('O10', '', item_reverso)
        reverso.write('O11', '', item_reverso)
        reverso.write('O12', '', item_reverso)
        reverso.write('O13', '', item_reverso)
        reverso.write('O14', '', item_reverso)
        reverso.write('O15', '', item_reverso)
        reverso.write('O16', '', item_reverso)
        reverso.write('O17', '', item_reverso)
        reverso.write('O18', '', item_reverso)
        reverso.write('Y7', '', item_reverso)
        reverso.write('Y8', '', item_reverso)
        reverso.write('Y9', '', item_reverso)
        reverso.write('Y10', '', item_reverso)
        reverso.write('Y11', '', item_reverso)
        reverso.write('Y12', '', item_reverso)
        reverso.write('Y13', '', item_reverso)
        reverso.write('Y14', '', item_reverso)
        reverso.write('Y15', '', item_reverso)
        reverso.write('Y16', '', item_reverso)
        reverso.write('Y17', '', item_reverso)
        reverso.write('Y18', '', item_reverso)
        reverso.write('Z7', '', item_reverso)
        reverso.write('Z8', '', item_reverso)
        reverso.write('Z9', '', item_reverso)
        reverso.write('Z10', '', item_reverso)
        reverso.write('Z11', '', item_reverso)
        reverso.write('Z12', '', item_reverso)
        reverso.write('Z13', '', item_reverso)
        reverso.write('Z14', '', item_reverso)
        reverso.write('Z15', '', item_reverso)
        reverso.write('Z16', '', item_reverso)
        reverso.write('Z17', '', item_reverso)
        reverso.write('Z18', '', item_reverso)
        reverso.write('AA7', '', item_reverso)
        reverso.write('AA8', '', item_reverso)
        reverso.write('AA9', '', item_reverso)
        reverso.write('AA10', '', item_reverso)
        reverso.write('AA11', '', item_reverso)
        reverso.write('AA12', '', item_reverso)
        reverso.write('AA13', '', item_reverso)
        reverso.write('AA14', '', item_reverso)
        reverso.write('AA15', '', item_reverso)
        reverso.write('AA16', '', item_reverso)
        reverso.write('AA17', '', item_reverso)
        reverso.write('AA18', '', item_reverso)
        reverso.write('AB7', '', item_reverso)
        reverso.write('AB8', '', item_reverso)
        reverso.write('AB9', '', item_reverso)
        reverso.write('AB10', '', item_reverso)
        reverso.write('AB11', '', item_reverso)
        reverso.write('AB12', '', item_reverso)
        reverso.write('AB13', '', item_reverso)
        reverso.write('AB14', '', item_reverso)
        reverso.write('AB15', '', item_reverso)
        reverso.write('AB16', '', item_reverso)
        reverso.write('AB17', '', item_reverso)
        reverso.write('AB18', '', item_reverso)
        reverso.write('AC7', '', item_reverso)
        reverso.write('AC8', '', item_reverso)
        reverso.write('AC9', '', item_reverso)
        reverso.write('AC10', '', item_reverso)
        reverso.write('AC11', '', item_reverso)
        reverso.write('AC12', '', item_reverso)
        reverso.write('AC13', '', item_reverso)
        reverso.write('AC14', '', item_reverso)
        reverso.write('AC15', '', item_reverso)
        reverso.write('AC16', '', item_reverso)
        reverso.write('AC17', '', item_reverso)
        reverso.write('AC18', '', item_reverso)
        reverso.merge_range(
            'A19:AC19', u'DISPOSITIVOS MÉDICOS / PRODUCTOS SANITARIOS',
            titulo_reverse)
        reverso.merge_range('A20:B20', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A21:B21', '', item_reverso)
        reverso.merge_range('A22:B22', '', item_reverso)
        reverso.merge_range('A23:B23', '', item_reverso)
        reverso.merge_range('A24:B24', '', item_reverso)
        reverso.merge_range('A25:B25', '', item_reverso)
        reverso.merge_range('A26:B26', '', item_reverso)
        reverso.merge_range('A27:B27', '', item_reverso)
        reverso.merge_range('A28:B28', '', item_reverso)
        reverso.merge_range('A29:B29', '', item_reverso)
        reverso.merge_range('C20:J20', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C21:J21', '', item_reverso)
        reverso.merge_range('C22:J22', '', item_reverso)
        reverso.merge_range('C23:J23', '', item_reverso)
        reverso.merge_range('C24:J24', '', item_reverso)
        reverso.merge_range('C25:J25', '', item_reverso)
        reverso.merge_range('C26:J26', '', item_reverso)
        reverso.merge_range('C27:J27', '', item_reverso)
        reverso.merge_range('C28:J28', '', item_reverso)
        reverso.merge_range('C29:J29', '', item_reverso)
        reverso.write('K20', 'PR', subtitulo_reverse)
        reverso.write('K21', '', item_reverso)
        reverso.write('K22', '', item_reverso)
        reverso.write('K23', '', item_reverso)
        reverso.write('K24', '', item_reverso)
        reverso.write('K25', '', item_reverso)
        reverso.write('K26', '', item_reverso)
        reverso.write('K27', '', item_reverso)
        reverso.write('K28', '', item_reverso)
        reverso.write('K29', '', item_reverso)
        reverso.write('L20', 'CARACT', subtitulo_reverse)
        reverso.write('L21', '', item_reverso)
        reverso.write('L22', '', item_reverso)
        reverso.write('L23', '', item_reverso)
        reverso.write('L24', '', item_reverso)
        reverso.write('L25', '', item_reverso)
        reverso.write('L26', '', item_reverso)
        reverso.write('L27', '', item_reverso)
        reverso.write('L28', '', item_reverso)
        reverso.write('L29', '', item_reverso)
        reverso.write('M20', 'PRES', subtitulo_reverse)
        reverso.write('M21', '', item_reverso)
        reverso.write('M22', '', item_reverso)
        reverso.write('M23', '', item_reverso)
        reverso.write('M24', '', item_reverso)
        reverso.write('M25', '', item_reverso)
        reverso.write('M26', '', item_reverso)
        reverso.write('M27', '', item_reverso)
        reverso.write('M28', '', item_reverso)
        reverso.write('M29', '', item_reverso)
        reverso.write('N20', 'ENTR', subtitulo_reverse)
        reverso.write('N21', '', item_reverso)
        reverso.write('N22', '', item_reverso)
        reverso.write('N23', '', item_reverso)
        reverso.write('N24', '', item_reverso)
        reverso.write('N25', '', item_reverso)
        reverso.write('N26', '', item_reverso)
        reverso.write('N27', '', item_reverso)
        reverso.write('N28', '', item_reverso)
        reverso.write('N29', '', item_reverso)
        reverso.write('O20', 'DX', subtitulo_reverse)
        reverso.write('O21', '', item_reverso)
        reverso.write('O22', '', item_reverso)
        reverso.write('O23', '', item_reverso)
        reverso.write('O24', '', item_reverso)
        reverso.write('O25', '', item_reverso)
        reverso.write('O26', '', item_reverso)
        reverso.write('O27', '', item_reverso)
        reverso.write('O28', '', item_reverso)
        reverso.write('O29', '', item_reverso)
        reverso.merge_range('P20:Q20', u'CÓDIGO', subtitulo_reverse)

        reverso.merge_range('R20:X20', 'NOMBRE', subtitulo_reverse)

        reverso.write('Y20', 'PR', subtitulo_reverse)
        reverso.write('Y21', '', item_reverso)
        reverso.write('Y22', '', item_reverso)
        reverso.write('Y23', '', item_reverso)
        reverso.write('Y24', '', item_reverso)
        reverso.write('Y25', '', item_reverso)
        reverso.write('Y26', '', item_reverso)
        reverso.write('Y27', '', item_reverso)
        reverso.write('Y28', '', item_reverso)
        reverso.write('Y29', '', item_reverso)
        reverso.write('Z20', 'CARACT', subtitulo_reverse)
        reverso.write('Z21', '', item_reverso)
        reverso.write('Z22', '', item_reverso)
        reverso.write('Z23', '', item_reverso)
        reverso.write('Z24', '', item_reverso)
        reverso.write('Z25', '', item_reverso)
        reverso.write('Z26', '', item_reverso)
        reverso.write('Z27', '', item_reverso)
        reverso.write('Z28', '', item_reverso)
        reverso.write('Z29', '', item_reverso)
        reverso.write('AA20', 'PRES', subtitulo_reverse)
        reverso.write('AA21', '', item_reverso)
        reverso.write('AA22', '', item_reverso)
        reverso.write('AA23', '', item_reverso)
        reverso.write('AA24', '', item_reverso)
        reverso.write('AA25', '', item_reverso)
        reverso.write('AA26', '', item_reverso)
        reverso.write('AA27', '', item_reverso)
        reverso.write('AA28', '', item_reverso)
        reverso.write('AA29', '', item_reverso)
        reverso.write('AB20', 'ENTR', subtitulo_reverse)
        reverso.write('AB21', '', item_reverso)
        reverso.write('AB22', '', item_reverso)
        reverso.write('AB23', '', item_reverso)
        reverso.write('AB24', '', item_reverso)
        reverso.write('AB25', '', item_reverso)
        reverso.write('AB26', '', item_reverso)
        reverso.write('AB27', '', item_reverso)
        reverso.write('AB28', '', item_reverso)
        reverso.write('AB29', '', item_reverso)
        reverso.write('AC20', 'DX', subtitulo_reverse)
        reverso.write('AC21', '', item_reverso)
        reverso.write('AC22', '', item_reverso)
        reverso.write('AC23', '', item_reverso)
        reverso.write('AC24', '', item_reverso)
        reverso.write('AC25', '', item_reverso)
        reverso.write('AC26', '', item_reverso)
        reverso.write('AC27', '', item_reverso)
        reverso.write('AC28', '', item_reverso)
        reverso.write('AC29', '', item_reverso)
        reverso.merge_range(
            'A30:AC30',
            u'PROCEDIMIENTOS/ DIAGNÓSTICO POR IMÁGENES/ LABORATORIO',
            titulo_reverse)
        reverso.merge_range('A31:B31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A32:B32', '59400', item_reverso)
        reverso.merge_range('A33:B33', '', item_reverso)
        reverso.merge_range('A34:B34', '', item_reverso)
        reverso.merge_range('A35:B35', '', item_reverso)
        reverso.merge_range('A36:B36', '', item_reverso)
        reverso.merge_range('A37:B37', '', item_reverso)
        reverso.merge_range('A38:B38', '', item_reverso)
        reverso.merge_range('A39:B39', '', item_reverso)
        reverso.merge_range('A40:B40', '', item_reverso)
        reverso.merge_range('A41:B41', '', item_reverso)
        reverso.merge_range('A42:B42', '', item_reverso)
        reverso.merge_range('C31:K31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C32:K32', 'TOMA DE PAP', item_reverso)
        reverso.merge_range('C33:K33', '', item_reverso)
        reverso.merge_range('C34:K34', '', item_reverso)
        reverso.merge_range('C35:K35', '', item_reverso)
        reverso.merge_range('C36:K36', '', item_reverso)
        reverso.merge_range('C37:K37', '', item_reverso)
        reverso.merge_range('C38:K38', '', item_reverso)
        reverso.merge_range('C39:K39', '', item_reverso)
        reverso.merge_range('C40:K40', '', item_reverso)
        reverso.merge_range('C41:K41', '', item_reverso)
        reverso.merge_range('C42:K42', '', item_reverso)
        reverso.write('L31', 'IND', subtitulo_reverse)
        reverso.write('L32', '1', item_reverso)
        reverso.write('L33', '', item_reverso)
        reverso.write('L34', '', item_reverso)
        reverso.write('L35', '', item_reverso)
        reverso.write('L36', '', item_reverso)
        reverso.write('L37', '', item_reverso)
        reverso.write('L38', '', item_reverso)
        reverso.write('L39', '', item_reverso)
        reverso.write('L40', '', item_reverso)
        reverso.write('L41', '', item_reverso)
        reverso.write('L42', '', item_reverso)
        reverso.write('M31', 'EJE', subtitulo_reverse)
        reverso.write('M32', '1', item_reverso)
        reverso.write('M33', '', item_reverso)
        reverso.write('M34', '', item_reverso)
        reverso.write('M35', '', item_reverso)
        reverso.write('M36', '', item_reverso)
        reverso.write('M37', '', item_reverso)
        reverso.write('M38', '', item_reverso)
        reverso.write('M39', '', item_reverso)
        reverso.write('M40', '', item_reverso)
        reverso.write('M41', '', item_reverso)
        reverso.write('M42', '', item_reverso)
        reverso.write('N31', 'DX', subtitulo_reverse)
        reverso.write('N32', '', item_reverso)
        reverso.write('N33', '', item_reverso)
        reverso.write('N34', '', item_reverso)
        reverso.write('N35', '', item_reverso)
        reverso.write('N36', '', item_reverso)
        reverso.write('N37', '', item_reverso)
        reverso.write('N38', '', item_reverso)
        reverso.write('N39', '', item_reverso)
        reverso.write('N40', '', item_reverso)
        reverso.write('N41', '', item_reverso)
        reverso.write('N42', '', item_reverso)
        reverso.write('O31', 'RES', subtitulo_reverse)
        reverso.write('O32', '', item_reverso)
        reverso.write('O33', '', item_reverso)
        reverso.write('O34', '', item_reverso)
        reverso.write('O35', '', item_reverso)
        reverso.write('O36', '', item_reverso)
        reverso.write('O37', '', item_reverso)
        reverso.write('O38', '', item_reverso)
        reverso.write('O39', '', item_reverso)
        reverso.write('O40', '', item_reverso)
        reverso.write('O41', '', item_reverso)
        reverso.write('O42', '', item_reverso)
        reverso.merge_range('P31:Q31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('P32:Q32', '', item_reverso)
        reverso.merge_range('P33:Q33', '', item_reverso)
        reverso.merge_range('P34:Q34', '', item_reverso)
        reverso.merge_range('P35:Q35', '', item_reverso)
        reverso.merge_range('P36:Q36', '', item_reverso)
        reverso.merge_range('P37:Q37', '', item_reverso)
        reverso.merge_range('P38:Q38', '', item_reverso)
        reverso.merge_range('P39:Q39', '', item_reverso)
        reverso.merge_range('P40:Q40', '', item_reverso)
        reverso.merge_range('P41:Q41', '', item_reverso)
        reverso.merge_range('P42:Q42', '', item_reverso)
        reverso.merge_range('R31:Y31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('R32:Y32', '', item_reverso)
        reverso.merge_range('R33:Y33', '', item_reverso)
        reverso.merge_range('R34:Y34', '', item_reverso)
        reverso.merge_range('R35:Y35', '', item_reverso)
        reverso.merge_range('R36:Y36', '', item_reverso)
        reverso.merge_range('R37:Y37', '', item_reverso)
        reverso.merge_range('R38:Y38', '', item_reverso)
        reverso.merge_range('R39:Y39', '', item_reverso)
        reverso.merge_range('R40:Y40', '', item_reverso)
        reverso.merge_range('R41:Y41', '', item_reverso)
        reverso.merge_range('R42:Y42', '', item_reverso)
        reverso.write('Z31', 'IND', subtitulo_reverse)
        reverso.write('Z32', '', item_reverso)
        reverso.write('Z33', '', item_reverso)
        reverso.write('Z34', '', item_reverso)
        reverso.write('Z35', '', item_reverso)
        reverso.write('Z36', '', item_reverso)
        reverso.write('Z37', '', item_reverso)
        reverso.write('Z38', '', item_reverso)
        reverso.write('Z39', '', item_reverso)
        reverso.write('Z40', '', item_reverso)
        reverso.write('Z41', '', item_reverso)
        reverso.write('Z42', '', item_reverso)
        reverso.write('AA31', 'EJE', subtitulo_reverse)
        reverso.write('AA32', '', item_reverso)
        reverso.write('AA33', '', item_reverso)
        reverso.write('AA34', '', item_reverso)
        reverso.write('AA35', '', item_reverso)
        reverso.write('AA36', '', item_reverso)
        reverso.write('AA37', '', item_reverso)
        reverso.write('AA38', '', item_reverso)
        reverso.write('AA39', '', item_reverso)
        reverso.write('AA40', '', item_reverso)
        reverso.write('AA41', '', item_reverso)
        reverso.write('AA42', '', item_reverso)
        reverso.write('AB31', 'DX', subtitulo_reverse)
        reverso.write('AB32', '', item_reverso)
        reverso.write('AB33', '', item_reverso)
        reverso.write('AB34', '', item_reverso)
        reverso.write('AB35', '', item_reverso)
        reverso.write('AB36', '', item_reverso)
        reverso.write('AB37', '', item_reverso)
        reverso.write('AB38', '', item_reverso)
        reverso.write('AB39', '', item_reverso)
        reverso.write('AB40', '', item_reverso)
        reverso.write('AB41', '', item_reverso)
        reverso.write('AB42', '', item_reverso)
        reverso.write('AC31', 'RES', subtitulo_reverse)
        reverso.write('AC32', '', item_reverso)
        reverso.write('AC33', '', item_reverso)
        reverso.write('AC34', '', item_reverso)
        reverso.write('AC35', '', item_reverso)
        reverso.write('AC36', '', item_reverso)
        reverso.write('AC37', '', item_reverso)
        reverso.write('AC38', '', item_reverso)
        reverso.write('AC39', '', item_reverso)
        reverso.write('AC40', '', item_reverso)
        reverso.write('AC41', '', item_reverso)
        reverso.write('AC42', '', item_reverso)
        reverso.merge_range(
            'A43:AC43', 'SUB COMPONENTE PRESTACIONAL (PROCEDIMIENTOS)',
            titulo_reverse)
        reverso.merge_range('A44:B45', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A46:B46', '', item_reverso)
        reverso.merge_range('A47:B47', '', item_reverso)
        reverso.merge_range('A48:B48', '', item_reverso)
        reverso.merge_range('A49:B49', '', item_reverso)
        reverso.merge_range('A50:B50', '', item_reverso)
        reverso.merge_range('C44:M45', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C46:M46', '', item_reverso)
        reverso.merge_range('C47:M47', '', item_reverso)
        reverso.merge_range('C48:M48', '', item_reverso)
        reverso.merge_range('C49:M49', '', item_reverso)
        reverso.merge_range('C50:M50', '', item_reverso)
        reverso.merge_range('N44:Q45', 'CARACT', subtitulo_reverse)
        reverso.merge_range('N46:Q46', '', item_reverso)
        reverso.merge_range('N47:Q47', '', item_reverso)
        reverso.merge_range('N48:Q48', '', item_reverso)
        reverso.merge_range('N49:Q49', '', item_reverso)
        reverso.merge_range('N50:Q50', '', item_reverso)
        reverso.merge_range('R44:T45', 'IND/ PRES', subtitulo_reverse)
        reverso.merge_range('R46:T46', '', item_reverso)
        reverso.merge_range('R47:T47', '', item_reverso)
        reverso.merge_range('R48:T48', '', item_reverso)
        reverso.merge_range('R49:T49', '', item_reverso)
        reverso.merge_range('R50:T50', '', item_reverso)
        reverso.merge_range('U44:W45', 'EJE/ ENTR', subtitulo_reverse)
        reverso.merge_range('U46:W46', '', item_reverso)
        reverso.merge_range('U47:W47', '', item_reverso)
        reverso.merge_range('U48:W48', '', item_reverso)
        reverso.merge_range('U49:W49', '', item_reverso)
        reverso.merge_range('U50:W50', '', item_reverso)
        reverso.merge_range('X44:Y45', 'DX', subtitulo_reverse)
        reverso.merge_range('X46:Y46', '', item_reverso)
        reverso.merge_range('X47:Y47', '', item_reverso)
        reverso.merge_range('X48:Y48', '', item_reverso)
        reverso.merge_range('X49:Y49', '', item_reverso)
        reverso.merge_range('X50:Y50', '', item_reverso)
        reverso.merge_range('Z44:Z45', 'RES', subtitulo_reverse)
        reverso.write('Z46', '', item_reverso)
        reverso.write('Z47', '', item_reverso)
        reverso.write('Z48', '', item_reverso)
        reverso.write('Z49', '', item_reverso)
        reverso.write('Z50', '', item_reverso)
        reverso.merge_range('AA44:AA45', u'N° TICKET', subtitulo_reverse)
        reverso.write('AA46', '', item_reverso)
        reverso.write('AA47', '', item_reverso)
        reverso.write('AA48', '', item_reverso)
        reverso.write('AA49', '', item_reverso)
        reverso.write('AA50', '', item_reverso)
        reverso.merge_range('AB44:AC45', 'PO', subtitulo_reverse)
        reverso.merge_range('AB46:AC46', '', item_reverso)
        reverso.merge_range('AB47:AC47', '', item_reverso)
        reverso.merge_range('AB48:AC48', '', item_reverso)
        reverso.merge_range('AB49:AC49', '', item_reverso)
        reverso.merge_range('AB50:AC50', '', item_reverso)
        reverso.merge_range('A51:AC51', 'OBSERVACIONES', subtitulo_reverse)
        reverso.merge_range('A52:AC53', '', item_reverso)
        reverso.merge_range('A54:AC55', '', item_reverso)
        reverso.merge_range('A56:AC57', '', item_reverso)
        reverso.merge_range('A58:AC59', '', item_reverso)
        reverso.merge_range(
            'B70:K71', '/'.join([
                'Firma y Sello del Responsable de Procedimiento y',
                'o Farmacia y', 'o Laboratorio']), firma_reverso)
        reverso.merge_range('R61:V69', '', item_16)
        reverso.merge_range(
            'R70:V71', 'Huella Digital del Asegurado o del Apoderado', firma_reverso)

        workbook.close()
        return workbook


class Fua071ExcelReport(FuaBase):
    def get_book(self, output):
        workbook = xlsxwriter.Workbook(output)
        worksheet = workbook.add_worksheet('FUA071')
        worksheet.fit_to_pages(1, 1)
        worksheet.set_portrait()

        self.set_front_columns_dimension(worksheet)
        self.set_front_row_dimension(worksheet)

        section_format = workbook.add_format()
        self.bold_pattern_common(section_format)
        section_format.set_bg_color('#CCCCCC')
        section_format.set_font_size(11)

        subsection_format = workbook.add_format()
        self.bold_pattern_common(subsection_format)
        subsection_format.set_bg_color('#F2F2F2')
        subsection_format.set_font_size(10)

        item_16 = workbook.add_format()
        self.bold_common(item_16)
        item_16.set_font_size(16)

        check_format = workbook.add_format()
        self.bold_common(check_format)
        check_format.set_font_size(20)

        label_item = workbook.add_format()
        self.pattern_common(label_item)
        label_item.set_bg_color('#F2F2F2')
        label_item.set_font_size(9)

        item_section = workbook.add_format()
        self.common_formats(item_section)
        item_section.set_font_size(9)

        item_rotated = workbook.add_format()
        self.bold_pattern_common(item_rotated)
        item_rotated.set_bg_color('#F2F2F2')
        item_rotated.set_font_size(10)
        item_rotated.set_rotation(90)

        superscript = workbook.add_format({'font_script': 1})

        formato_leyenda = workbook.add_format()
        self.common_formats(formato_leyenda)
        formato_leyenda.set_font_size(7)

        formato_leyenda_8 = workbook.add_format()
        self.common_formats(formato_leyenda_8)
        formato_leyenda_8.set_font_size(8)

        responsable_formato = workbook.add_format()
        responsable_formato.set_align('vcenter')
        responsable_formato.set_bold()
        responsable_formato.set_font_name('Arial')
        responsable_formato.set_font_size(11)

        subrayado = workbook.add_format()
        subrayado.set_bottom(1)

        today = timezone.now()

        worksheet.insert_image(
            'A1', settings.STATIC_ROOT + '/img/minsa_logo.png',
            {'x_scale': 0.65, 'y_scale': 0.85})
        worksheet.merge_range('A1:BM4', '')
        worksheet.merge_range(
            'A5:BM5', u'FORMATO ÚNICO DE ATENCIÓN - FUA', section_format)
        worksheet.merge_range('R6:AO6', u'NÚMERO DE FORMATO', section_format)
        worksheet.merge_range(
            'R7:W8', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('X7:AA8', str(today.year)[2:], item_16)
        worksheet.merge_range('AB7:AO8', '', item_16)
        worksheet.merge_range(
            'AR6:BH6', u'INSTITUCIÓN EDUCATIVA', section_format)
        worksheet.merge_range('AR7:BH7', '', item_section)
        worksheet.merge_range('AR8:AT8', 'INIC.', subsection_format)
        worksheet.merge_range('AU8:AX8', 'PRIM.', subsection_format)
        worksheet.merge_range('AY8:AZ8', 'SEC.', subsection_format)
        worksheet.merge_range('BA8:BC8', '', item_section)
        worksheet.merge_range('BD8:BF8', u'SECCIÓN', subsection_format)
        worksheet.merge_range('BG8:BH8', '', item_section)
        worksheet.merge_range('BI6:BM6', u'CÓDIGO', section_format)
        worksheet.merge_range('BI7:BM7', '', item_section)
        worksheet.merge_range('BI8:BK8', 'TURNO', subsection_format)
        worksheet.merge_range('BL8:BM8', '', item_section)
        worksheet.merge_range(
            'A10:BM10', u'DE LA INSTITUCIÓN PRESTADORA DE SERVICIOS DE SALUD',
            section_format)
        worksheet.merge_range(
            'A11:S12', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range(
            'A13:S13', self.control.establecimiento.codigo, item_16)
        worksheet.merge_range(
            'T11:BM12', u'NOMBRE  DE LA IPRESS QUE REALIZA LA ATENCIÓN',
            subsection_format)
        worksheet.merge_range(
            'T13:BM13', self.control.establecimiento.nombre, item_16)
        worksheet.merge_range(
            'A15:S15', 'PERSONAL QUE ATIENDE', subsection_format)
        worksheet.merge_range(
            'T15:AB15', u'LUGAR DE ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AC15:AL15', u'ATENCIÓN', subsection_format)
        worksheet.merge_range(
            'AM15:BM15', 'REFERENCIA REALIZADA POR', subsection_format)
        worksheet.merge_range('A16:E17', 'DE LA IPRESS', label_item)
        worksheet.merge_range('A18:E18', 'ITINERANTE', label_item)
        worksheet.merge_range('A19:E19', 'OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'I16:S17', u'CÓDIGO DE LA OFERTA FLEXIBLE', label_item)
        worksheet.merge_range('F16:H17', 'X', check_format)
        worksheet.merge_range('F18:H18', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('F19:H19', '', check_format)
        worksheet.merge_range('I18:S19', '', check_format)
        worksheet.merge_range('T16:Z17', 'INTRAMURAL', label_item)
        worksheet.merge_range('T18:Z18', 'EXTRAMURAL', label_item)
        worksheet.merge_range('AA16:AB17', 'X', check_format)
        worksheet.merge_range('AA18:AB18', '', check_format)
        worksheet.merge_range('T19:AB19', '')
        worksheet.merge_range('AC16:AI17', 'AMBULATORIA', label_item)
        worksheet.merge_range('AC18:AI18', 'REFERENCIA', label_item)
        worksheet.merge_range('AC19:AI19', 'EMERGENCIA', label_item)
        worksheet.merge_range('AJ16:AL17', 'X', check_format)
        worksheet.merge_range('AJ18:AL18', '', check_format)
        worksheet.merge_range('AJ19:AL19', '', check_format)
        worksheet.merge_range('AM16:AT17', u'CÓD. RENAES', label_item)
        worksheet.merge_range(
            'AU16:BI17', u'NOMBRE DE LA IPRESS U OFERTA FLEXIBLE', label_item)
        worksheet.merge_range(
            'BJ16:BM17', u'N° HOJA DE REFERENCIA', label_item)
        worksheet.merge_range('AM18:AT19', '', item_16)
        worksheet.merge_range('AU18:BI19', '', item_16)
        worksheet.merge_range('BJ18:BM19', '', item_16)
        worksheet.merge_range(
            'A21:BM21', 'DEL ASEGURADO / USUARIO', section_format)
        worksheet.merge_range(
            'A22:O22', u'IDENTIFICACIÓN', subsection_format)
        worksheet.merge_range('A23:B24', 'TDI', label_item)
        worksheet.merge_range('A25:B25', '1', item_16)
        worksheet.merge_range(
            'C23:O24', u'N° DOCUMENTO DE IDENTIDAD', label_item)
        worksheet.merge_range(
            'C25:O25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'Q22:AI22', u'CÓDIGO DEL ASEGURADO SIS', subsection_format)
        worksheet.merge_range('Q23:V24', 'DIRESA / OTROS', label_item)
        worksheet.merge_range(
            'Q25:V25', self.control.establecimiento.diresa.codigo, item_16)
        worksheet.merge_range('W23:AI24', u'NÚMERO', label_item)
        worksheet.merge_range('W25:Y25', '2', item_16)
        worksheet.merge_range(
            'Z25:AI25', self.control.paciente.numero_documento, item_16)
        worksheet.merge_range(
            'AK22:BM22', 'ASEGURADO DE OTRA IAFAS', subsection_format)
        worksheet.merge_range('AK23:AP24', u'INSTITUCIÓN', label_item)
        worksheet.merge_range('AQ23:BM24', '', item_16)
        worksheet.merge_range('AK25:AP25', 'COD. SEGURO', label_item)
        worksheet.merge_range('AQ25:BM25', '', item_16)
        worksheet.merge_range(
            'A27:AI27', 'APELLIDO PATERNO', subsection_format)
        worksheet.merge_range(
            'A28:AI28', self.control.paciente.apellido_paterno, item_16)
        worksheet.merge_range(
            'AK27:BM27', 'APELLIDO MATERNO', subsection_format)
        worksheet.merge_range(
            'AK28:BM28', self.control.paciente.apellido_materno, item_16)

        nombres = self.control.paciente.nombres.split(' ')
        otros_nombres = ''
        try:
            otros_nombres += nombres[1]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[2]
        except Exception as e:
            print
            str(e)
        try:
            otros_nombres += nombres[3]
        except Exception as e:
            print
            str(e)

        worksheet.merge_range('A30:AI30', 'PRIMER NOMBRE', subsection_format)
        worksheet.merge_range('A31:AI31', nombres[0], item_16)
        worksheet.merge_range('AK30:BM30', 'OTROS NOMBRES', subsection_format)
        worksheet.merge_range('AK31:BM31', otros_nombres, item_16)
        worksheet.merge_range('A33:G34', 'SEXO', subsection_format)
        worksheet.merge_range('A35:D35', 'MASCULINO', item_section)
        worksheet.merge_range('E35:G35', '', check_format)
        worksheet.merge_range('A36:D36', 'FEMENINO', item_section)
        worksheet.merge_range('E36:G36', 'X', check_format)
        worksheet.merge_range('A38:G40', 'SALUD MATERNA', subsection_format)
        worksheet.merge_range('A42:D46', 'GESTANTE', item_section)
        worksheet.merge_range('E42:G46', 'X', check_format)
        worksheet.merge_range('A47:D47', 'PUERPERA', item_section)
        worksheet.merge_range('E47:G47', '', check_format)
        worksheet.merge_range('I33:Q34', 'FECHA', subsection_format)
        worksheet.merge_range(
            'I35:Q36', 'FECHA PROBABLE DE PARTO / FECHA DE PARTO',
            item_section)
        worksheet.merge_range('I38:Q42', 'FECHA DE NACIMIENTO ', item_section)
        worksheet.merge_range(
            'I45:Q47', 'FECHA DE FALLECIMIENTO', item_section)

        fecha_nacimiento = self.control.paciente.fecha_nacimiento

        if fecha_nacimiento.day / 10 < 1:
            nacimiento_dia = '0' + str(fecha_nacimiento.day)
        else:
            nacimiento_dia = str(fecha_nacimiento.day)

        if fecha_nacimiento.month / 10 < 1:
            nacimiento_mes = '0' + str(fecha_nacimiento.month)
        else:
            nacimiento_mes = str(fecha_nacimiento.month)

        nacimiento_anio = str(fecha_nacimiento.year)

        fecha_probable_parto = self.control.fecha_probable_parto

        if fecha_probable_parto.month / 10 < 1:
            parto_mes = '0' + str(fecha_probable_parto.month)
        else:
            parto_mes = str(fecha_probable_parto.month)

        if fecha_probable_parto.day / 10 < 1:
            parto_dia = '0' + str(fecha_probable_parto.day)
        else:
            parto_dia = str(fecha_probable_parto.day)

        parto_anio = str(fecha_probable_parto.year)

        worksheet.merge_range('R33:X34', 'DIA', subsection_format)
        worksheet.merge_range('R35:U36', parto_dia[0], item_16)
        worksheet.merge_range('V35:X36', parto_dia[1], item_16)
        worksheet.merge_range('R38:U42', nacimiento_dia[0], item_16)
        worksheet.merge_range('V38:X42', nacimiento_dia[1], item_16)
        worksheet.merge_range('R45:U47', '', item_16)
        worksheet.merge_range('V45:X47', '', item_16)
        worksheet.merge_range('Y33:AD34', 'MES', subsection_format)
        worksheet.merge_range('Y35:Z36', parto_mes[0], item_16)
        worksheet.merge_range('AA35:AD36', parto_mes[1], item_16)
        worksheet.merge_range('Y38:Z42', nacimiento_mes[0], item_16)
        worksheet.merge_range('AA38:AD42', nacimiento_mes[1], item_16)
        worksheet.merge_range('Y45:Z47', '', item_16)
        worksheet.merge_range('AA45:AD47', '', item_16)
        worksheet.merge_range('AE33:AP34', u'AÑO', subsection_format)
        worksheet.merge_range('AE35:AG36', parto_anio[0], item_16)
        worksheet.merge_range('AH35:AJ36', parto_anio[1], item_16)
        worksheet.merge_range('AK35:AN36', parto_anio[2], item_16)
        worksheet.merge_range('AO35:AP36', parto_anio[3], item_16)
        worksheet.merge_range('AE38:AG42', nacimiento_anio[0], item_16)
        worksheet.merge_range('AH38:AJ42', nacimiento_anio[1], item_16)
        worksheet.merge_range('AK38:AN42', nacimiento_anio[2], item_16)
        worksheet.merge_range('AO38:AP42', nacimiento_anio[3], item_16)
        worksheet.merge_range('AE45:AG47', '', item_16)
        worksheet.merge_range('AH45:AJ47', '', item_16)
        worksheet.merge_range('AK45:AN47', '', item_16)
        worksheet.merge_range('AO45:AP47', '', item_16)
        worksheet.merge_range(
            'AR33:BD34', u'N° DE HISTORIA CLÍNICA', subsection_format)
        worksheet.merge_range(
            'AR35:BD36',
            self.control.paciente.historias_clinicas.last().numero, item_16)
        worksheet.merge_range('BF33:BM34', 'ETNIA', subsection_format)
        worksheet.merge_range('BF35:BM36', self.control.paciente.etnia_nombre, item_16)
        worksheet.merge_range(
            'AR38:BG39', u'DNI / CNV / AFILIACIÓN DEL RN 1', item_section)
        worksheet.merge_range('BH38:BM39', '', item_16)
        worksheet.merge_range(
            'AR42:BG45', u'DNI / CNV / AFILIACIÓN DEL RN 2', item_section)
        worksheet.merge_range('BH42:BM45', '', item_16)
        worksheet.merge_range(
            'AR47:BG47', u'DNI / CNV / AFILIACIÓN DEL RN 3', item_section)
        worksheet.merge_range('BH47:BM47', '', item_16)
        worksheet.merge_range('A49:BM49', u'DE LA ATENCIÓN', section_format)
        worksheet.merge_range(
            'A51:R51', u'FECHA DE ATENCIÓN', subsection_format)
        worksheet.merge_range('A52:B53', 'DIA', item_section)
        worksheet.merge_range('A54:A58', '', item_16)
        worksheet.merge_range('B54:B58', '', item_16)
        worksheet.merge_range('C52:F53', 'MES', item_section)
        worksheet.merge_range('C54:C58', '', item_16)
        worksheet.merge_range('D54:F58', '', item_16)
        worksheet.merge_range('G52:R53', u'AÑO', item_section)
        worksheet.merge_range('G54:K58', '', item_16)
        worksheet.merge_range('L54:M58', '', item_16)
        worksheet.merge_range('N54:O58', '', item_16)
        worksheet.merge_range('P54:R58', '', item_16)
        worksheet.merge_range('T51:Y52', 'HORA', subsection_format)
        worksheet.merge_range('T53:W58', '', item_16)
        worksheet.merge_range('X53:X58', ':', item_16)
        worksheet.merge_range('Y53:Y58', '', item_16)
        worksheet.merge_range(
            'A61:K62', 'REPORTE VINCULADO', subsection_format)
        worksheet.merge_range(
            'L61:Y61', u'CÓD. AUTORIZACIÓN', subsection_format)
        worksheet.merge_range('L62:Y62', '', item_16)
        worksheet.merge_range('AA51:AE52', 'UPS', subsection_format)
        worksheet.merge_range('AA53:AE58', '', check_format)
        worksheet.merge_range('AG51:AI52', u'CÓD. PRESTA.', subsection_format)
        worksheet.merge_range('AG53:AI58', '071', item_16)
        worksheet.merge_range(
            'AK51:AT52', u'CÓD. PRESTACION(ES) ADICIONAL (ES)',
            subsection_format)
        worksheet.merge_range('AK53:AT58', '', item_16)
        worksheet.merge_range(
            'AA61:AT61', u'N° FUA A VINCULAR', subsection_format)
        worksheet.merge_range('AA62:AT62', '', item_16)
        worksheet.merge_range('AW51:AY62', u'HOSPITALIZACIÓN', item_rotated)
        worksheet.merge_range('AZ51:BE51', 'FECHA', subsection_format)
        worksheet.merge_range('AZ52:BE54', 'DE INGRESO', item_section)
        worksheet.merge_range('AZ56:BE59', 'DE ALTA', item_section)
        worksheet.merge_range(
            'AZ61:BE62', 'DE CORTE ADMINISTRATIVO', item_section)
        worksheet.merge_range('BF51:BG51', 'DIA', subsection_format)
        worksheet.merge_range('BF52:BF54', '', item_16)
        worksheet.merge_range('BG52:BG54', '', item_16)
        worksheet.merge_range('BF56:BF59', '', item_16)
        worksheet.merge_range('BG56:BG59', '', item_16)
        worksheet.merge_range('BF61:BF62', '', item_16)
        worksheet.merge_range('BG61:BG62', '', item_16)
        worksheet.merge_range('BH51:BI51', 'MES', subsection_format)
        worksheet.merge_range('BH52:BH54', '', item_16)
        worksheet.merge_range('BI52:BI54', '', item_16)
        worksheet.merge_range('BH56:BH59', '', item_16)
        worksheet.merge_range('BI56:BI59', '', item_16)
        worksheet.merge_range('BH61:BH62', '', item_16)
        worksheet.merge_range('BI61:BI62', '', item_16)
        worksheet.merge_range('BJ51:BM51', u'AÑO', subsection_format)
        worksheet.merge_range('BJ52:BJ54', '', item_16)
        worksheet.merge_range('BK52:BK54', '', item_16)
        worksheet.merge_range('BL52:BL54', '', item_16)
        worksheet.merge_range('BM52:BM54', '', item_16)
        worksheet.merge_range('BJ56:BJ59', '', item_16)
        worksheet.merge_range('BK56:BK59', '', item_16)
        worksheet.merge_range('BL56:BL59', '', item_16)
        worksheet.merge_range('BM56:BM59', '', item_16)
        worksheet.merge_range('BJ61:BJ62', '', item_16)
        worksheet.merge_range('BK61:BK62', '', item_16)
        worksheet.merge_range('BL61:BL62', '', item_16)
        worksheet.merge_range('BM61:BM62', '', item_16)
        worksheet.merge_range(
            'A64:BM64', 'CONCEPTO PRESTACIONAL', section_format)
        worksheet.merge_range(
            'A65:C67', u'ATENCIÓN DIRECTA', subsection_format)
        worksheet.merge_range('D65:F67', '', check_format)
        worksheet.merge_range(
            'G65:X65', 'COB EXTRAORDINARIA', subsection_format)
        worksheet.merge_range('G66:O66', u'Nº Autorización', label_item)
        worksheet.merge_range('P66:X66', '', item_16)
        worksheet.merge_range('G67:N67', 'Monto S/.', label_item)
        worksheet.merge_range('O67:X67', '', item_16)
        worksheet.merge_range(
            'Y65:AK65', 'CARTA DE GARANTIA', subsection_format)
        worksheet.merge_range('Y66:AE66', u'Nº Autorización', label_item)
        worksheet.merge_range('AF66:AK66', '', item_16)
        worksheet.merge_range('Y67:AD67', 'Monto S/.', label_item)
        worksheet.merge_range('AE67:AK67', '', item_16)
        worksheet.merge_range('AL65:AQ67', 'TRASLADO', section_format)
        worksheet.merge_range('AR65:AS67', '', item_16)
        worksheet.merge_range('AT65:BM65', 'SEPELIO', subsection_format)
        worksheet.merge_range('AT66:BA67', 'NATIMUERTO', subsection_format)
        worksheet.merge_range('BB66:BD67', '', item_16)
        worksheet.merge_range('BE66:BG67', 'OBITO', subsection_format)
        worksheet.merge_range('BH66:BI67', '', item_16)
        worksheet.merge_range('BJ66:BK67', 'OTRO', subsection_format)
        worksheet.merge_range('BL66:BM67', '', item_16)
        worksheet.merge_range(
            'A69:BM69', 'DEL DESTINO DEL ASEGURADO/USUARIO', section_format)
        worksheet.merge_range('A70:A71', 'ALTA', label_item)
        worksheet.merge_range('B70:B71', '', item_16)
        worksheet.merge_range('C70:F71', 'CITA', label_item)
        worksheet.merge_range('G70:K71', 'X', check_format)
        worksheet.merge_range('L70:Q71', u'HOSPITALIZACIÓN', label_item)
        worksheet.merge_range('R70:S71', '', item_16)
        worksheet.merge_range('T70:AW70', 'REFERIDO', subsection_format)
        worksheet.merge_range('T71:Y71', 'EMERGENCIA', label_item)
        worksheet.merge_range('Z71:AA71', '', check_format)
        worksheet.merge_range('AB71:AI71', 'CONSULTA EXTERNA', label_item)
        worksheet.merge_range('AJ71:AL71', '', check_format)
        worksheet.merge_range('AM71:AT71', u'APOYO AL DIAGNÓSTICO', label_item)
        worksheet.merge_range('AU71:AW71', '', check_format)
        worksheet.merge_range('AX70:BC71', 'CONTRA REFERIDO', label_item)
        worksheet.merge_range('BD70:BD71', '', check_format)
        worksheet.merge_range('BE70:BH71', 'FALLECIDO', label_item)
        worksheet.merge_range('BI70:BI71', '', check_format)
        worksheet.merge_range('BJ70:BK71', 'CORTE ADMINIS.', label_item)
        worksheet.merge_range('BL70:BM71', '', check_format)
        worksheet.merge_range(
            'A73:BM73', 'SE REFIERE / CONTRARREFIERE A:', section_format)
        worksheet.merge_range(
            'A74:M74', u'CÓDIGO RENAES DE LA IPRESS', subsection_format)
        worksheet.merge_range('A75:M75', '', item_16)
        worksheet.merge_range(
            'N74:BC74',
            'NOMBRE DE LA IPRESS A LA QUE SE REFIERE / CONTRARREFIERE',
            subsection_format)
        worksheet.merge_range('N75:BC75', '', item_16)
        worksheet.merge_range(
            'BD74:BM74', u'N° HOJA DE REFER / CONTRARR.', subsection_format)
        worksheet.merge_range('BD75:BM75', '', item_16)
        worksheet.merge_range(
            'A77:AR77', 'ACTIVIDADES PREVENTIVAS Y OTROS', section_format)
        worksheet.merge_range('A78:I78', 'PESO (Kg)', subsection_format)
        worksheet.merge_range('J78:N78', self.control.peso, item_16)
        worksheet.merge_range('O78:X78', 'TALLA (cm)', subsection_format)
        worksheet.merge_range('Y78:AB78', self.control.embarazo.talla, item_16)
        worksheet.merge_range('AC78:AM78', 'P.A. (mmHg)', subsection_format)
        worksheet.merge_range('AN78:AR78', self.control.presion_arterial, item_16)
        worksheet.merge_range('A79:D79', 'DE LA GESTANTE', subsection_format)
        worksheet.merge_range('A80:B82', u'CPN (N°)', item_section)
        worksheet.merge_range('C80:D82', '', item_16)
        worksheet.merge_range('A83:B84', 'EDAD GEST', item_section)
        worksheet.merge_range('C83:D84', str(self.control.calculate_edad_gestacional_semanas()), item_16)
        worksheet.merge_range('A85:B86', 'ALTURA UTERINA', item_section)

        if self.control.altura_uterina is None:
            worksheet.merge_range('C85:D86', '0', item_16)
        else:
            worksheet.merge_range('C85:D86', self.control.altura_uterina, item_16)

        worksheet.merge_range('A87:B88', 'PARTO VERTICAL', item_section)
        worksheet.merge_range('C87:D88', '', item_16)
        worksheet.merge_range('A89:B90', u'CONTROL PUERP (N°)', item_section)
        worksheet.merge_range('C89:D90', '', item_16)
        worksheet.merge_range(
            'F79:Q79', 'DEL RECIEN NACIDO', subsection_format)
        worksheet.merge_range('F80:N81', 'EDAD GEST RN (SEM)', item_section)
        worksheet.merge_range('O80:Q81', '', item_16)
        worksheet.merge_range('F83:K85', 'APGAR', item_section)
        worksheet.merge_range('L83:L85', u'1°', item_section)
        worksheet.merge_range('M83:M85', '', item_section)
        worksheet.merge_range('N83:N85', u'5°', item_section)
        worksheet.merge_range('O83:Q85', '', item_section)
        worksheet.merge_range(
            'F87:N88', u'Corte Tardío de Cordón (2 a 3 min)', item_section)
        worksheet.merge_range('O87:Q88', '', item_16)
        worksheet.merge_range('F90:P90', '3', item_section)
        worksheet.merge_range(
            'S79:AK79', u' / '.join([
                'GESTANTE', 'RN', u'NIÑO', 'ADOLESCENTE', 'JOVEN Y ADULTO',
                'ADULTO MAYOR']), subsection_format)
        worksheet.merge_range('S80:Z81', u'CRED N°', item_section)
        worksheet.merge_range('AA80:AA81', '', check_format)
        worksheet.merge_range('S83:Z83', 'R.N. PREMATURO', item_section)
        worksheet.write('AA83', '', check_format)
        worksheet.merge_range('S85:Z85', 'BAJO PESO AL NACER', item_section)
        worksheet.write('AA85', '', check_format)
        worksheet.merge_range(
            'S87:Z88', 'ENFER. CONGENITA / SECUELA AL NACER', item_section)
        worksheet.merge_range('AA87:AA88', '', check_format)
        worksheet.merge_range(
            'S90:Z90', u'N° FAMILIARES DE GEST / PUERP. CASA MAT.',
            item_section)
        worksheet.write('AA90', '', check_format)
        worksheet.merge_range('AC80:AG81', 'PAB (cm)', item_section)
        worksheet.merge_range('AH80:AK81', '', item_16)
        worksheet.merge_range('AC83:AH83', 'TAP / EEDP o TEPSI', item_section)
        worksheet.merge_range('AI83:AK83', '', item_16)
        worksheet.merge_range(
            'AC85:AH85', 'CONSEJERIA NUTRICIONAL', item_section)
        worksheet.merge_range('AI85:AK85', '', item_16)
        worksheet.merge_range('AC87:AH88', 'CONSEJERIA INTEGRAL', item_section)
        worksheet.merge_range('AI87:AK88', '', item_16)
        worksheet.merge_range('AC90:AH90', '', item_section)
        worksheet.write_rich_string(
            'AC90', label_item, 'IMC (Kg/M', superscript, '2', label_item,
            ')', item_section)
        worksheet.merge_range('AI90:AK90', self.control.imc, item_16)
        worksheet.merge_range('AM79:AR79', 'JOVEN Y ADULTO', label_item)
        worksheet.merge_range(
            'AM80:AP81', u'EVALUACIÓN INTEGRAL', item_section)
        worksheet.merge_range('AQ80:AR81', '', item_16)
        worksheet.merge_range('AM83:AR83', 'ADULTO MAYOR', label_item)
        worksheet.merge_range('AM84:AP85', 'VACAM', item_section)
        worksheet.merge_range('AQ84:AR85', '', item_16)
        worksheet.merge_range(
            'AM87:AP88', 'TAMIZAJE DE SALUD MENTAL', item_section)
        worksheet.merge_range('AQ87:AR87', 'PAT.', item_section)
        worksheet.merge_range('AQ88:AR88', 'NOR.', item_section)
        worksheet.merge_range('AM90:AR90', '', item_16)
        worksheet.merge_range(
            'AT77:BM77', u'VACUNAS N° DE DOSIS', section_format)
        worksheet.merge_range('AT78:AY78', 'BCG', item_section)
        worksheet.merge_range('AZ78:BB78', '', item_16)
        worksheet.merge_range('AT79:AY80', 'DPT', item_section)
        worksheet.merge_range('AZ79:BB80', '', item_16)
        worksheet.merge_range('AT81:AY82', 'APO', item_section)
        worksheet.merge_range('AZ81:BB82', '', item_16)
        worksheet.merge_range('AT83:AY84', 'ASA', item_section)
        worksheet.merge_range('AZ83:BB84', '', item_16)
        worksheet.merge_range('AT85:AY85', 'SPR', item_section)
        worksheet.merge_range('AZ85:BB85', '', item_16)
        worksheet.merge_range('AT86:AY87', 'SR', item_section)
        worksheet.merge_range('AZ86:BB87', '', item_16)
        worksheet.merge_range('AT88:AY89', 'HVB', item_section)
        worksheet.merge_range('AZ88:BB89', '', item_16)
        worksheet.merge_range('BC78:BF78', 'INFLUENZA', item_section)
        worksheet.merge_range('BG78:BH78', '', item_16)
        worksheet.merge_range('BC79:BF80', 'PAROTID', item_section)
        worksheet.merge_range('BG79:BH80', '', item_16)
        worksheet.merge_range('BC81:BF82', 'RUBEOLA', item_section)
        worksheet.merge_range('BG81:BH82', '', item_16)
        worksheet.merge_range('BC83:BF84', 'ROTAVIRUS', item_section)
        worksheet.merge_range('BG83:BH84', '', item_16)
        worksheet.merge_range(
            'BC85:BF85', u'DT ADULTO (N° DOSIS)', item_section)
        worksheet.merge_range('BG85:BH85', '', item_16)
        worksheet.merge_range('BC86:BF87', 'IPV', item_section)
        worksheet.merge_range('BG86:BH87', '', item_16)
        worksheet.merge_range('BC88:BF89', 'PENTAVAL', item_section)
        worksheet.merge_range('BG88:BH89', '', item_16)
        worksheet.merge_range('BI78:BK78', 'ANTIAMARILICA', item_section)
        worksheet.merge_range('BL78:BM78', '', item_16)
        worksheet.merge_range('BI79:BK80', 'ANTINEUMOC', item_section)
        worksheet.merge_range('BL79:BM80', '', item_16)
        worksheet.merge_range('BI81:BK82', 'ANTITETANICA', item_section)
        worksheet.merge_range('BL81:BM82', '', item_16)
        worksheet.merge_range(
            'BI83:BK84', ' COMPLETAS PARA LA EDAD', item_section)
        worksheet.merge_range('BL83:BL84', 'SI', item_section)
        worksheet.merge_range('BM83:BM84', 'NO', item_section)
        worksheet.merge_range('BI85:BK85', 'VPH', item_section)
        worksheet.merge_range('BL85:BM85', '', item_16)
        worksheet.merge_range('BI86:BK87', 'OTRA VACUNA', item_section)
        worksheet.merge_range('BL86:BM87', '', item_16)
        worksheet.merge_range('BI88:BK89', '____________', item_section)
        worksheet.merge_range('BL88:BM89', '', item_16)
        worksheet.merge_range('AT90:AZ90', 'GRUPO DE RIESGO HVB', item_section)
        worksheet.merge_range('BA90:BC90', '', item_16)
        worksheet.merge_range('BD90:BM90', '   '.join([
            'GRUPO DE RIESGO HVB: 1. TRABAJADOR DE SALUD',
            '2. TRABAJAD. SEXUALES', '3. HSH', '4. PRIVADO LIBERTAD',
            '5. FF. AA.', '6. POLICIA NACIONAL', '7. ESTUDIANTES DE SALUD',
            '8. POLITRANFUNDIDOS', '9. DROGO DEPENDIENTES ']), formato_leyenda)
        worksheet.merge_range('A93:BM93', '10', section_format)
        worksheet.merge_range('A94:A95', u'N°', subsection_format)
        worksheet.write('A96', '1', item_section)
        worksheet.write('A97', '2', item_section)
        worksheet.write('A98', '3', item_section)
        worksheet.write('A99', '4', item_section)
        worksheet.write('A100', '5', item_section)
        worksheet.merge_range('B94:AN95', u'DESCRIPCIÓN', subsection_format)
        worksheet.merge_range('B96:AN96', '', item_section)
        worksheet.merge_range('B97:AN97', '', item_section)
        worksheet.merge_range('B98:AN98', '', item_section)
        worksheet.merge_range('B99:AN99', '', item_section)
        worksheet.merge_range('B100:AN100', '', item_section)
        worksheet.merge_range('AO94:BD94', 'INGRESO', subsection_format)
        worksheet.merge_range('AO95:AW95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('AO96:AP96', 'P', item_section)
        worksheet.merge_range('AQ96:AS96', 'D', item_section)
        worksheet.merge_range('AT96:AW96', 'R', item_section)
        worksheet.merge_range('AO97:AP97', 'P', item_section)
        worksheet.merge_range('AQ97:AS97', 'D', item_section)
        worksheet.merge_range('AT97:AW97', 'R', item_section)
        worksheet.merge_range('AO98:AP98', 'P', item_section)
        worksheet.merge_range('AQ98:AS98', 'D', item_section)
        worksheet.merge_range('AT98:AW98', 'R', item_section)
        worksheet.merge_range('AO99:AP99', 'P', item_section)
        worksheet.merge_range('AQ99:AS99', 'D', item_section)
        worksheet.merge_range('AT99:AW99', 'R', item_section)
        worksheet.merge_range('AO100:AP100', 'P', item_section)
        worksheet.merge_range('AQ100:AS100', 'D', item_section)
        worksheet.merge_range('AT100:AW100', 'R', item_section)
        worksheet.merge_range('AX95:BD95', 'CIE - 10', subsection_format)
        worksheet.merge_range('AX96:BD96', '', item_16)
        worksheet.merge_range('AX97:BD97', '', item_16)
        worksheet.merge_range('AX98:BD98', '', item_16)
        worksheet.merge_range('AX99:BD99', '', item_16)
        worksheet.merge_range('AX100:BD100', '', item_16)
        worksheet.merge_range('BE94:BM94', 'EGRESO', subsection_format)
        worksheet.merge_range('BE95:BI95', 'TIPO DE DX', subsection_format)
        worksheet.merge_range('BE96:BG96', 'D', item_section)
        worksheet.merge_range('BH96:BI96', 'R', item_section)
        worksheet.merge_range('BE97:BG97', 'D', item_section)
        worksheet.merge_range('BH97:BI97', 'R', item_section)
        worksheet.merge_range('BE98:BG98', 'D', item_section)
        worksheet.merge_range('BH98:BI98', 'R', item_section)
        worksheet.merge_range('BE99:BG99', 'D', item_section)
        worksheet.merge_range('BH99:BI99', 'R', item_section)
        worksheet.merge_range('BE100:BG100', 'D', item_section)
        worksheet.merge_range('BH100:BI100', 'R', item_section)
        worksheet.merge_range('BJ95:BM95', 'CIE - 10', subsection_format)
        worksheet.merge_range('BJ96:BM96', '', item_16)
        worksheet.merge_range('BJ97:BM97', '', item_16)
        worksheet.merge_range('BJ98:BM98', '', item_16)
        worksheet.merge_range('BJ99:BM99', '', item_16)
        worksheet.merge_range('BJ100:BM100', '', item_16)
        worksheet.merge_range('A102:N102', u'N° DE DNI', section_format)
        worksheet.merge_range('A103:N103', self.request.user.dni, item_16)
        worksheet.merge_range(
            'O102:BE102', u'NOMBRE DEL RESPONSABLE DE LA ATENCIÓN',
            section_format)
        worksheet.merge_range(
            'O103:BE103', self.request.user.get_full_name(), item_16)
        worksheet.merge_range(
            'BF102:BM102', u'N° DE COLEGIATURA', section_format)
        worksheet.merge_range(
            'BF103:BM103', self.request.user.colegiatura, item_16)
        worksheet.merge_range(
            'A105:N105', u'RESPONSABLE DE LA ATENCIÓN', subsection_format)
        worksheet.merge_range('O105:Q105', '', item_section)
        worksheet.merge_range('R105:Y105', 'ESPECIALIDAD', subsection_format)
        worksheet.merge_range('Z105:AT105', '', item_section)
        worksheet.merge_range('AU105:AZ105', u'N° RNE', subsection_format)
        worksheet.merge_range('BA105:BE105', '', item_section)
        worksheet.merge_range('BF105:BK105', 'EGRESADO', subsection_format)
        worksheet.merge_range('BL105:BM105', '', item_16)
        worksheet.merge_range('A106:BM107', u'   '.join([
            u'1. MÉDICO', '2. FARMACEUTICO', '3. CIRUJANO DENTISTA',
            u'4. BIÓLOGO', '5. OBSTETRIZ', '6. ENFERMERA',
            '7. TRABAJADORA SOCIAL', '8. PSICOLOGA', '9.TECNOLOGO MEDICO',
            '10.NUTRICION', '11. TECNICO ENFERMERIA',
            '12. AUXILIAR DE ENFERMERIA', '13. OTRO']), formato_leyenda_8)
        worksheet.merge_range('B119:Y119', '', subrayado)
        worksheet.merge_range(
            'B121:Y121', u'FIRMA Y SELLO DEL RESPONSABLE DE LA ATENCIÓN ',
            responsable_formato)
        worksheet.merge_range('AH108:AM109', 'FIRMA', responsable_formato)
        worksheet.merge_range('AH110:AM111', 'ASEGURADO', responsable_formato)
        worksheet.merge_range('AO110:AP111', '', item_16)
        worksheet.merge_range('AH112:AM113', 'APODERADO', responsable_formato)
        worksheet.merge_range('AO112:AP113', '', item_16)
        worksheet.write('AH117', 'APODERADO:', responsable_formato)
        worksheet.merge_range('AQ117:BE117', '', subrayado)
        worksheet.write('AH118', 'NOMBRES Y APELLIDOS', responsable_formato)
        worksheet.merge_range('AQ118:BE118', '', subrayado)
        worksheet.write(
            'AH121', 'DNI o CE DEL APODERADO:', responsable_formato)
        worksheet.merge_range('AR121:BE121', '', subrayado)

        worksheet.merge_range('BH109:BL120', '', item_16)

        worksheet.merge_range(
            'BG122:BL124', 'Huella Digital del Asegurado o del Apoderado',
            item_section)

        reverso = workbook.add_worksheet('FUA071R')
        reverso.fit_to_pages(1, 1)
        reverso.set_portrait()

        self.set_back_column_dimension(reverso)
        self.set_back_row_dimension(reverso)

        titulo_reverse = workbook.add_format()
        self.bold_pattern_common(titulo_reverse)
        titulo_reverse.set_bg_color('#D9D9D9')
        titulo_reverse.set_font_size(22)

        subtitulo_reverse = workbook.add_format()
        self.bold_pattern_common(subtitulo_reverse)
        subtitulo_reverse.set_bg_color('#D9D9D9')
        subtitulo_reverse.set_font_size(20)

        item_reverso = workbook.add_format()
        self.bold_common(item_reverso)
        item_reverso.set_font_size(20)

        firma_reverso = workbook.add_format()
        firma_reverso.set_align('center')
        firma_reverso.set_align('vcenter')
        firma_reverso.set_bold()
        firma_reverso.set_font_name('Arial')
        firma_reverso.set_font_size(24)
        firma_reverso.set_text_wrap()
        firma_reverso.set_top()

        reverso.merge_range(
            'T1:AC1', u'FORMATO DE ATENCIÓN Nº', titulo_reverse)
        reverso.merge_range('T2:V2', '', item_16)
        reverso.merge_range('W2:Y2', '', item_16)
        reverso.merge_range('Z2:AC2', '', item_16)
        reverso.merge_range(
            'A4:AC4', 'PRODUCTOS FARMACEUTICOS / MEDICAMENTOS', titulo_reverse)
        reverso.merge_range('A5:B5', u'CÓDIGO SISMED', subtitulo_reverse)
        reverso.merge_range('C5:J5', 'NOMBRE', subtitulo_reverse)
        reverso.write('K5', 'FF', subtitulo_reverse)
        reverso.write('L5', 'CONCENTR', subtitulo_reverse)
        reverso.write('M5', 'PRES', subtitulo_reverse)
        reverso.write('N5', 'ENTR', subtitulo_reverse)
        reverso.write('O5', 'DX', subtitulo_reverse)
        reverso.merge_range('P5:Q5', u'CÓD. SISMED', subtitulo_reverse)
        reverso.merge_range('R5:X5', 'NOMBRE', subtitulo_reverse)
        reverso.write('Y5', 'FF', subtitulo_reverse)
        reverso.write('Z5', 'CONCENTR', subtitulo_reverse)
        reverso.write('AA5', 'PRES', subtitulo_reverse)
        reverso.write('AB5', 'ENTR', subtitulo_reverse)
        reverso.write('AC5', 'DX', subtitulo_reverse)
        reverso.merge_range('A6:B6', '', item_reverso)
        reverso.merge_range('C6:J6', '', item_reverso)
        reverso.write('L6', '', item_reverso)
        reverso.write('K6', '', item_reverso)
        reverso.write('M6', '', item_reverso)
        reverso.write('N6', '', item_reverso)
        reverso.write('O6', '', item_reverso)
        reverso.write('Y6', '', item_reverso)
        reverso.write('Z6', '', item_reverso)
        reverso.write('AA6', '', item_reverso)
        reverso.write('AB6', '', item_reverso)
        reverso.write('AC6', '', item_reverso)
        reverso.merge_range('A7:B7', '', item_reverso)
        reverso.merge_range('A8:B8', '', item_reverso)
        reverso.merge_range('A9:B9', '', item_reverso)
        reverso.merge_range('A10:B10', '', item_reverso)
        reverso.merge_range('A11:B11', '', item_reverso)
        reverso.merge_range('A12:B12', '', item_reverso)
        reverso.merge_range('A13:B13', '', item_reverso)
        reverso.merge_range('A14:B14', '', item_reverso)
        reverso.merge_range('A15:B15', '', item_reverso)
        reverso.merge_range('A16:B16', '', item_reverso)
        reverso.merge_range('A17:B17', '', item_reverso)
        reverso.merge_range('A18:B18', '', item_reverso)
        reverso.merge_range('C7:J7', '', item_reverso)
        reverso.merge_range('C8:J8', '', item_reverso)
        reverso.merge_range('C9:J9', '', item_reverso)
        reverso.merge_range('C10:J10', '', item_reverso)
        reverso.merge_range('C11:J11', '', item_reverso)
        reverso.merge_range('C12:J12', '', item_reverso)
        reverso.merge_range('C13:J13', '', item_reverso)
        reverso.merge_range('C14:J14', '', item_reverso)
        reverso.merge_range('C15:J15', '', item_reverso)
        reverso.merge_range('C16:J16', '', item_reverso)
        reverso.merge_range('C17:J17', '', item_reverso)
        reverso.merge_range('C18:J18', '', item_reverso)
        reverso.write('K7', '', item_reverso)
        reverso.write('K8', '', item_reverso)
        reverso.write('K9', '', item_reverso)
        reverso.write('K10', '', item_reverso)
        reverso.write('K11', '', item_reverso)
        reverso.write('K12', '', item_reverso)
        reverso.write('K13', '', item_reverso)
        reverso.write('K14', '', item_reverso)
        reverso.write('K15', '', item_reverso)
        reverso.write('K16', '', item_reverso)
        reverso.write('K17', '', item_reverso)
        reverso.write('K18', '', item_reverso)
        reverso.write('L7', '', item_reverso)
        reverso.write('L8', '', item_reverso)
        reverso.write('L9', '', item_reverso)
        reverso.write('L10', '', item_reverso)
        reverso.write('L11', '', item_reverso)
        reverso.write('L12', '', item_reverso)
        reverso.write('L13', '', item_reverso)
        reverso.write('L14', '', item_reverso)
        reverso.write('L15', '', item_reverso)
        reverso.write('L16', '', item_reverso)
        reverso.write('L17', '', item_reverso)
        reverso.write('L18', '', item_reverso)
        reverso.write('M7', '', item_reverso)
        reverso.write('M8', '', item_reverso)
        reverso.write('M9', '', item_reverso)
        reverso.write('M10', '', item_reverso)
        reverso.write('M11', '', item_reverso)
        reverso.write('M12', '', item_reverso)
        reverso.write('M13', '', item_reverso)
        reverso.write('M14', '', item_reverso)
        reverso.write('M15', '', item_reverso)
        reverso.write('M16', '', item_reverso)
        reverso.write('M17', '', item_reverso)
        reverso.write('M18', '', item_reverso)
        reverso.write('N7', '', item_reverso)
        reverso.write('N8', '', item_reverso)
        reverso.write('N9', '', item_reverso)
        reverso.write('N10', '', item_reverso)
        reverso.write('N11', '', item_reverso)
        reverso.write('N12', '', item_reverso)
        reverso.write('N13', '', item_reverso)
        reverso.write('N14', '', item_reverso)
        reverso.write('N15', '', item_reverso)
        reverso.write('N16', '', item_reverso)
        reverso.write('N17', '', item_reverso)
        reverso.write('N18', '', item_reverso)
        reverso.write('O7', '', item_reverso)
        reverso.write('O8', '', item_reverso)
        reverso.write('O9', '', item_reverso)
        reverso.write('O10', '', item_reverso)
        reverso.write('O11', '', item_reverso)
        reverso.write('O12', '', item_reverso)
        reverso.write('O13', '', item_reverso)
        reverso.write('O14', '', item_reverso)
        reverso.write('O15', '', item_reverso)
        reverso.write('O16', '', item_reverso)
        reverso.write('O17', '', item_reverso)
        reverso.write('O18', '', item_reverso)
        reverso.write('Y7', '', item_reverso)
        reverso.write('Y8', '', item_reverso)
        reverso.write('Y9', '', item_reverso)
        reverso.write('Y10', '', item_reverso)
        reverso.write('Y11', '', item_reverso)
        reverso.write('Y12', '', item_reverso)
        reverso.write('Y13', '', item_reverso)
        reverso.write('Y14', '', item_reverso)
        reverso.write('Y15', '', item_reverso)
        reverso.write('Y16', '', item_reverso)
        reverso.write('Y17', '', item_reverso)
        reverso.write('Y18', '', item_reverso)
        reverso.write('Z7', '', item_reverso)
        reverso.write('Z8', '', item_reverso)
        reverso.write('Z9', '', item_reverso)
        reverso.write('Z10', '', item_reverso)
        reverso.write('Z11', '', item_reverso)
        reverso.write('Z12', '', item_reverso)
        reverso.write('Z13', '', item_reverso)
        reverso.write('Z14', '', item_reverso)
        reverso.write('Z15', '', item_reverso)
        reverso.write('Z16', '', item_reverso)
        reverso.write('Z17', '', item_reverso)
        reverso.write('Z18', '', item_reverso)
        reverso.write('AA7', '', item_reverso)
        reverso.write('AA8', '', item_reverso)
        reverso.write('AA9', '', item_reverso)
        reverso.write('AA10', '', item_reverso)
        reverso.write('AA11', '', item_reverso)
        reverso.write('AA12', '', item_reverso)
        reverso.write('AA13', '', item_reverso)
        reverso.write('AA14', '', item_reverso)
        reverso.write('AA15', '', item_reverso)
        reverso.write('AA16', '', item_reverso)
        reverso.write('AA17', '', item_reverso)
        reverso.write('AA18', '', item_reverso)
        reverso.write('AB7', '', item_reverso)
        reverso.write('AB8', '', item_reverso)
        reverso.write('AB9', '', item_reverso)
        reverso.write('AB10', '', item_reverso)
        reverso.write('AB11', '', item_reverso)
        reverso.write('AB12', '', item_reverso)
        reverso.write('AB13', '', item_reverso)
        reverso.write('AB14', '', item_reverso)
        reverso.write('AB15', '', item_reverso)
        reverso.write('AB16', '', item_reverso)
        reverso.write('AB17', '', item_reverso)
        reverso.write('AB18', '', item_reverso)
        reverso.write('AC7', '', item_reverso)
        reverso.write('AC8', '', item_reverso)
        reverso.write('AC9', '', item_reverso)
        reverso.write('AC10', '', item_reverso)
        reverso.write('AC11', '', item_reverso)
        reverso.write('AC12', '', item_reverso)
        reverso.write('AC13', '', item_reverso)
        reverso.write('AC14', '', item_reverso)
        reverso.write('AC15', '', item_reverso)
        reverso.write('AC16', '', item_reverso)
        reverso.write('AC17', '', item_reverso)
        reverso.write('AC18', '', item_reverso)
        reverso.merge_range(
            'A19:AC19', u'DISPOSITIVOS MÉDICOS / PRODUCTOS SANITARIOS',
            titulo_reverse)
        reverso.merge_range('A20:B20', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A21:B21', '', item_reverso)
        reverso.merge_range('A22:B22', '', item_reverso)
        reverso.merge_range('A23:B23', '', item_reverso)
        reverso.merge_range('A24:B24', '', item_reverso)
        reverso.merge_range('A25:B25', '', item_reverso)
        reverso.merge_range('A26:B26', '', item_reverso)
        reverso.merge_range('A27:B27', '', item_reverso)
        reverso.merge_range('A28:B28', '', item_reverso)
        reverso.merge_range('A29:B29', '', item_reverso)
        reverso.merge_range('C20:J20', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C21:J21', '', item_reverso)
        reverso.merge_range('C22:J22', '', item_reverso)
        reverso.merge_range('C23:J23', '', item_reverso)
        reverso.merge_range('C24:J24', '', item_reverso)
        reverso.merge_range('C25:J25', '', item_reverso)
        reverso.merge_range('C26:J26', '', item_reverso)
        reverso.merge_range('C27:J27', '', item_reverso)
        reverso.merge_range('C28:J28', '', item_reverso)
        reverso.merge_range('C29:J29', '', item_reverso)
        reverso.write('K20', 'PR', subtitulo_reverse)
        reverso.write('K21', '', item_reverso)
        reverso.write('K22', '', item_reverso)
        reverso.write('K23', '', item_reverso)
        reverso.write('K24', '', item_reverso)
        reverso.write('K25', '', item_reverso)
        reverso.write('K26', '', item_reverso)
        reverso.write('K27', '', item_reverso)
        reverso.write('K28', '', item_reverso)
        reverso.write('K29', '', item_reverso)
        reverso.write('L20', 'CARACT', subtitulo_reverse)
        reverso.write('L21', '', item_reverso)
        reverso.write('L22', '', item_reverso)
        reverso.write('L23', '', item_reverso)
        reverso.write('L24', '', item_reverso)
        reverso.write('L25', '', item_reverso)
        reverso.write('L26', '', item_reverso)
        reverso.write('L27', '', item_reverso)
        reverso.write('L28', '', item_reverso)
        reverso.write('L29', '', item_reverso)
        reverso.write('M20', 'PRES', subtitulo_reverse)
        reverso.write('M21', '', item_reverso)
        reverso.write('M22', '', item_reverso)
        reverso.write('M23', '', item_reverso)
        reverso.write('M24', '', item_reverso)
        reverso.write('M25', '', item_reverso)
        reverso.write('M26', '', item_reverso)
        reverso.write('M27', '', item_reverso)
        reverso.write('M28', '', item_reverso)
        reverso.write('M29', '', item_reverso)
        reverso.write('N20', 'ENTR', subtitulo_reverse)
        reverso.write('N21', '', item_reverso)
        reverso.write('N22', '', item_reverso)
        reverso.write('N23', '', item_reverso)
        reverso.write('N24', '', item_reverso)
        reverso.write('N25', '', item_reverso)
        reverso.write('N26', '', item_reverso)
        reverso.write('N27', '', item_reverso)
        reverso.write('N28', '', item_reverso)
        reverso.write('N29', '', item_reverso)
        reverso.write('O20', 'DX', subtitulo_reverse)
        reverso.write('O21', '', item_reverso)
        reverso.write('O22', '', item_reverso)
        reverso.write('O23', '', item_reverso)
        reverso.write('O24', '', item_reverso)
        reverso.write('O25', '', item_reverso)
        reverso.write('O26', '', item_reverso)
        reverso.write('O27', '', item_reverso)
        reverso.write('O28', '', item_reverso)
        reverso.write('O29', '', item_reverso)
        reverso.merge_range('P20:Q20', u'CÓDIGO', subtitulo_reverse)

        reverso.merge_range('R20:X20', 'NOMBRE', subtitulo_reverse)

        reverso.write('Y20', 'PR', subtitulo_reverse)
        reverso.write('Y21', '', item_reverso)
        reverso.write('Y22', '', item_reverso)
        reverso.write('Y23', '', item_reverso)
        reverso.write('Y24', '', item_reverso)
        reverso.write('Y25', '', item_reverso)
        reverso.write('Y26', '', item_reverso)
        reverso.write('Y27', '', item_reverso)
        reverso.write('Y28', '', item_reverso)
        reverso.write('Y29', '', item_reverso)
        reverso.write('Z20', 'CARACT', subtitulo_reverse)
        reverso.write('Z21', '', item_reverso)
        reverso.write('Z22', '', item_reverso)
        reverso.write('Z23', '', item_reverso)
        reverso.write('Z24', '', item_reverso)
        reverso.write('Z25', '', item_reverso)
        reverso.write('Z26', '', item_reverso)
        reverso.write('Z27', '', item_reverso)
        reverso.write('Z28', '', item_reverso)
        reverso.write('Z29', '', item_reverso)
        reverso.write('AA20', 'PRES', subtitulo_reverse)
        reverso.write('AA21', '', item_reverso)
        reverso.write('AA22', '', item_reverso)
        reverso.write('AA23', '', item_reverso)
        reverso.write('AA24', '', item_reverso)
        reverso.write('AA25', '', item_reverso)
        reverso.write('AA26', '', item_reverso)
        reverso.write('AA27', '', item_reverso)
        reverso.write('AA28', '', item_reverso)
        reverso.write('AA29', '', item_reverso)
        reverso.write('AB20', 'ENTR', subtitulo_reverse)
        reverso.write('AB21', '', item_reverso)
        reverso.write('AB22', '', item_reverso)
        reverso.write('AB23', '', item_reverso)
        reverso.write('AB24', '', item_reverso)
        reverso.write('AB25', '', item_reverso)
        reverso.write('AB26', '', item_reverso)
        reverso.write('AB27', '', item_reverso)
        reverso.write('AB28', '', item_reverso)
        reverso.write('AB29', '', item_reverso)
        reverso.write('AC20', 'DX', subtitulo_reverse)
        reverso.write('AC21', '', item_reverso)
        reverso.write('AC22', '', item_reverso)
        reverso.write('AC23', '', item_reverso)
        reverso.write('AC24', '', item_reverso)
        reverso.write('AC25', '', item_reverso)
        reverso.write('AC26', '', item_reverso)
        reverso.write('AC27', '', item_reverso)
        reverso.write('AC28', '', item_reverso)
        reverso.write('AC29', '', item_reverso)
        reverso.merge_range(
            'A30:AC30',
            u'PROCEDIMIENTOS/ DIAGNÓSTICO POR IMÁGENES/ LABORATORIO',
            titulo_reverse)
        reverso.merge_range('A31:B31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A32:B32', '', item_reverso)
        reverso.merge_range('A33:B33', '', item_reverso)
        reverso.merge_range('A34:B34', '', item_reverso)
        reverso.merge_range('A35:B35', '', item_reverso)
        reverso.merge_range('A36:B36', '', item_reverso)
        reverso.merge_range('A37:B37', '', item_reverso)
        reverso.merge_range('A38:B38', '', item_reverso)
        reverso.merge_range('A39:B39', '', item_reverso)
        reverso.merge_range('A40:B40', '', item_reverso)
        reverso.merge_range('A41:B41', '', item_reverso)
        reverso.merge_range('A42:B42', '', item_reverso)
        reverso.merge_range('C31:K31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C32:K32', '', item_reverso)
        reverso.merge_range('C33:K33', '', item_reverso)
        reverso.merge_range('C34:K34', '', item_reverso)
        reverso.merge_range('C35:K35', '', item_reverso)
        reverso.merge_range('C36:K36', '', item_reverso)
        reverso.merge_range('C37:K37', '', item_reverso)
        reverso.merge_range('C38:K38', '', item_reverso)
        reverso.merge_range('C39:K39', '', item_reverso)
        reverso.merge_range('C40:K40', '', item_reverso)
        reverso.merge_range('C41:K41', '', item_reverso)
        reverso.merge_range('C42:K42', '', item_reverso)
        reverso.write('L31', 'IND', subtitulo_reverse)
        reverso.write('L32', '', item_reverso)
        reverso.write('L33', '', item_reverso)
        reverso.write('L34', '', item_reverso)
        reverso.write('L35', '', item_reverso)
        reverso.write('L36', '', item_reverso)
        reverso.write('L37', '', item_reverso)
        reverso.write('L38', '', item_reverso)
        reverso.write('L39', '', item_reverso)
        reverso.write('L40', '', item_reverso)
        reverso.write('L41', '', item_reverso)
        reverso.write('L42', '', item_reverso)
        reverso.write('M31', 'EJE', subtitulo_reverse)
        reverso.write('M32', '', item_reverso)
        reverso.write('M33', '', item_reverso)
        reverso.write('M34', '', item_reverso)
        reverso.write('M35', '', item_reverso)
        reverso.write('M36', '', item_reverso)
        reverso.write('M37', '', item_reverso)
        reverso.write('M38', '', item_reverso)
        reverso.write('M39', '', item_reverso)
        reverso.write('M40', '', item_reverso)
        reverso.write('M41', '', item_reverso)
        reverso.write('M42', '', item_reverso)
        reverso.write('N31', 'DX', subtitulo_reverse)
        reverso.write('N32', '', item_reverso)
        reverso.write('N33', '', item_reverso)
        reverso.write('N34', '', item_reverso)
        reverso.write('N35', '', item_reverso)
        reverso.write('N36', '', item_reverso)
        reverso.write('N37', '', item_reverso)
        reverso.write('N38', '', item_reverso)
        reverso.write('N39', '', item_reverso)
        reverso.write('N40', '', item_reverso)
        reverso.write('N41', '', item_reverso)
        reverso.write('N42', '', item_reverso)
        reverso.write('O31', 'RES', subtitulo_reverse)
        reverso.write('O32', '', item_reverso)
        reverso.write('O33', '', item_reverso)
        reverso.write('O34', '', item_reverso)
        reverso.write('O35', '', item_reverso)
        reverso.write('O36', '', item_reverso)
        reverso.write('O37', '', item_reverso)
        reverso.write('O38', '', item_reverso)
        reverso.write('O39', '', item_reverso)
        reverso.write('O40', '', item_reverso)
        reverso.write('O41', '', item_reverso)
        reverso.write('O42', '', item_reverso)
        reverso.merge_range('P31:Q31', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('P32:Q32', '', item_reverso)
        reverso.merge_range('P33:Q33', '', item_reverso)
        reverso.merge_range('P34:Q34', '', item_reverso)
        reverso.merge_range('P35:Q35', '', item_reverso)
        reverso.merge_range('P36:Q36', '', item_reverso)
        reverso.merge_range('P37:Q37', '', item_reverso)
        reverso.merge_range('P38:Q38', '', item_reverso)
        reverso.merge_range('P39:Q39', '', item_reverso)
        reverso.merge_range('P40:Q40', '', item_reverso)
        reverso.merge_range('P41:Q41', '', item_reverso)
        reverso.merge_range('P42:Q42', '', item_reverso)
        reverso.merge_range('R31:Y31', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('R32:Y32', '', item_reverso)
        reverso.merge_range('R33:Y33', '', item_reverso)
        reverso.merge_range('R34:Y34', '', item_reverso)
        reverso.merge_range('R35:Y35', '', item_reverso)
        reverso.merge_range('R36:Y36', '', item_reverso)
        reverso.merge_range('R37:Y37', '', item_reverso)
        reverso.merge_range('R38:Y38', '', item_reverso)
        reverso.merge_range('R39:Y39', '', item_reverso)
        reverso.merge_range('R40:Y40', '', item_reverso)
        reverso.merge_range('R41:Y41', '', item_reverso)
        reverso.merge_range('R42:Y42', '', item_reverso)
        reverso.write('Z31', 'IND', subtitulo_reverse)
        reverso.write('Z32', '', item_reverso)
        reverso.write('Z33', '', item_reverso)
        reverso.write('Z34', '', item_reverso)
        reverso.write('Z35', '', item_reverso)
        reverso.write('Z36', '', item_reverso)
        reverso.write('Z37', '', item_reverso)
        reverso.write('Z38', '', item_reverso)
        reverso.write('Z39', '', item_reverso)
        reverso.write('Z40', '', item_reverso)
        reverso.write('Z41', '', item_reverso)
        reverso.write('Z42', '', item_reverso)
        reverso.write('AA31', 'EJE', subtitulo_reverse)
        reverso.write('AA32', '', item_reverso)
        reverso.write('AA33', '', item_reverso)
        reverso.write('AA34', '', item_reverso)
        reverso.write('AA35', '', item_reverso)
        reverso.write('AA36', '', item_reverso)
        reverso.write('AA37', '', item_reverso)
        reverso.write('AA38', '', item_reverso)
        reverso.write('AA39', '', item_reverso)
        reverso.write('AA40', '', item_reverso)
        reverso.write('AA41', '', item_reverso)
        reverso.write('AA42', '', item_reverso)
        reverso.write('AB31', 'DX', subtitulo_reverse)
        reverso.write('AB32', '', item_reverso)
        reverso.write('AB33', '', item_reverso)
        reverso.write('AB34', '', item_reverso)
        reverso.write('AB35', '', item_reverso)
        reverso.write('AB36', '', item_reverso)
        reverso.write('AB37', '', item_reverso)
        reverso.write('AB38', '', item_reverso)
        reverso.write('AB39', '', item_reverso)
        reverso.write('AB40', '', item_reverso)
        reverso.write('AB41', '', item_reverso)
        reverso.write('AB42', '', item_reverso)
        reverso.write('AC31', 'RES', subtitulo_reverse)
        reverso.write('AC32', '', item_reverso)
        reverso.write('AC33', '', item_reverso)
        reverso.write('AC34', '', item_reverso)
        reverso.write('AC35', '', item_reverso)
        reverso.write('AC36', '', item_reverso)
        reverso.write('AC37', '', item_reverso)
        reverso.write('AC38', '', item_reverso)
        reverso.write('AC39', '', item_reverso)
        reverso.write('AC40', '', item_reverso)
        reverso.write('AC41', '', item_reverso)
        reverso.write('AC42', '', item_reverso)
        reverso.merge_range(
            'A43:AC43', 'SUB COMPONENTE PRESTACIONAL (PROCEDIMIENTOS)',
            titulo_reverse)
        reverso.merge_range('A44:B45', u'CÓDIGO', subtitulo_reverse)
        reverso.merge_range('A46:B46', '', item_reverso)
        reverso.merge_range('A47:B47', '', item_reverso)
        reverso.merge_range('A48:B48', '', item_reverso)
        reverso.merge_range('A49:B49', '', item_reverso)
        reverso.merge_range('A50:B50', '', item_reverso)
        reverso.merge_range('C44:M45', 'NOMBRE', subtitulo_reverse)
        reverso.merge_range('C46:M46', '', item_reverso)
        reverso.merge_range('C47:M47', '', item_reverso)
        reverso.merge_range('C48:M48', '', item_reverso)
        reverso.merge_range('C49:M49', '', item_reverso)
        reverso.merge_range('C50:M50', '', item_reverso)
        reverso.merge_range('N44:Q45', 'CARACT', subtitulo_reverse)
        reverso.merge_range('N46:Q46', '', item_reverso)
        reverso.merge_range('N47:Q47', '', item_reverso)
        reverso.merge_range('N48:Q48', '', item_reverso)
        reverso.merge_range('N49:Q49', '', item_reverso)
        reverso.merge_range('N50:Q50', '', item_reverso)
        reverso.merge_range('R44:T45', 'IND/ PRES', subtitulo_reverse)
        reverso.merge_range('R46:T46', '', item_reverso)
        reverso.merge_range('R47:T47', '', item_reverso)
        reverso.merge_range('R48:T48', '', item_reverso)
        reverso.merge_range('R49:T49', '', item_reverso)
        reverso.merge_range('R50:T50', '', item_reverso)
        reverso.merge_range('U44:W45', 'EJE/ ENTR', subtitulo_reverse)
        reverso.merge_range('U46:W46', '', item_reverso)
        reverso.merge_range('U47:W47', '', item_reverso)
        reverso.merge_range('U48:W48', '', item_reverso)
        reverso.merge_range('U49:W49', '', item_reverso)
        reverso.merge_range('U50:W50', '', item_reverso)
        reverso.merge_range('X44:Y45', 'DX', subtitulo_reverse)
        reverso.merge_range('X46:Y46', '', item_reverso)
        reverso.merge_range('X47:Y47', '', item_reverso)
        reverso.merge_range('X48:Y48', '', item_reverso)
        reverso.merge_range('X49:Y49', '', item_reverso)
        reverso.merge_range('X50:Y50', '', item_reverso)
        reverso.merge_range('Z44:Z45', 'RES', subtitulo_reverse)
        reverso.write('Z46', '', item_reverso)
        reverso.write('Z47', '', item_reverso)
        reverso.write('Z48', '', item_reverso)
        reverso.write('Z49', '', item_reverso)
        reverso.write('Z50', '', item_reverso)
        reverso.merge_range('AA44:AA45', u'N° TICKET', subtitulo_reverse)
        reverso.write('AA46', '', item_reverso)
        reverso.write('AA47', '', item_reverso)
        reverso.write('AA48', '', item_reverso)
        reverso.write('AA49', '', item_reverso)
        reverso.write('AA50', '', item_reverso)
        reverso.merge_range('AB44:AC45', 'PO', subtitulo_reverse)
        reverso.merge_range('AB46:AC46', '', item_reverso)
        reverso.merge_range('AB47:AC47', '', item_reverso)
        reverso.merge_range('AB48:AC48', '', item_reverso)
        reverso.merge_range('AB49:AC49', '', item_reverso)
        reverso.merge_range('AB50:AC50', '', item_reverso)
        reverso.merge_range('A51:AC51', 'OBSERVACIONES', subtitulo_reverse)
        reverso.merge_range('A52:AC53', '', item_reverso)
        reverso.merge_range('A54:AC55', '', item_reverso)
        reverso.merge_range('A56:AC57', '', item_reverso)
        reverso.merge_range('A58:AC59', '', item_reverso)
        reverso.merge_range(
            'B70:K71', '/'.join([
                'Firma y Sello del Responsable de Procedimiento y',
                'o Farmacia y', 'o Laboratorio']), firma_reverso)
        reverso.merge_range('R61:V69', '', item_16)
        reverso.merge_range(
            'R70:V71', 'Huella Digital del Asegurado o del Apoderado', firma_reverso)

        workbook.close()
        return workbook
